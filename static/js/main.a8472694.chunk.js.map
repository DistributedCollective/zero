{"version":3,"sources":["../../index.ts","../../../src/EthersLiquityConnection.ts","../../../src/Decimal.ts","../../../src/constants.ts","../../../../src/hooks/useLiquityStore.ts","../../../src/WebSocketAugmentedProvider.ts","../../../src/WebSocketProvider.ts","../../../src/contracts.ts","../../../src/ReadableEthersLiquity.ts","../../../src/BlockPolledLiquityStore.ts","../../../src/PopulatableEthersLiquity.ts","../../../src/SendableEthersLiquity.ts","../../../../src/components/LiquityStoreProvider.tsx","../../../../src/utils/equals.ts","../../../src/BatchedProvider.ts","../../../src/_Multicall.ts","../../../src/Trove.ts","../../../src/StabilityDeposit.ts","../../../src/ZEROStake.ts","../../../src/Fees.ts","../../../src/TransactableLiquity.ts","../../../src/SendableLiquity.ts","../../../src/LiquityStore.ts","../../../src/_CachedReadableLiquity.ts","../../../src/ObservableEthersLiquity.ts","../../../src/parseLogs.ts","../../../src/EthersLiquity.ts","../../../../src/hooks/useLiquityReducer.ts","../../../../src/hooks/useLiquitySelector.ts","config/index.ts","hooks/LiquityContext.tsx","connectors/injectedConnector.ts","components/Icon.tsx","components/Dialog.tsx","components/RetryDialog.tsx","components/WaitingDialog.tsx","components/ConnectionConfirmationDialog.tsx","components/MetaMaskIcon.tsx","components/Modal.tsx","components/WalletConnector.tsx","hooks/useAuthorizedConnection.ts","components/Tooltip.tsx","components/Transaction.tsx","theme.ts","testUtils/DisposableWalletProvider.ts","strings.ts","utils/shortenAddress.ts","components/UserAccount.tsx","components/InfoIcon.tsx","components/Statistic.tsx","components/SystemStats.tsx","components/SystemStatsPopup.tsx","components/LiquityLogo.tsx","components/Link.tsx","components/Nav.tsx","components/SideNav.tsx","components/Header.tsx","components/ActionDescription.tsx","components/Trove/Editor.tsx","components/LoadingOverlay.tsx","components/Trove/CollateralRatio.tsx","components/Trove/NueCheckbox.tsx","components/Trove/TroveEditor.tsx","components/Trove/TroveAction.tsx","components/Trove/context/TroveViewContext.tsx","components/ErrorDescription.tsx","components/Trove/validation/validateTroveChange.tsx","hooks/useNueTokenSelection.ts","components/Trove/TroveManager.tsx","components/Trove/ReadOnlyTrove.tsx","components/InfoMessage.tsx","components/Trove/NoTrove.tsx","components/Trove/Opening.tsx","components/Trove/Adjusting.tsx","components/CollateralSurplusAction.tsx","components/Trove/RedeemedTrove.tsx","components/Trove/LiquidatedTrove.tsx","components/Trove/Trove.tsx","components/Stability/StabilityDepositEditor.tsx","components/Stability/StabilityDepositAction.tsx","components/Stability/context/StabilityViewContext.tsx","components/Stability/StabilityActionDescription.tsx","components/Stability/validation/validateStabilityDepositChange.tsx","components/Stability/StabilityDepositManager.tsx","components/Stability/actions/ClaimAndMove.tsx","components/Stability/actions/ClaimRewards.tsx","components/Stability/RemainingZERO.tsx","components/Badge.tsx","components/Stability/context/fetchZeroPrice.ts","components/Stability/Yield.tsx","components/Stability/ActiveDeposit.tsx","components/Stability/NoDeposit.tsx","components/Stability/Stability.tsx","components/PriceManager.tsx","components/Staking/context/StakingViewContext.tsx","components/Staking/StakingGainsAction.tsx","components/Staking/ReadOnlyStake.tsx","components/Staking/StakingEditor.tsx","components/Staking/StakingManagerAction.tsx","components/Staking/StakingManager.tsx","components/Staking/NoStake.tsx","components/Staking/Staking.tsx","pages/Dashboard.tsx","pages/UnregisteredFrontend.tsx","pages/FrontendRegistration.tsx","pages/FrontendRegistrationSuccess.tsx","pages/PageSwitcher.tsx","components/LiquidationManager.tsx","components/Abbreviation.tsx","components/RiskyTroves.tsx","pages/RiskyTrovesPage.tsx","components/Redemption/DisabledRedemption.tsx","components/Redemption/RedemptionAction.tsx","components/Redemption/RedemptionManager.tsx","components/Redemption/Redemption.tsx","pages/RedemptionPage.tsx","components/Trove/context/TroveViewProvider.tsx","components/Stability/context/StabilityViewProvider.tsx","components/Staking/context/StakingViewProvider.tsx","LiquityFrontend.tsx","App.tsx","index.tsx"],"names":["exports","WebSocketProvider","a","defaultConfig","frontendTag","AddressZero","hasKey","o","k","parseConfig","json","config","isAddress","getAddress","console","error","log","infuraApiKey","testnetOnly","configPromise","undefined","fetchConfig","fetch","response","ok","Error","status","getConfig","LiquityContext","createContext","supportedNetworks","LiquityProvider","children","loader","unsupportedNetworkFallback","unsupportedMainnetFallback","useWeb3React","provider","library","account","chainId","useState","setConfig","connection","useMemo","_connectByChainId","getSigner","userAddress","useStore","e","useEffect","then","isBatchedProvider","isWebSocketAugmentedProvider","network","getNetwork","name","includes","openWebSocket","wsParams","_isDev","window","location","hostname","closeWebSocket","liquity","EthersLiquity","_from","store","logging","Provider","value","useLiquity","liquityContext","useContext","injectedConnector","InjectedConnector","add","faCircleNotch","faCheck","faCheckCircle","faExclamationTriangle","faInfoCircle","faTimes","faTrash","faChartLine","faRedo","faHistory","faChevronLeft","faChevronRight","faClipboard","faClipboardCheck","faUserCircle","faWallet","faExternalLinkAlt","faCog","faPlug","faExclamationCircle","faAngleUp","faAngleDoubleUp","faAngleDown","faAngleDoubleDown","faPen","faHandPaper","faHeartbeat","faBars","faQuestionCircle","getIcon","Icon","style","rest","icon","iconFromIntent","intent","color","aria-label","Dialog","title","cancelLabel","onCancel","sx","p","borderRadius","height","bg","justifyContent","alignItems","borderBottom","borderColor","pb","as","textAlign","fontSize","px","variant","onClick","size","RetryDialog","retryLabel","onRetry","borderTop","flexDirection","mr","mb","width","WaitingDialog","waitReason","ConnectionConfirmationDialog","fontWeight","MetaMaskIcon","viewBox","fill","xmlns","d","x","y","Modal","connectionReducer","state","action","type","connector","message","match","warn","WalletConnector","activate","deactivate","active","triedAuthorizedConnection","tried","setTried","isAuthorized","tryToActivateIfAuthorized","useAuthorizedConnection","useReducer","connectionState","dispatch","isMetaMask","ethereum","detectMetaMask","ml","lineHeight","href","target","Tooltip","placement","event","useRef","show","setShow","referenceElement","setReferenceElement","popperElement","setPopperElement","usePopper","styles","attributes","React","cloneElement","Children","only","onMouseOver","current","onMouseOut","setTimeout","ref","popper","circularProgressbarStyle","strokeLinecap","pathColor","trailColor","slowProgress","strokeWidth","buildStyles","pathTransitionDuration","fastProgress","TransactionContext","TransactionProvider","transactionState","useTransactionState","useMyTransactionState","myId","id","useTransactionFunction","send","setTransactionState","useCallback","tx","Transaction","tooltip","tooltipPlacement","showFailure","requires","sendTransaction","trigger","failureReasons","filter","map","push","clonedTrigger","length","disabled","tryToGetRevertReason","hash","getTransaction","call","blockNumber","result","hexDataLength","hexDataSlice","defaultAbiCoder","decode","Donut","memo","CircularProgressbarWithChildren","TransactionProgressDonut","setValue","maxValue","spin","TransactionMonitor","cancelled","finished","txHash","rawSentTransaction","waitForConfirmation","waitForReceipt","receipt","confirmations","rawReceipt","reason","pl","position","bottom","overflow","baseColors","colors","primary","secondary","accent","success","warning","danger","dangerHover","info","invalid","text","background","cardBackground","muted","bonded","highlight","buttonBase","display","cursor","button","py","border","opacity","buttonOutline","hoverColor","iconButton","padding","cardHeadingFontSize","cardGapX","cardGapY","card","mt","boxShadow","infoCard","h2","formBase","flexShrink","formCell","modalOverlay","left","top","headerGradient","theme","breakpoints","space","fonts","body","join","heading","monospace","fontSizes","fontWeights","light","medium","bold","lineHeights","borders","shadows","address","fontFamily","buttons","outline","cancel","dangerIcon","titleIcon","cards","pr","infoPopup","right","overflowY","zIndex","forms","label","unit","input","flex","editor","layout","header","footer","minHeight","main","maxWidth","mx","columns","flexWrap","justifyItems","actions","disabledOverlay","modal","infoOverlay","infoMessage","m","minWidth","sidenav","badge","backgroundColor","root","textDecoration","links","nav","textTransform","letterSpacing","DisposableWalletProvider","url","funderPrivateKey","ethAmount","wallet","funderWallet","haveFunded","this","Wallet","createRandom","Decimal","from","find","toLowerCase","to","hex","gas","hexlify","method","params","fund","Promise","all","nonce","findWallet","signTransaction","gasLimit","headers","JSON","stringify","jsonrpc","Object","assign","COIN","GT","COIN2","shortenAddress","substr","select","accountBalance","zusdBalance","zeroBalance","nueBalance","UserAccount","useLiquitySelector","i","currency","balance","prettify","InfoIcon","interactive","content","Statistic","selectBalances","Balances","GitHubCommit","numberOfTroves","price","total","zusdInStabilityPool","borrowingRate","redemptionRate","totalStakedZERO","frontend","kickbackRate","SystemStats","showBalances","contractsVersion","version","deploymentDate","zusdInStabilityPoolPct","debt","nonZero","Percent","div","totalCollateralRatioPct","collateralRatio","borrowingFeePct","kickbackRatePct","mul","toString","collateral","shorten","collateralRatioIsBelowCritical","toLocaleString","process","SystemStatsPopup","systemStatsOpen","setSystemStatsOpen","systemStatsOverlayRef","pt","LiquityLogo","boxProps","data-name","transform","ExactLink","props","exact","Link","Nav","SideNav","isVisible","setIsVisible","overlay","Header","isFrontendRegistered","borderLeft","ActionDescription","Amount","whiteSpace","Row","labelId","labelFor","infoIcon","htmlFor","PendingAmount","startsWith","StaticAmounts","inputId","labelledBy","amount","pendingAmount","pendingColor","aria-labelledby","staticStyle","flexGrow","editableStyle","StaticRow","DisabledEditableRow","EditableRow","editingState","editedAmount","setEditedAmount","maxAmount","maxedOut","editing","setEditing","setInvalid","autoFocus","step","defaultValue","onChange","onBlur","stopPropagation","LoadingOverlay","CollateralRatio","change","collateralRatioPct","changePct","gt","CRITICAL_COLLATERAL_RATIO","lte","positive","absoluteValue","negative","nonZeroish","lt","NueCheckbox","checked","TroveEditor","original","edited","fee","useNueToken","handleSetNueToken","borrowedToken","changePending","feePct","originalCollateralRatio","isEmpty","collateralRatioChange","Difference","between","ZUSD_LIQUIDATION_RESERVE","TroveAction","transactionId","maxBorrowingRate","troveAction","openNueTrove","bind","openTrove","closeNueTrove","closeTrove","adjustNueTrove","adjustTrove","TroveViewContext","useTroveView","context","ErrorDescription","mcrPercent","MINIMUM_COLLATERAL_RATIO","ccrPercent","TroveChangeDescription","useNueBalance","depositCollateral","borrowZUSD","repayZUSD","withdrawCollateral","selectForTroveChangeValidation","validateTroveChange","originalTrove","adjustedTrove","selectedState","whatChanged","resultingTrove","apply","recoveryMode","wouldTriggerRecoveryMode","subtract","ZUSD_MINIMUM_DEBT","errorDescription","validateTroveCreation","validateTroveClosure","validateTroveAdjustment","isOpenableInRecoveryMode","collateralRatioIsBelowMinimum","sub","repayBalance","useNueTokenSelection","setUseNueToken","init","trove","Trove","debtDirty","addedMinimumDebt","reduceWith","reduce","addMinimumDebt","removeMinimumDebt","finishChange","revert","newCollateral","newValue","newState","setCollateral","isZero","setDebt","changeCommitted","stateChange","troveBeforeRedistribution","feeFrom","ZERO","fees","validationContext","transactionIdPrefix","transactionIdMatcher","RegExp","TroveManager","useLiquityReducer","validChange","description","dispatchEvent","handleCancel","openingNewTrove","myTransactionState","ReadOnlyTrove","handleAdjustTrove","handleCloseTrove","InfoMessage","NoTrove","handleOpenTrove","selector","EMPTY_TROVE","TRANSACTION_ID","GAS_ROOM_ETH","Opening","borrowAmount","setBorrowAmount","totalDebt","isDirty","maxEth","maxCollateral","collateralMaxedOut","eq","troveChange","isTransactionPending","handleCancelPressed","reset","ZUSD_MINIMUM_NET_DEBT","Adjusting","previousTrove","netDebt","setNetDebt","nextCollateral","unsavedChanges","applyUnsavedCollateralChanges","nextNetDebt","applyUnsavedNetDebtChanges","isDebtIncrease","debtIncreaseAmount","updatedTrove","collateralSurplusBalance","CollateralSurplusAction","myTransactionId","claimCollateralSurplus","hasSurplusCollateral","RedeemedTrove","LiquidatedTrove","view","StabilityDepositEditor","originalDeposit","editedZUSD","currentZUSD","zusdInStabilityPoolAfterChange","originalPoolShare","mulDiv","newPoolShare","poolShareChange","infinite","concat","collateralGain","zeroReward","selectFrontendRegistered","StabilityDepositAction","depositZUSD","depositZUSDInStabilityPool","withdrawZUSDFromStabilityPool","withdrawZUSD","StabilityViewContext","useStabilityView","StabilityActionDescription","selectForStabilityDepositChangeValidation","ownFrontend","haveUndercollateralizedTroves","haveOwnFrontend","stabilityDeposit","updatedDeposit","initialZUSD","StabilityDepositManager","validateStabilityDepositChange","makingNewDeposit","ClaimAndMove","transferCollateralGainToTrove","ClaimRewards","withdrawGainsFromStabilityPool","remainingStabilityPoolZEROReward","RemainingZERO","Badge","uniswapQuery","zeroTokenAddress","fetchZeroPrice","query","variables","reject","data","errors","token","derivedETH","bundle","ethPrice","ethPriceUSD","zeroPriceUSD","Yield","addresses","zeroPrice","setZeroPrice","hasZeroValue","aprPercentage","remainingZeroInUSD","ActiveDeposit","poolShare","handleAdjustDeposit","hasReward","hasGain","hasTrove","isWaitingForTransaction","NoDeposit","Stability","selectPrice","PriceManager","canSetPrice","_priceFeedIsTestnet","editedPrice","setEditedPrice","overrides","setPrice","StakingViewContext","useStakingView","selectZEROStake","zeroStake","StakingGainsAction","zusdGain","withdrawGainsFromStaking","ReadOnlyStake","stakedZERO","StakingEditor","originalStake","editedZERO","totalStakedZEROAfterChange","StakingManagerAction","stakeZERO","unstakeZERO","updatedStake","selectZEROBalance","StakingManagerActionDescription","StakingManager","dispatchStakingViewAction","makingNewStake","NoStake","Staking","Dashboard","UnregisteredFrontend","FrontendRegistrationAction","registerFrontend","FrontendRegistration","setKickbackRate","cut","setCut","kickbackRateString","setKickbackRateString","newKickbackRate","newCut","ONE","FrontendRegistrationSuccess","onDismiss","selectFrontend","PageSwitcher","unregistered","registering","setRegistering","LiquidationManager","numberOfTrovesToLiquidate","setNumberOfTrovesToLiquidate","min","liquidateUpTo","parseInt","Abbreviation","short","rowHeight","liquidatableInNormalMode","liquidatableInRecoveryMode","totalCollateralRatio","gte","blockTag","RiskyTroves","pageSize","loading","setLoading","troves","setTroves","reload","setReload","forceReload","page","setPage","numberOfPages","Math","ceil","clampedPage","mounted","getTroves","first","sortedBy","startingAt","copied","setCopied","ownerAddress","onCopy","liquidate","RiskyTrovesPage","DisabledRedemption","disabledDays","unlockDate","RedemptionAction","zusdAmount","maxRedemptionRate","redeemZUSD","RedemptionManager","setZUSDAmount","setChangePending","dirty","ethFee","canRedeem","selectBlockTimestamp","blockTimestamp","Redemption","bootstrapPeriod","bootstrapPeriodDays","round","bootstrapEndTime","getTime","bootstrapEndDate","Date","RedemptionPage","transitions","NONE","OPEN_TROVE_PRESSED","TROVE_OPENED","LIQUIDATED","TROVE_SURPLUS_COLLATERAL_CLAIMED","REDEEMED","OPENING","CANCEL_ADJUST_TROVE_PRESSED","ADJUSTING","TROVE_ADJUSTED","TROVE_CLOSED","TROVE_LIQUIDATED","TROVE_REDEEMED","CLOSING","ACTIVE","ADJUST_TROVE_PRESSED","CLOSE_TROVE_PRESSED","troveStatusEvents","open","closedByOwner","closedByLiquidation","closedByRedemption","TroveViewProvider","troveStatus","getInitialView","setView","viewRef","nextView","transition","DEPOSIT_PRESSED","DEPOSITING","CANCEL_PRESSED","DEPOSIT_CONFIRMED","REWARDS_CLAIMED","ADJUST_DEPOSIT_PRESSED","DEPOSIT_EMPTIED","StabilityViewProvider","adjusting","oldStake","oldState","StakingViewProvider","stakingTransactionState","LiquityFrontend","path","autoRefreshOnNetworkChange","REACT_APP_DEMO_MODE","EthersWeb3ReactProvider","getLibrary","BatchedWebSocketAugmentedWeb3Provider","UnsupportedMainnetFallback","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.a8472694.chunk.js","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.UnsupportedNetworkError = exports._connectByChainId = void 0;\nvar EthersLiquityConnection_1 = require(\"./src/EthersLiquityConnection\");\nObject.defineProperty(exports, \"_connectByChainId\", { enumerable: true, get: function () { return EthersLiquityConnection_1._connectByChainId; } });\nObject.defineProperty(exports, \"UnsupportedNetworkError\", { enumerable: true, get: function () { return EthersLiquityConnection_1.UnsupportedNetworkError; } });\n__exportStar(require(\"./src/types\"), exports);\n__exportStar(require(\"./src/ReadableEthersLiquity\"), exports);\n__exportStar(require(\"./src/ObservableEthersLiquity\"), exports);\n__exportStar(require(\"./src/BlockPolledLiquityStore\"), exports);\n__exportStar(require(\"./src/PopulatableEthersLiquity\"), exports);\n__exportStar(require(\"./src/SendableEthersLiquity\"), exports);\n__exportStar(require(\"./src/EthersLiquity\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._connect = exports._connectByChainId = exports._connectToDeployment = exports.UnsupportedNetworkError = exports._usingStore = exports._requireFrontendAddress = exports._requireAddress = exports._getProvider = exports._requireSigner = exports._getBlockTimestamp = exports._getContracts = void 0;\nconst abstract_signer_1 = require(\"@ethersproject/abstract-signer\");\nconst dev_json_1 = __importDefault(require(\"../deployments/dev.json\"));\nconst rsktestnet_json_1 = __importDefault(require(\"../deployments/rsktestnet.json\"));\nconst rskdev_json_1 = __importDefault(require(\"../deployments/rskdev.json\"));\nconst contracts_1 = require(\"./contracts\");\nconst _Multicall_1 = require(\"./_Multicall\");\nconst dev = dev_json_1.default;\nconst deployments = {\n    [rsktestnet_json_1.default.chainId]: rsktestnet_json_1.default,\n    ...(rskdev_json_1.default ? { [rskdev_json_1.default.chainId]: rskdev_json_1.default } : {}),\n    ...(dev !== null ? { [dev.chainId]: dev } : {})\n};\nconst branded = (t) => t;\nconst connectionFrom = (provider, signer, _contracts, _multicall, { deploymentDate, ...deployment }, optionalParams) => {\n    if (optionalParams &&\n        optionalParams.useStore !== undefined &&\n        !validStoreOptions.includes(optionalParams.useStore)) {\n        throw new Error(`Invalid useStore value ${optionalParams.useStore}`);\n    }\n    return branded({\n        provider,\n        signer,\n        _contracts,\n        _multicall,\n        deploymentDate: new Date(deploymentDate),\n        ...deployment,\n        ...optionalParams\n    });\n};\n/** @internal */\nconst _getContracts = (connection) => connection._contracts;\nexports._getContracts = _getContracts;\nconst getMulticall = (connection) => connection._multicall;\nconst numberify = (bigNumber) => bigNumber.toNumber();\nconst getTimestampFromBlock = ({ timestamp }) => timestamp;\n/** @internal */\nconst _getBlockTimestamp = (connection, blockTag = \"latest\") => { var _a, _b; return (_b = (_a = \n// Get the timestamp via a contract call whenever possible, to make it batchable with other calls\ngetMulticall(connection)) === null || _a === void 0 ? void 0 : _a.getCurrentBlockTimestamp({ blockTag }).then(numberify)) !== null && _b !== void 0 ? _b : exports._getProvider(connection).getBlock(blockTag).then(getTimestampFromBlock); };\nexports._getBlockTimestamp = _getBlockTimestamp;\nconst panic = (e) => {\n    throw e;\n};\n/** @internal */\nconst _requireSigner = (connection) => { var _a; return (_a = connection.signer) !== null && _a !== void 0 ? _a : panic(new Error(\"Must be connected through a Signer\")); };\nexports._requireSigner = _requireSigner;\n/** @internal */\nconst _getProvider = (connection) => connection.provider;\nexports._getProvider = _getProvider;\n// TODO parameterize error message?\n/** @internal */\nconst _requireAddress = (connection, overrides) => { var _a, _b; return (_b = (_a = overrides === null || overrides === void 0 ? void 0 : overrides.from) !== null && _a !== void 0 ? _a : connection.userAddress) !== null && _b !== void 0 ? _b : panic(new Error(\"A user address is required\")); };\nexports._requireAddress = _requireAddress;\n/** @internal */\nconst _requireFrontendAddress = (connection) => { var _a; return (_a = connection.frontendTag) !== null && _a !== void 0 ? _a : panic(new Error(\"A frontend address is required\")); };\nexports._requireFrontendAddress = _requireFrontendAddress;\n/** @internal */\nconst _usingStore = (connection) => connection.useStore !== undefined;\nexports._usingStore = _usingStore;\n/**\n * Thrown when trying to connect to a network where Liquity is not deployed.\n *\n * @remarks\n * Thrown by {@link ReadableEthersLiquity.(connect:2)} and {@link EthersLiquity.(connect:2)}.\n *\n * @public\n */\nclass UnsupportedNetworkError extends Error {\n    /** @internal */\n    constructor(chainId) {\n        super(`Unsupported network (chainId = ${chainId})`);\n        this.name = \"UnsupportedNetworkError\";\n        this.chainId = chainId;\n    }\n}\nexports.UnsupportedNetworkError = UnsupportedNetworkError;\nconst getProviderAndSigner = (signerOrProvider) => {\n    var _a;\n    const provider = abstract_signer_1.Signer.isSigner(signerOrProvider)\n        ? (_a = signerOrProvider.provider) !== null && _a !== void 0 ? _a : panic(new Error(\"Signer must have a Provider\")) : signerOrProvider;\n    const signer = abstract_signer_1.Signer.isSigner(signerOrProvider) ? signerOrProvider : undefined;\n    return [provider, signer];\n};\n/** @internal */\nconst _connectToDeployment = (deployment, signerOrProvider, optionalParams) => connectionFrom(...getProviderAndSigner(signerOrProvider), contracts_1._connectToContracts(signerOrProvider, deployment), undefined, deployment, optionalParams);\nexports._connectToDeployment = _connectToDeployment;\nconst validStoreOptions = [\"blockPolled\"];\n/** @internal */\nfunction _connectByChainId(provider, signer, chainId, optionalParams) {\n    var _a;\n    const deployment = (_a = (deployments[chainId])) !== null && _a !== void 0 ? _a : panic(new UnsupportedNetworkError(chainId));\n    return connectionFrom(provider, signer, contracts_1._connectToContracts(signer !== null && signer !== void 0 ? signer : provider, deployment), _Multicall_1._connectToMulticall(signer !== null && signer !== void 0 ? signer : provider, chainId), deployment, optionalParams);\n}\nexports._connectByChainId = _connectByChainId;\n/** @internal */\nconst _connect = async (signerOrProvider, optionalParams) => {\n    const [provider, signer] = getProviderAndSigner(signerOrProvider);\n    if (signer) {\n        if ((optionalParams === null || optionalParams === void 0 ? void 0 : optionalParams.userAddress) !== undefined) {\n            throw new Error(\"Can't override userAddress when connecting through Signer\");\n        }\n        optionalParams = {\n            ...optionalParams,\n            userAddress: await signer.getAddress()\n        };\n    }\n    return _connectByChainId(provider, signer, (await provider.getNetwork()).chainId, optionalParams);\n};\nexports._connect = _connect;\n//# sourceMappingURL=EthersLiquityConnection.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Percent = exports.Difference = exports.Decimal = void 0;\nconst assert_1 = __importDefault(require(\"assert\"));\nconst bignumber_1 = require(\"@ethersproject/bignumber\");\nconst getDigits = (numDigits) => TEN.pow(numDigits);\nconst MAX_UINT_256 = \"0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\";\nconst PRECISION = 18;\nconst ONE = bignumber_1.BigNumber.from(1);\nconst TEN = bignumber_1.BigNumber.from(10);\nconst DIGITS = getDigits(PRECISION);\nconst stringRepresentationFormat = /^[0-9]*(\\.[0-9]*)?(e[-+]?[0-9]+)?$/;\nconst trailingZeros = /0*$/;\nconst magnitudes = [\"\", \"K\", \"M\", \"B\", \"T\"];\nconst roundedMul = (x, y) => x.mul(y).add(Decimal.HALF.hex).div(DIGITS);\n/**\n * Fixed-point decimal bignumber with 18 digits of precision.\n *\n * @remarks\n * Used by Liquity libraries to precisely represent native currency (e.g. Ether), ZUSD and ZERO\n * amounts, as well as derived metrics like collateral ratios.\n *\n * @public\n */\nclass Decimal {\n    constructor(bigNumber) {\n        if (bigNumber.isNegative()) {\n            throw new Error(\"negatives not supported by Decimal\");\n        }\n        this._bigNumber = bigNumber;\n    }\n    /** @internal */\n    get hex() {\n        return this._bigNumber.toHexString();\n    }\n    /** @internal */\n    get bigNumber() {\n        return this._bigNumber.toString();\n    }\n    static fromBigNumberString(bigNumberString) {\n        return new Decimal(bignumber_1.BigNumber.from(bigNumberString));\n    }\n    static _fromString(representation) {\n        if (!representation || !representation.match(stringRepresentationFormat)) {\n            throw new Error(`bad decimal format: \"${representation}\"`);\n        }\n        if (representation.includes(\"e\")) {\n            // eslint-disable-next-line prefer-const\n            let [coefficient, exponent] = representation.split(\"e\");\n            if (exponent.startsWith(\"-\")) {\n                return new Decimal(Decimal._fromString(coefficient)._bigNumber.div(TEN.pow(bignumber_1.BigNumber.from(exponent.substr(1)))));\n            }\n            if (exponent.startsWith(\"+\")) {\n                exponent = exponent.substr(1);\n            }\n            return new Decimal(Decimal._fromString(coefficient)._bigNumber.mul(TEN.pow(bignumber_1.BigNumber.from(exponent))));\n        }\n        if (!representation.includes(\".\")) {\n            return new Decimal(bignumber_1.BigNumber.from(representation).mul(DIGITS));\n        }\n        // eslint-disable-next-line prefer-const\n        let [characteristic, mantissa] = representation.split(\".\");\n        if (mantissa.length < PRECISION) {\n            mantissa += \"0\".repeat(PRECISION - mantissa.length);\n        }\n        else {\n            mantissa = mantissa.substr(0, PRECISION);\n        }\n        return new Decimal(bignumber_1.BigNumber.from(characteristic || 0)\n            .mul(DIGITS)\n            .add(mantissa));\n    }\n    static from(decimalish) {\n        switch (typeof decimalish) {\n            case \"object\":\n                if (decimalish instanceof Decimal) {\n                    return decimalish;\n                }\n                else {\n                    throw new Error(\"invalid Decimalish value\");\n                }\n            case \"string\":\n                return Decimal._fromString(decimalish);\n            case \"number\":\n                return Decimal._fromString(decimalish.toString());\n            default:\n                throw new Error(\"invalid Decimalish value\");\n        }\n    }\n    _toStringWithAutomaticPrecision() {\n        const characteristic = this._bigNumber.div(DIGITS);\n        const mantissa = this._bigNumber.mod(DIGITS);\n        if (mantissa.isZero()) {\n            return characteristic.toString();\n        }\n        else {\n            const paddedMantissa = mantissa.toString().padStart(PRECISION, \"0\");\n            const trimmedMantissa = paddedMantissa.replace(trailingZeros, \"\");\n            return characteristic.toString() + \".\" + trimmedMantissa;\n        }\n    }\n    _roundUp(precision) {\n        const halfDigit = getDigits(PRECISION - 1 - precision).mul(5);\n        return this._bigNumber.add(halfDigit);\n    }\n    _toStringWithPrecision(precision) {\n        if (precision < 0) {\n            throw new Error(\"precision must not be negative\");\n        }\n        const value = precision < PRECISION ? this._roundUp(precision) : this._bigNumber;\n        const characteristic = value.div(DIGITS);\n        const mantissa = value.mod(DIGITS);\n        if (precision === 0) {\n            return characteristic.toString();\n        }\n        else {\n            const paddedMantissa = mantissa.toString().padStart(PRECISION, \"0\");\n            const trimmedMantissa = paddedMantissa.substr(0, precision);\n            return characteristic.toString() + \".\" + trimmedMantissa;\n        }\n    }\n    toString(precision) {\n        if (this.infinite) {\n            return \"\";\n        }\n        else if (precision !== undefined) {\n            return this._toStringWithPrecision(precision);\n        }\n        else {\n            return this._toStringWithAutomaticPrecision();\n        }\n    }\n    prettify(precision = 2) {\n        const [characteristic, mantissa] = this.toString(precision).split(\".\");\n        const prettyCharacteristic = characteristic.replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, \"$1,\");\n        return mantissa !== undefined ? prettyCharacteristic + \".\" + mantissa : prettyCharacteristic;\n    }\n    shorten() {\n        const characteristicLength = this.toString(0).length;\n        const magnitude = Math.min(Math.floor((characteristicLength - 1) / 3), magnitudes.length - 1);\n        const precision = Math.max(3 * (magnitude + 1) - characteristicLength, 0);\n        const normalized = this.div(new Decimal(getDigits(PRECISION + 3 * magnitude)));\n        return normalized.prettify(precision) + magnitudes[magnitude];\n    }\n    add(addend) {\n        return new Decimal(this._bigNumber.add(Decimal.from(addend)._bigNumber));\n    }\n    sub(subtrahend) {\n        return new Decimal(this._bigNumber.sub(Decimal.from(subtrahend)._bigNumber));\n    }\n    mul(multiplier) {\n        return new Decimal(this._bigNumber.mul(Decimal.from(multiplier)._bigNumber).div(DIGITS));\n    }\n    div(divider) {\n        divider = Decimal.from(divider);\n        if (divider.isZero) {\n            return Decimal.INFINITY;\n        }\n        return new Decimal(this._bigNumber.mul(DIGITS).div(divider._bigNumber));\n    }\n    /** @internal */\n    _divCeil(divider) {\n        divider = Decimal.from(divider);\n        if (divider.isZero) {\n            return Decimal.INFINITY;\n        }\n        return new Decimal(this._bigNumber.mul(DIGITS).add(divider._bigNumber.sub(ONE)).div(divider._bigNumber));\n    }\n    mulDiv(multiplier, divider) {\n        multiplier = Decimal.from(multiplier);\n        divider = Decimal.from(divider);\n        if (divider.isZero) {\n            return Decimal.INFINITY;\n        }\n        return new Decimal(this._bigNumber.mul(multiplier._bigNumber).div(divider._bigNumber));\n    }\n    pow(exponent) {\n        assert_1.default(Number.isInteger(exponent));\n        assert_1.default(0 <= exponent && exponent <= 0xffffffff); // Ensure we're safe to use bitwise ops\n        if (exponent === 0) {\n            return Decimal.ONE;\n        }\n        if (exponent === 1) {\n            return this;\n        }\n        let x = this._bigNumber;\n        let y = DIGITS;\n        for (; exponent > 1; exponent >>>= 1) {\n            if (exponent & 1) {\n                y = roundedMul(x, y);\n            }\n            x = roundedMul(x, x);\n        }\n        return new Decimal(roundedMul(x, y));\n    }\n    get isZero() {\n        return this._bigNumber.isZero();\n    }\n    get zero() {\n        if (this.isZero) {\n            return this;\n        }\n    }\n    get nonZero() {\n        if (!this.isZero) {\n            return this;\n        }\n    }\n    get infinite() {\n        if (this.eq(Decimal.INFINITY)) {\n            return this;\n        }\n    }\n    get finite() {\n        if (!this.eq(Decimal.INFINITY)) {\n            return this;\n        }\n    }\n    /** @internal */\n    get absoluteValue() {\n        return this;\n    }\n    lt(that) {\n        return this._bigNumber.lt(Decimal.from(that)._bigNumber);\n    }\n    eq(that) {\n        return this._bigNumber.eq(Decimal.from(that)._bigNumber);\n    }\n    gt(that) {\n        return this._bigNumber.gt(Decimal.from(that)._bigNumber);\n    }\n    gte(that) {\n        return this._bigNumber.gte(Decimal.from(that)._bigNumber);\n    }\n    lte(that) {\n        return this._bigNumber.lte(Decimal.from(that)._bigNumber);\n    }\n    static min(a, b) {\n        a = Decimal.from(a);\n        b = Decimal.from(b);\n        return a.lt(b) ? a : b;\n    }\n    static max(a, b) {\n        a = Decimal.from(a);\n        b = Decimal.from(b);\n        return a.gt(b) ? a : b;\n    }\n}\nexports.Decimal = Decimal;\nDecimal.INFINITY = Decimal.fromBigNumberString(MAX_UINT_256);\nDecimal.ZERO = Decimal.from(0);\nDecimal.HALF = Decimal.from(0.5);\nDecimal.ONE = Decimal.from(1);\n/** @alpha */\nclass Difference {\n    constructor(number) {\n        this._number = number;\n    }\n    static between(d1, d2) {\n        if (d1 === undefined || d2 === undefined) {\n            return new Difference(undefined);\n        }\n        d1 = Decimal.from(d1);\n        d2 = Decimal.from(d2);\n        if (d1.infinite && d2.infinite) {\n            return new Difference(undefined);\n        }\n        else if (d1.infinite) {\n            return new Difference({ sign: \"+\", absoluteValue: d1 });\n        }\n        else if (d2.infinite) {\n            return new Difference({ sign: \"-\", absoluteValue: d2 });\n        }\n        else if (d1.gt(d2)) {\n            return new Difference({ sign: \"+\", absoluteValue: Decimal.from(d1).sub(d2) });\n        }\n        else if (d2.gt(d1)) {\n            return new Difference({ sign: \"-\", absoluteValue: Decimal.from(d2).sub(d1) });\n        }\n        else {\n            return new Difference({ sign: \"\", absoluteValue: Decimal.ZERO });\n        }\n    }\n    toString(precision) {\n        if (!this._number) {\n            return \"N/A\";\n        }\n        return this._number.sign + this._number.absoluteValue.toString(precision);\n    }\n    prettify(precision) {\n        if (!this._number) {\n            return this.toString();\n        }\n        return this._number.sign + this._number.absoluteValue.prettify(precision);\n    }\n    mul(multiplier) {\n        return new Difference(this._number && {\n            sign: this._number.sign,\n            absoluteValue: this._number.absoluteValue.mul(multiplier)\n        });\n    }\n    get nonZero() {\n        var _a;\n        return ((_a = this._number) === null || _a === void 0 ? void 0 : _a.absoluteValue.nonZero) && this;\n    }\n    get positive() {\n        var _a;\n        return ((_a = this._number) === null || _a === void 0 ? void 0 : _a.sign) === \"+\" ? this : undefined;\n    }\n    get negative() {\n        var _a;\n        return ((_a = this._number) === null || _a === void 0 ? void 0 : _a.sign) === \"-\" ? this : undefined;\n    }\n    get absoluteValue() {\n        var _a;\n        return (_a = this._number) === null || _a === void 0 ? void 0 : _a.absoluteValue;\n    }\n    get infinite() {\n        var _a;\n        return ((_a = this._number) === null || _a === void 0 ? void 0 : _a.absoluteValue.infinite) && this;\n    }\n    get finite() {\n        var _a;\n        return ((_a = this._number) === null || _a === void 0 ? void 0 : _a.absoluteValue.finite) && this;\n    }\n}\nexports.Difference = Difference;\n/** @alpha */\nclass Percent {\n    constructor(ratio) {\n        this._percent = ratio.infinite || (ratio.mul && ratio.mul(100)) || ratio;\n    }\n    nonZeroish(precision) {\n        var _a;\n        const zeroish = `0.${\"0\".repeat(precision)}5`;\n        if ((_a = this._percent.absoluteValue) === null || _a === void 0 ? void 0 : _a.gte(zeroish)) {\n            return this;\n        }\n    }\n    toString(precision) {\n        return (this._percent.toString(precision) +\n            (this._percent.absoluteValue && !this._percent.infinite ? \"%\" : \"\"));\n    }\n    prettify() {\n        var _a, _b;\n        if ((_a = this._percent.absoluteValue) === null || _a === void 0 ? void 0 : _a.gte(\"1000\")) {\n            return this.toString(0);\n        }\n        else if ((_b = this._percent.absoluteValue) === null || _b === void 0 ? void 0 : _b.gte(\"10\")) {\n            return this.toString(1);\n        }\n        else {\n            return this.toString(2);\n        }\n    }\n}\nexports.Percent = Percent;\n//# sourceMappingURL=Decimal.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MINIMUM_REDEMPTION_RATE = exports.MAXIMUM_BORROWING_RATE = exports.MINIMUM_BORROWING_RATE = exports.ZUSD_MINIMUM_DEBT = exports.ZUSD_MINIMUM_NET_DEBT = exports.ZUSD_LIQUIDATION_RESERVE = exports.MINIMUM_COLLATERAL_RATIO = exports.CRITICAL_COLLATERAL_RATIO = void 0;\nconst Decimal_1 = require(\"./Decimal\");\n/**\n * Total collateral ratio below which recovery mode is triggered.\n *\n * @public\n */\nexports.CRITICAL_COLLATERAL_RATIO = Decimal_1.Decimal.from(1.5);\n/**\n * Collateral ratio below which a Trove can be liquidated in normal mode.\n *\n * @public\n */\nexports.MINIMUM_COLLATERAL_RATIO = Decimal_1.Decimal.from(1.1);\n/**\n * Amount of ZUSD that's reserved for compensating the liquidator of a Trove.\n *\n * @public\n */\nexports.ZUSD_LIQUIDATION_RESERVE = Decimal_1.Decimal.from(20);\n/**\n * A Trove must always have at least this much debt on top of the\n * {@link ZUSD_LIQUIDATION_RESERVE | liquidation reserve}.\n *\n * @remarks\n * Any transaction that would result in a Trove with less net debt than this will be reverted.\n *\n * @public\n */\nexports.ZUSD_MINIMUM_NET_DEBT = Decimal_1.Decimal.from(180);\n/**\n * A Trove must always have at least this much debt.\n *\n * @remarks\n * Any transaction that would result in a Trove with less debt than this will be reverted.\n *\n * @public\n */\nexports.ZUSD_MINIMUM_DEBT = exports.ZUSD_LIQUIDATION_RESERVE.add(exports.ZUSD_MINIMUM_NET_DEBT);\n/**\n * Value that the {@link Fees.borrowingRate | borrowing rate} will never decay below.\n *\n * @remarks\n * Note that the borrowing rate can still be lower than this during recovery mode, when it's\n * overridden by zero.\n *\n * @public\n */\nexports.MINIMUM_BORROWING_RATE = Decimal_1.Decimal.from(0.005);\n/**\n * Value that the {@link Fees.borrowingRate | borrowing rate} will never exceed.\n *\n * @public\n */\nexports.MAXIMUM_BORROWING_RATE = Decimal_1.Decimal.from(0.05);\n/**\n * Value that the {@link Fees.redemptionRate | redemption rate} will never decay below.\n *\n * @public\n */\nexports.MINIMUM_REDEMPTION_RATE = Decimal_1.Decimal.from(0.005);\n//# sourceMappingURL=constants.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useLiquityStore = void 0;\nconst react_1 = require(\"react\");\nconst LiquityStoreProvider_1 = require(\"../components/LiquityStoreProvider\");\nconst useLiquityStore = () => {\n    const store = react_1.useContext(LiquityStoreProvider_1.LiquityStoreContext);\n    if (!store) {\n        throw new Error(\"You must provide a LiquityStore via LiquityStoreProvider\");\n    }\n    return store;\n};\nexports.useLiquityStore = useLiquityStore;\n//# sourceMappingURL=useLiquityStore.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketAugmentedWeb3Provider = exports.WebSocketAugmented = exports.isWebSocketAugmentedProvider = void 0;\nconst providers_1 = require(\"@ethersproject/providers\");\nconst WebSocketProvider_1 = require(\"./WebSocketProvider\");\nconst webSocketAugmentedProviders = [];\nconst isWebSocketAugmentedProvider = (provider) => webSocketAugmentedProviders.some(webSocketAugmentedProvider => provider instanceof webSocketAugmentedProvider);\nexports.isWebSocketAugmentedProvider = isWebSocketAugmentedProvider;\nconst isHeaderNotFoundError = (error) => typeof error === \"object\" &&\n    typeof error.message === \"string\" &&\n    error.message.includes(\"header not found\");\nconst loadBalancingGlitchRetryIntervalMs = 200;\nconst delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));\nconst WebSocketAugmented = (Base) => {\n    let webSocketAugmentedProvider = class extends Base {\n        constructor() {\n            super(...arguments);\n            this._seenBlock = 0;\n            this._blockListenerScheduled = false;\n            this._blockListeners = new Set();\n            this._blockListener = this._onBlock.bind(this);\n        }\n        openWebSocket(url, network) {\n            this._wsProvider = new WebSocketProvider_1.WebSocketProvider(url, network);\n            this._wsProvider.onClose = this._onWebSocketClose.bind(this);\n            this._wsParams = [url, network];\n            this._switchover();\n        }\n        _onWebSocketClose() {\n            this.closeWebSocket();\n            console.warn(\"WebSocketProvider disconnected. Retrying in 10 seconds.\");\n            this._reconnectTimerId = setTimeout(() => this.openWebSocket(...this._wsParams), 10000);\n        }\n        closeWebSocket() {\n            if (this._wsProvider) {\n                this._wsProvider.onClose = null;\n                this._wsProvider.close(1000); // normal closure\n                this._wsProvider = undefined;\n                this._switchover();\n                if (this._reconnectTimerId !== undefined) {\n                    clearTimeout(this._reconnectTimerId);\n                    this._reconnectTimerId = undefined;\n                }\n            }\n        }\n        _switchover() {\n            if (this._blockListeners.size > 0) {\n                if (this._wsProvider) {\n                    super.off(\"block\", this._blockListener);\n                }\n                this._startBlockEvents();\n            }\n        }\n        _onBlock(blockNumber) {\n            this._seenBlock = blockNumber;\n            if (!this._blockListenerScheduled) {\n                this._blockListenerScheduled = true;\n                setTimeout(() => {\n                    this._blockListenerScheduled = false;\n                    [...this._blockListeners].forEach(listener => listener(this._seenBlock));\n                }, 50);\n            }\n        }\n        async _retrySeenBlock(perform, startingBlock) {\n            for (let retries = 0;; ++retries) {\n                try {\n                    const ret = await perform();\n                    if (retries) {\n                        // console.log(`Glitch resolved after ${retries} ${retries === 1 ? \"retry\" : \"retries\"}.`);\n                    }\n                    return ret;\n                }\n                catch (error) {\n                    if (this._seenBlock !== startingBlock || !isHeaderNotFoundError(error)) {\n                        throw error;\n                    }\n                }\n                // console.warn(\"Load balancing glitch. Retrying...\");\n                await delay(loadBalancingGlitchRetryIntervalMs);\n            }\n        }\n        async call(transaction, blockTag) {\n            const resolvedBlockTag = await blockTag;\n            const perform = () => {\n                var _a;\n                return ((_a = this._wsProvider) === null || _a === void 0 ? void 0 : _a.isReady) ? this._wsProvider.call(transaction, resolvedBlockTag)\n                    : super.call(transaction, resolvedBlockTag);\n            };\n            return resolvedBlockTag === this._seenBlock\n                ? this._retrySeenBlock(perform, this._seenBlock)\n                : perform();\n        }\n        async getBalance(addressOrName, blockTag) {\n            const resolvedBlockTag = await blockTag;\n            const perform = () => {\n                var _a;\n                return ((_a = this._wsProvider) === null || _a === void 0 ? void 0 : _a.isReady) ? this._wsProvider.getBalance(addressOrName, resolvedBlockTag)\n                    : super.getBalance(addressOrName, resolvedBlockTag);\n            };\n            return resolvedBlockTag === this._seenBlock\n                ? this._retrySeenBlock(perform, this._seenBlock)\n                : perform();\n        }\n        _startBlockEvents() {\n            if (this._wsProvider) {\n                console.log(\"Listening for new blocks on WebSocketProvider\");\n                this._wsProvider.on(\"block\", this._blockListener);\n            }\n            else {\n                console.log(\"Listening for new blocks on basic Provider\");\n                super.on(\"block\", this._blockListener);\n            }\n        }\n        _stopBlockEvents() {\n            if (this._wsProvider) {\n                this._wsProvider.off(\"block\", this._blockListener);\n            }\n            else {\n                super.off(\"block\", this._blockListener);\n            }\n        }\n        on(eventName, listener) {\n            if (eventName === \"block\") {\n                return this._addBlockListener(listener);\n            }\n            else {\n                return super.on(eventName, listener);\n            }\n        }\n        _addBlockListener(listener) {\n            if (!this._blockListeners.has(listener)) {\n                this._blockListeners.add(listener);\n                if (this._blockListeners.size === 1) {\n                    this._startBlockEvents();\n                }\n            }\n            return this;\n        }\n        once(eventName, listener) {\n            if (eventName === \"block\") {\n                const listenOnce = (blockNumber) => {\n                    listener(blockNumber);\n                    this._removeBlockListener(listenOnce);\n                };\n                return this._addBlockListener(listenOnce);\n            }\n            else {\n                return super.once(eventName, listener);\n            }\n        }\n        off(eventName, listener) {\n            if (eventName === \"block\") {\n                return this._removeBlockListener(listener);\n            }\n            else {\n                return super.off(eventName, listener);\n            }\n        }\n        _removeBlockListener(listener) {\n            if (this._blockListeners.has(listener)) {\n                this._blockListeners.delete(listener);\n                if (this._blockListeners.size === 0) {\n                    this._stopBlockEvents();\n                }\n            }\n            return this;\n        }\n        getTransactionReceipt(transactionHash) {\n            var _a;\n            return ((_a = this._wsProvider) === null || _a === void 0 ? void 0 : _a.ready) ? this._wsProvider.getTransactionReceipt(transactionHash)\n                : super.getTransactionReceipt(transactionHash);\n        }\n        async _blockContainsTx(blockNumber, txHash) {\n            let block;\n            for (block = null; !block; block = await this.getBlock(blockNumber)) {\n                await delay(loadBalancingGlitchRetryIntervalMs);\n            }\n            return block.transactions.some(txHashInBlock => txHashInBlock === txHash);\n        }\n        async _getTransactionReceiptFromLatest(txHash, latestBlock) {\n            txHash = await txHash;\n            for (let retries = 0;; ++retries) {\n                const receipt = (await this.getTransactionReceipt(txHash));\n                if (latestBlock === undefined ||\n                    (receipt === null && !(await this._blockContainsTx(latestBlock, txHash))) ||\n                    (receipt !== null && receipt.blockNumber + receipt.confirmations - 1 >= latestBlock)) {\n                    if (retries) {\n                        // console.log(`Glitch resolved after ${retries} ${retries === 1 ? \"retry\" : \"retries\"}.`);\n                    }\n                    return receipt;\n                }\n                // console.warn(\"Load balancing glitch. Retrying...\");\n                await delay(loadBalancingGlitchRetryIntervalMs);\n            }\n        }\n        async waitForTransaction(txHash, confirmations, timeout) {\n            if (timeout !== undefined) {\n                // We don't use timeout, don't implement it\n                return super.waitForTransaction(txHash, confirmations, timeout);\n            }\n            let latestBlock = undefined;\n            for (;;) {\n                const receipt = await this._getTransactionReceiptFromLatest(txHash, latestBlock);\n                if (receipt !== null &&\n                    (confirmations === undefined || receipt.confirmations >= confirmations)) {\n                    return receipt;\n                }\n                latestBlock = await new Promise(resolve => this.once(\"block\", resolve));\n            }\n        }\n    };\n    webSocketAugmentedProviders.push(webSocketAugmentedProvider);\n    return webSocketAugmentedProvider;\n};\nexports.WebSocketAugmented = WebSocketAugmented;\nexports.WebSocketAugmentedWeb3Provider = exports.WebSocketAugmented(providers_1.Web3Provider);\n//# sourceMappingURL=WebSocketAugmentedProvider.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketProvider = void 0;\nconst providers_1 = require(\"@ethersproject/providers\");\nclass WebSocketProvider extends providers_1.WebSocketProvider {\n    get isReady() {\n        return this._websocket.readyState === WebSocket.OPEN;\n    }\n    set onClose(closeListener) {\n        this._websocket.onclose = closeListener;\n    }\n    close(code) {\n        this._websocket.close(code);\n    }\n    async detectNetwork() {\n        return this.network;\n    }\n}\nexports.WebSocketProvider = WebSocketProvider;\n//# sourceMappingURL=WebSocketProvider.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._connectToContracts = exports._priceFeedIsTestnet = exports._LiquityContract = void 0;\nconst contracts_1 = require(\"@ethersproject/contracts\");\nconst ActivePool_json_1 = __importDefault(require(\"../abi/ActivePool.json\"));\nconst BorrowerOperations_json_1 = __importDefault(require(\"../abi/BorrowerOperations.json\"));\nconst TroveManager_json_1 = __importDefault(require(\"../abi/TroveManager.json\"));\nconst TroveManagerRedeemOps_json_1 = __importDefault(require(\"../abi/TroveManagerRedeemOps.json\"));\nconst ZUSDToken_json_1 = __importDefault(require(\"../abi/ZUSDToken.json\"));\nconst IERC20_json_1 = __importDefault(require(\"../abi/IERC20.json\"));\nconst CollSurplusPool_json_1 = __importDefault(require(\"../abi/CollSurplusPool.json\"));\nconst CommunityIssuance_json_1 = __importDefault(require(\"../abi/CommunityIssuance.json\"));\nconst DefaultPool_json_1 = __importDefault(require(\"../abi/DefaultPool.json\"));\nconst ZEROToken_json_1 = __importDefault(require(\"../abi/ZEROToken.json\"));\nconst HintHelpers_json_1 = __importDefault(require(\"../abi/HintHelpers.json\"));\nconst ZEROStaking_json_1 = __importDefault(require(\"../abi/ZEROStaking.json\"));\nconst MultiTroveGetter_json_1 = __importDefault(require(\"../abi/MultiTroveGetter.json\"));\nconst PriceFeed_json_1 = __importDefault(require(\"../abi/PriceFeed.json\"));\nconst PriceFeedTestnet_json_1 = __importDefault(require(\"../abi/PriceFeedTestnet.json\"));\nconst SortedTroves_json_1 = __importDefault(require(\"../abi/SortedTroves.json\"));\nconst StabilityPool_json_1 = __importDefault(require(\"../abi/StabilityPool.json\"));\nconst GasPool_json_1 = __importDefault(require(\"../abi/GasPool.json\"));\nconst LiquityBaseParams_json_1 = __importDefault(require(\"../abi/LiquityBaseParams.json\"));\nconst FeeDistributor_json_1 = __importDefault(require(\"../abi/FeeDistributor.json\"));\nconst buildEstimatedFunctions = (estimateFunctions, functions) => Object.fromEntries(Object.keys(estimateFunctions).map(functionName => [\n    functionName,\n    async (overrides, adjustEstimate, ...args) => {\n        if (overrides.gasLimit === undefined) {\n            const estimatedGas = await estimateFunctions[functionName](...args, overrides);\n            overrides = {\n                ...overrides,\n                gasLimit: adjustEstimate(estimatedGas)\n            };\n        }\n        return functions[functionName](...args, overrides);\n    }\n]));\nclass _LiquityContract extends contracts_1.Contract {\n    constructor(addressOrName, contractInterface, signerOrProvider) {\n        super(addressOrName, contractInterface, signerOrProvider);\n        // this.estimateAndCall = buildEstimatedFunctions(this.estimateGas, this);\n        this.estimateAndPopulate = buildEstimatedFunctions(this.estimateGas, this.populateTransaction);\n    }\n    extractEvents(logs, name) {\n        return logs\n            .filter(log => log.address === this.address)\n            .map(log => this.interface.parseLog(log))\n            .filter(e => e.name === name);\n    }\n}\nexports._LiquityContract = _LiquityContract;\n/** @internal */\nconst _priceFeedIsTestnet = (priceFeed) => \"setPrice\" in priceFeed;\nexports._priceFeedIsTestnet = _priceFeedIsTestnet;\nconst getAbi = (priceFeedIsTestnet) => ({\n    activePool: ActivePool_json_1.default,\n    borrowerOperations: BorrowerOperations_json_1.default,\n    troveManager: TroveManager_json_1.default,\n    troveManagerRedeemOps: TroveManagerRedeemOps_json_1.default,\n    zusdToken: ZUSDToken_json_1.default,\n    nueToken: IERC20_json_1.default,\n    communityIssuance: CommunityIssuance_json_1.default,\n    defaultPool: DefaultPool_json_1.default,\n    zeroToken: ZEROToken_json_1.default,\n    hintHelpers: HintHelpers_json_1.default,\n    zeroStaking: ZEROStaking_json_1.default,\n    multiTroveGetter: MultiTroveGetter_json_1.default,\n    priceFeed: priceFeedIsTestnet ? PriceFeedTestnet_json_1.default : PriceFeed_json_1.default,\n    sortedTroves: SortedTroves_json_1.default,\n    stabilityPool: StabilityPool_json_1.default,\n    gasPool: GasPool_json_1.default,\n    collSurplusPool: CollSurplusPool_json_1.default,\n    liquityBaseParams: LiquityBaseParams_json_1.default,\n    feeDistributor: FeeDistributor_json_1.default,\n});\nconst mapLiquityContracts = (contracts, f) => Object.fromEntries(Object.entries(contracts).map(([key, t]) => [key, f(t, key)]));\n/** @internal */\nconst _connectToContracts = (signerOrProvider, { addresses, _priceFeedIsTestnet }) => {\n    const abi = getAbi(_priceFeedIsTestnet);\n    return mapLiquityContracts(addresses, (address, key) => new _LiquityContract(address, abi[key], signerOrProvider));\n};\nexports._connectToContracts = _connectToContracts;\n//# sourceMappingURL=contracts.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ReadableEthersLiquity = void 0;\nconst lib_base_1 = require(\"@liquity/lib-base\");\nconst EthersLiquityConnection_1 = require(\"./EthersLiquityConnection\");\nconst BlockPolledLiquityStore_1 = require(\"./BlockPolledLiquityStore\");\n// TODO: these are constant in the contracts, so it doesn't make sense to make a call for them,\n// but to avoid having to update them here when we change them in the contracts, we could read\n// them once after deployment and save them to LiquityDeployment.\nconst MINUTE_DECAY_FACTOR = lib_base_1.Decimal.from(\"0.999037758833783000\");\nconst BETA = lib_base_1.Decimal.from(2);\nvar BackendTroveStatus;\n(function (BackendTroveStatus) {\n    BackendTroveStatus[BackendTroveStatus[\"nonExistent\"] = 0] = \"nonExistent\";\n    BackendTroveStatus[BackendTroveStatus[\"active\"] = 1] = \"active\";\n    BackendTroveStatus[BackendTroveStatus[\"closedByOwner\"] = 2] = \"closedByOwner\";\n    BackendTroveStatus[BackendTroveStatus[\"closedByLiquidation\"] = 3] = \"closedByLiquidation\";\n    BackendTroveStatus[BackendTroveStatus[\"closedByRedemption\"] = 4] = \"closedByRedemption\";\n})(BackendTroveStatus || (BackendTroveStatus = {}));\nconst panic = (error) => {\n    throw error;\n};\nconst userTroveStatusFrom = (backendStatus) => backendStatus === BackendTroveStatus.nonExistent\n    ? \"nonExistent\"\n    : backendStatus === BackendTroveStatus.active\n        ? \"open\"\n        : backendStatus === BackendTroveStatus.closedByOwner\n            ? \"closedByOwner\"\n            : backendStatus === BackendTroveStatus.closedByLiquidation\n                ? \"closedByLiquidation\"\n                : backendStatus === BackendTroveStatus.closedByRedemption\n                    ? \"closedByRedemption\"\n                    : panic(new Error(`invalid backendStatus ${backendStatus}`));\nconst decimalify = (bigNumber) => lib_base_1.Decimal.fromBigNumberString(bigNumber.toHexString());\nconst numberify = (bigNumber) => bigNumber.toNumber();\nconst convertToDate = (timestamp) => new Date(timestamp * 1000);\nconst validSortingOptions = [\"ascendingCollateralRatio\", \"descendingCollateralRatio\"];\nconst expectPositiveInt = (obj, key) => {\n    if (obj[key] !== undefined) {\n        if (!Number.isInteger(obj[key])) {\n            throw new Error(`${key} must be an integer`);\n        }\n        if (obj[key] < 0) {\n            throw new Error(`${key} must not be negative`);\n        }\n    }\n};\n/**\n * Ethers-based implementation of {@link @liquity/lib-base#ReadableLiquity}.\n *\n * @public\n */\nclass ReadableEthersLiquity {\n    /** @internal */\n    constructor(connection) {\n        this.connection = connection;\n    }\n    /** @internal */\n    static _from(connection) {\n        const readable = new ReadableEthersLiquity(connection);\n        return connection.useStore === \"blockPolled\"\n            ? new _BlockPolledReadableEthersLiquity(readable)\n            : readable;\n    }\n    /**\n     * Connect to the Liquity protocol and create a `ReadableEthersLiquity` object.\n     *\n     * @param signerOrProvider - Ethers `Signer` or `Provider` to use for connecting to the Ethereum\n     *                           network.\n     * @param optionalParams - Optional parameters that can be used to customize the connection.\n     */\n    static async connect(signerOrProvider, optionalParams) {\n        return ReadableEthersLiquity._from(await EthersLiquityConnection_1._connect(signerOrProvider, optionalParams));\n    }\n    hasStore() {\n        return false;\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTotalRedistributed} */\n    async getTotalRedistributed(overrides) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this.connection);\n        const [collateral, debt] = await Promise.all([\n            troveManager.L_ETH({ ...overrides }).then(decimalify),\n            troveManager.L_ZUSDDebt({ ...overrides }).then(decimalify)\n        ]);\n        return new lib_base_1.Trove(collateral, debt);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTroveBeforeRedistribution} */\n    async getTroveBeforeRedistribution(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this.connection));\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this.connection);\n        const [trove, snapshot] = await Promise.all([\n            troveManager.Troves(address, { ...overrides }),\n            troveManager.rewardSnapshots(address, { ...overrides })\n        ]);\n        if (trove.status === BackendTroveStatus.active) {\n            return new lib_base_1.TroveWithPendingRedistribution(address, userTroveStatusFrom(trove.status), decimalify(trove.coll), decimalify(trove.debt), decimalify(trove.stake), new lib_base_1.Trove(decimalify(snapshot.ETH), decimalify(snapshot.ZUSDDebt)));\n        }\n        else {\n            return new lib_base_1.TroveWithPendingRedistribution(address, userTroveStatusFrom(trove.status));\n        }\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTrove} */\n    async getTrove(address, overrides) {\n        const [trove, totalRedistributed] = await Promise.all([\n            this.getTroveBeforeRedistribution(address, overrides),\n            this.getTotalRedistributed(overrides)\n        ]);\n        return trove.applyRedistribution(totalRedistributed);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getNumberOfTroves} */\n    async getNumberOfTroves(overrides) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this.connection);\n        return (await troveManager.getTroveOwnersCount({ ...overrides })).toNumber();\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getPrice} */\n    getPrice(overrides) {\n        const { priceFeed } = EthersLiquityConnection_1._getContracts(this.connection);\n        return priceFeed.callStatic.fetchPrice({ ...overrides }).then(decimalify);\n    }\n    /** @internal */\n    async _getActivePool(overrides) {\n        const { activePool } = EthersLiquityConnection_1._getContracts(this.connection);\n        const [activeCollateral, activeDebt] = await Promise.all([\n            activePool.getETH({ ...overrides }),\n            activePool.getZUSDDebt({ ...overrides })\n        ].map(getBigNumber => getBigNumber.then(decimalify)));\n        return new lib_base_1.Trove(activeCollateral, activeDebt);\n    }\n    /** @internal */\n    async _getDefaultPool(overrides) {\n        const { defaultPool } = EthersLiquityConnection_1._getContracts(this.connection);\n        const [liquidatedCollateral, closedDebt] = await Promise.all([\n            defaultPool.getETH({ ...overrides }),\n            defaultPool.getZUSDDebt({ ...overrides })\n        ].map(getBigNumber => getBigNumber.then(decimalify)));\n        return new lib_base_1.Trove(liquidatedCollateral, closedDebt);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTotal} */\n    async getTotal(overrides) {\n        const [activePool, defaultPool] = await Promise.all([\n            this._getActivePool(overrides),\n            this._getDefaultPool(overrides)\n        ]);\n        return activePool.add(defaultPool);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getStabilityDeposit} */\n    async getStabilityDeposit(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this.connection));\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this.connection);\n        const [{ frontEndTag, initialValue }, currentZUSD, collateralGain, zeroReward] = await Promise.all([\n            stabilityPool.deposits(address, { ...overrides }),\n            stabilityPool.getCompoundedZUSDDeposit(address, { ...overrides }),\n            stabilityPool.getDepositorETHGain(address, { ...overrides }),\n            stabilityPool.getDepositorZEROGain(address, { ...overrides })\n        ]);\n        return new lib_base_1.StabilityDeposit(decimalify(initialValue), decimalify(currentZUSD), decimalify(collateralGain), decimalify(zeroReward), frontEndTag);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getRemainingStabilityPoolZEROReward} */\n    async getRemainingStabilityPoolZEROReward(overrides) {\n        const { communityIssuance } = EthersLiquityConnection_1._getContracts(this.connection);\n        const issuanceCap = decimalify(await communityIssuance.ZEROSupplyCap());\n        const totalZEROIssued = decimalify(await communityIssuance.totalZEROIssued({ ...overrides }));\n        const remaining = issuanceCap.gt(totalZEROIssued)\n            ? issuanceCap.sub(totalZEROIssued)\n            : lib_base_1.Decimal.from(0);\n        return remaining;\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZUSDInStabilityPool} */\n    getZUSDInStabilityPool(overrides) {\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this.connection);\n        return stabilityPool.getTotalZUSDDeposits({ ...overrides }).then(decimalify);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZUSDBalance} */\n    getZUSDBalance(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this.connection));\n        const { zusdToken } = EthersLiquityConnection_1._getContracts(this.connection);\n        return zusdToken.balanceOf(address, { ...overrides }).then(decimalify);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getNUEBalance} */\n    getNUEBalance(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this.connection));\n        const { nueToken } = EthersLiquityConnection_1._getContracts(this.connection);\n        if (!nueToken) {\n            throw \"nue token address not set\";\n        }\n        return nueToken.balanceOf(address, { ...overrides }).then(decimalify);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZEROBalance} */\n    getZEROBalance(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this.connection));\n        const { zeroToken } = EthersLiquityConnection_1._getContracts(this.connection);\n        return zeroToken.balanceOf(address, { ...overrides }).then(decimalify);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getCollateralSurplusBalance} */\n    getCollateralSurplusBalance(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this.connection));\n        const { collSurplusPool } = EthersLiquityConnection_1._getContracts(this.connection);\n        return collSurplusPool.getCollateral(address, { ...overrides }).then(decimalify);\n    }\n    async getTroves(params, overrides) {\n        var _a, _b;\n        const { multiTroveGetter } = EthersLiquityConnection_1._getContracts(this.connection);\n        expectPositiveInt(params, \"first\");\n        expectPositiveInt(params, \"startingAt\");\n        if (!validSortingOptions.includes(params.sortedBy)) {\n            throw new Error(`sortedBy must be one of: ${validSortingOptions.map(x => `\"${x}\"`).join(\", \")}`);\n        }\n        const [totalRedistributed, backendTroves] = await Promise.all([\n            params.beforeRedistribution ? undefined : this.getTotalRedistributed({ ...overrides }),\n            multiTroveGetter.getMultipleSortedTroves(params.sortedBy === \"descendingCollateralRatio\"\n                ? (_a = params.startingAt) !== null && _a !== void 0 ? _a : 0 : -(((_b = params.startingAt) !== null && _b !== void 0 ? _b : 0) + 1), params.first, { ...overrides })\n        ]);\n        const troves = mapBackendTroves(backendTroves);\n        if (totalRedistributed) {\n            return troves.map(trove => trove.applyRedistribution(totalRedistributed));\n        }\n        else {\n            return troves;\n        }\n    }\n    /** @internal */\n    async _getFeesFactory(overrides) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this.connection);\n        const [lastFeeOperationTime, baseRateWithoutDecay] = await Promise.all([\n            troveManager.lastFeeOperationTime({ ...overrides }),\n            troveManager.baseRate({ ...overrides }).then(decimalify)\n        ]);\n        return (blockTimestamp, recoveryMode) => new lib_base_1.Fees(baseRateWithoutDecay, MINUTE_DECAY_FACTOR, BETA, convertToDate(lastFeeOperationTime.toNumber()), convertToDate(blockTimestamp), recoveryMode);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getFees} */\n    async getFees(overrides) {\n        const [createFees, total, price, blockTimestamp] = await Promise.all([\n            this._getFeesFactory(overrides),\n            this.getTotal(overrides),\n            this.getPrice(overrides),\n            EthersLiquityConnection_1._getBlockTimestamp(this.connection, overrides === null || overrides === void 0 ? void 0 : overrides.blockTag)\n        ]);\n        return createFees(blockTimestamp, total.collateralRatioIsBelowCritical(price));\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZEROStake} */\n    async getZEROStake(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this.connection));\n        const { zeroStaking } = EthersLiquityConnection_1._getContracts(this.connection);\n        const [stakedZERO, collateralGain, zusdGain] = await Promise.all([\n            zeroStaking.stakes(address, { ...overrides }),\n            zeroStaking.getPendingETHGain(address, { ...overrides }),\n            zeroStaking.getPendingZUSDGain(address, { ...overrides })\n        ].map(getBigNumber => getBigNumber.then(decimalify)));\n        return new lib_base_1.ZEROStake(stakedZERO, collateralGain, zusdGain);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTotalStakedZERO} */\n    async getTotalStakedZERO(overrides) {\n        const { zeroStaking } = EthersLiquityConnection_1._getContracts(this.connection);\n        return zeroStaking.totalZEROStaked({ ...overrides }).then(decimalify);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getFrontendStatus} */\n    async getFrontendStatus(address, overrides) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireFrontendAddress(this.connection));\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this.connection);\n        const { registered, kickbackRate } = await stabilityPool.frontEnds(address, { ...overrides });\n        return registered\n            ? { status: \"registered\", kickbackRate: decimalify(kickbackRate) }\n            : { status: \"unregistered\" };\n    }\n}\nexports.ReadableEthersLiquity = ReadableEthersLiquity;\nconst mapBackendTroves = (troves) => troves.map(trove => new lib_base_1.TroveWithPendingRedistribution(trove.owner, \"open\", // These Troves are coming from the SortedTroves list, so they must be open\ndecimalify(trove.coll), decimalify(trove.debt), decimalify(trove.stake), new lib_base_1.Trove(decimalify(trove.snapshotETH), decimalify(trove.snapshotZUSDDebt))));\nclass BlockPolledLiquityStoreBasedCache {\n    constructor(store) {\n        this._store = store;\n    }\n    _blockHit(overrides) {\n        return (!overrides ||\n            overrides.blockTag === undefined ||\n            overrides.blockTag === this._store.state.blockTag);\n    }\n    _userHit(address, overrides) {\n        return (this._blockHit(overrides) &&\n            (address === undefined || address === this._store.connection.userAddress));\n    }\n    _frontendHit(address, overrides) {\n        return (this._blockHit(overrides) &&\n            (address === undefined || address === this._store.connection.frontendTag));\n    }\n    getTotalRedistributed(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.totalRedistributed;\n        }\n    }\n    getTroveBeforeRedistribution(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.troveBeforeRedistribution;\n        }\n    }\n    getTrove(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.trove;\n        }\n    }\n    getNumberOfTroves(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.numberOfTroves;\n        }\n    }\n    getPrice(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.price;\n        }\n    }\n    getTotal(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.total;\n        }\n    }\n    getStabilityDeposit(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.stabilityDeposit;\n        }\n    }\n    getRemainingStabilityPoolZEROReward(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.remainingStabilityPoolZEROReward;\n        }\n    }\n    getZUSDInStabilityPool(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.zusdInStabilityPool;\n        }\n    }\n    getZUSDBalance(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.zusdBalance;\n        }\n    }\n    getNUEBalance(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.nueBalance;\n        }\n    }\n    getZEROBalance(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.zeroBalance;\n        }\n    }\n    getCollateralSurplusBalance(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.collateralSurplusBalance;\n        }\n    }\n    getFees(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.fees;\n        }\n    }\n    getZEROStake(address, overrides) {\n        if (this._userHit(address, overrides)) {\n            return this._store.state.zeroStake;\n        }\n    }\n    getTotalStakedZERO(overrides) {\n        if (this._blockHit(overrides)) {\n            return this._store.state.totalStakedZERO;\n        }\n    }\n    getFrontendStatus(address, overrides) {\n        if (this._frontendHit(address, overrides)) {\n            return this._store.state.frontend;\n        }\n    }\n    getTroves() {\n        return undefined;\n    }\n}\nclass _BlockPolledReadableEthersLiquity extends lib_base_1._CachedReadableLiquity {\n    constructor(readable) {\n        const store = new BlockPolledLiquityStore_1.BlockPolledLiquityStore(readable);\n        super(readable, new BlockPolledLiquityStoreBasedCache(store));\n        this.store = store;\n        this.connection = readable.connection;\n    }\n    hasStore(store) {\n        return store === undefined || store === \"blockPolled\";\n    }\n    _getActivePool() {\n        throw new Error(\"Method not implemented.\");\n    }\n    _getDefaultPool() {\n        throw new Error(\"Method not implemented.\");\n    }\n    _getFeesFactory() {\n        throw new Error(\"Method not implemented.\");\n    }\n    _getRemainingLiquidityMiningZERORewardCalculator() {\n        throw new Error(\"Method not implemented.\");\n    }\n}\n//# sourceMappingURL=ReadableEthersLiquity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BlockPolledLiquityStore = void 0;\nconst constants_1 = require(\"@ethersproject/constants\");\nconst lib_base_1 = require(\"@liquity/lib-base\");\nconst EthersLiquityConnection_1 = require(\"./EthersLiquityConnection\");\nconst promiseAllValues = (object) => {\n    const keys = Object.keys(object);\n    return Promise.all(Object.values(object)).then(values => Object.fromEntries(values.map((value, i) => [keys[i], value])));\n};\nconst decimalify = (bigNumber) => lib_base_1.Decimal.fromBigNumberString(bigNumber.toHexString());\n/**\n * Ethers-based {@link @liquity/lib-base#LiquityStore} that updates state whenever there's a new\n * block.\n *\n * @public\n */\nclass BlockPolledLiquityStore extends lib_base_1.LiquityStore {\n    constructor(readable) {\n        super();\n        this.connection = readable.connection;\n        this._readable = readable;\n        this._provider = EthersLiquityConnection_1._getProvider(readable.connection);\n    }\n    async _getRiskiestTroveBeforeRedistribution(overrides) {\n        const riskiestTroves = await this._readable.getTroves({ first: 1, sortedBy: \"ascendingCollateralRatio\", beforeRedistribution: true }, overrides);\n        if (riskiestTroves.length === 0) {\n            return new lib_base_1.TroveWithPendingRedistribution(constants_1.AddressZero, \"nonExistent\");\n        }\n        return riskiestTroves[0];\n    }\n    async _get(blockTag) {\n        const { userAddress, frontendTag } = this.connection;\n        const { blockTimestamp, createFees, ...baseState } = await promiseAllValues({\n            blockTimestamp: EthersLiquityConnection_1._getBlockTimestamp(this.connection, blockTag),\n            createFees: this._readable._getFeesFactory({ blockTag }),\n            price: this._readable.getPrice({ blockTag }),\n            numberOfTroves: this._readable.getNumberOfTroves({ blockTag }),\n            totalRedistributed: this._readable.getTotalRedistributed({ blockTag }),\n            total: this._readable.getTotal({ blockTag }),\n            zusdInStabilityPool: this._readable.getZUSDInStabilityPool({ blockTag }),\n            totalStakedZERO: this._readable.getTotalStakedZERO({ blockTag }),\n            _riskiestTroveBeforeRedistribution: this._getRiskiestTroveBeforeRedistribution({ blockTag }),\n            remainingStabilityPoolZEROReward: this._readable.getRemainingStabilityPoolZEROReward({\n                blockTag\n            }),\n            frontend: frontendTag\n                ? this._readable.getFrontendStatus(frontendTag, { blockTag })\n                : { status: \"unregistered\" },\n            ...(userAddress\n                ? {\n                    accountBalance: this._provider.getBalance(userAddress, blockTag).then(decimalify),\n                    zusdBalance: this._readable.getZUSDBalance(userAddress, { blockTag }),\n                    nueBalance: this._readable.getNUEBalance(userAddress, { blockTag }),\n                    zeroBalance: this._readable.getZEROBalance(userAddress, { blockTag }),\n                    collateralSurplusBalance: this._readable.getCollateralSurplusBalance(userAddress, {\n                        blockTag\n                    }),\n                    troveBeforeRedistribution: this._readable.getTroveBeforeRedistribution(userAddress, {\n                        blockTag\n                    }),\n                    stabilityDeposit: this._readable.getStabilityDeposit(userAddress, { blockTag }),\n                    zeroStake: this._readable.getZEROStake(userAddress, { blockTag }),\n                    ownFrontend: this._readable.getFrontendStatus(userAddress, { blockTag })\n                }\n                : {\n                    accountBalance: lib_base_1.Decimal.ZERO,\n                    zusdBalance: lib_base_1.Decimal.ZERO,\n                    nueBalance: lib_base_1.Decimal.ZERO,\n                    zeroBalance: lib_base_1.Decimal.ZERO,\n                    uniTokenBalance: lib_base_1.Decimal.ZERO,\n                    uniTokenAllowance: lib_base_1.Decimal.ZERO,\n                    liquidityMiningStake: lib_base_1.Decimal.ZERO,\n                    liquidityMiningZEROReward: lib_base_1.Decimal.ZERO,\n                    collateralSurplusBalance: lib_base_1.Decimal.ZERO,\n                    troveBeforeRedistribution: new lib_base_1.TroveWithPendingRedistribution(constants_1.AddressZero, \"nonExistent\"),\n                    stabilityDeposit: new lib_base_1.StabilityDeposit(lib_base_1.Decimal.ZERO, lib_base_1.Decimal.ZERO, lib_base_1.Decimal.ZERO, lib_base_1.Decimal.ZERO, constants_1.AddressZero),\n                    zeroStake: new lib_base_1.ZEROStake(),\n                    ownFrontend: { status: \"unregistered\" }\n                })\n        });\n        return [\n            {\n                ...baseState,\n                _feesInNormalMode: createFees(blockTimestamp, false),\n            },\n            {\n                blockTag,\n                blockTimestamp\n            }\n        ];\n    }\n    /** @internal @override */\n    _doStart() {\n        this._get().then(state => {\n            if (!this._loaded) {\n                this._load(...state);\n            }\n        });\n        const blockListener = async (blockTag) => {\n            const state = await this._get(blockTag);\n            if (this._loaded) {\n                this._update(...state);\n            }\n            else {\n                this._load(...state);\n            }\n        };\n        this._provider.on(\"block\", blockListener);\n        return () => {\n            this._provider.off(\"block\", blockListener);\n        };\n    }\n    /** @internal @override */\n    _reduceExtra(oldState, stateUpdate) {\n        var _a, _b;\n        return {\n            blockTag: (_a = stateUpdate.blockTag) !== null && _a !== void 0 ? _a : oldState.blockTag,\n            blockTimestamp: (_b = stateUpdate.blockTimestamp) !== null && _b !== void 0 ? _b : oldState.blockTimestamp\n        };\n    }\n}\nexports.BlockPolledLiquityStore = BlockPolledLiquityStore;\n//# sourceMappingURL=BlockPolledLiquityStore.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PopulatableEthersLiquity = exports.PopulatedEthersRedemption = exports.PopulatedEthersLiquityTransaction = exports.SentEthersLiquityTransaction = exports._redeemMaxIterations = void 0;\nconst assert_1 = __importDefault(require(\"assert\"));\nconst constants_1 = require(\"@ethersproject/constants\");\nconst lib_base_1 = require(\"@liquity/lib-base\");\nconst EthersLiquityConnection_1 = require(\"./EthersLiquityConnection\");\nconst contracts_1 = require(\"./contracts\");\nconst parseLogs_1 = require(\"./parseLogs\");\nconst decimalify = (bigNumber) => lib_base_1.Decimal.fromBigNumberString(bigNumber.toHexString());\n// With 70 iterations redemption costs about ~10M gas, and each iteration accounts for ~138k more\n/** @internal */\nexports._redeemMaxIterations = 70;\nconst defaultBorrowingRateSlippageTolerance = lib_base_1.Decimal.from(0.005); // 0.5%\nconst defaultRedemptionRateSlippageTolerance = lib_base_1.Decimal.from(0.001); // 0.1%\nconst noDetails = () => undefined;\nconst compose = (f, g) => (_) => f(g(_));\nconst id = (t) => t;\n// Takes ~6-7K to update lastFeeOperationTime. Let's be on the safe side.\nconst addGasForPotentialLastFeeOperationTimeUpdate = (gas) => gas.add(10000);\n// First traversal in ascending direction takes ~50K, then ~13.5K per extra step.\n// 80K should be enough for 3 steps, plus some extra to be safe.\nconst addGasForPotentialListTraversal = (gas) => gas.add(80000);\nconst addGasForZEROIssuance = (gas) => gas.add(50000);\n// To get the best entropy available, we'd do something like:\n//\n// const bigRandomNumber = () =>\n//   BigNumber.from(\n//     `0x${Array.from(crypto.getRandomValues(new Uint32Array(8)))\n//       .map(u32 => u32.toString(16).padStart(8, \"0\"))\n//       .join(\"\")}`\n//   );\n//\n// However, Window.crypto is browser-specific. Since we only use this for randomly picking Troves\n// during the search for hints, Math.random() will do fine, too.\n//\n// This returns a random integer between 0 and Number.MAX_SAFE_INTEGER\nconst randomInteger = () => Math.floor(Math.random() * Number.MAX_SAFE_INTEGER);\n// Maximum number of trials to perform in a single getApproxHint() call. If the number of trials\n// required to get a statistically \"good\" hint is larger than this, the search for the hint will\n// be broken up into multiple getApproxHint() calls.\n//\n// This should be low enough to work with popular public Ethereum providers like Infura without\n// triggering any fair use limits.\nconst maxNumberOfTrialsAtOnce = 2500;\nfunction* generateTrials(totalNumberOfTrials) {\n    assert_1.default(Number.isInteger(totalNumberOfTrials) && totalNumberOfTrials > 0);\n    while (totalNumberOfTrials) {\n        const numberOfTrials = Math.min(totalNumberOfTrials, maxNumberOfTrialsAtOnce);\n        yield numberOfTrials;\n        totalNumberOfTrials -= numberOfTrials;\n    }\n}\n/**\n * A transaction that has already been sent.\n *\n * @remarks\n * Returned by {@link SendableEthersLiquity} functions.\n *\n * @public\n */\nclass SentEthersLiquityTransaction {\n    /** @internal */\n    constructor(rawSentTransaction, connection, parse) {\n        this.rawSentTransaction = rawSentTransaction;\n        this._connection = connection;\n        this._parse = parse;\n    }\n    _receiptFrom(rawReceipt) {\n        return rawReceipt\n            ? rawReceipt.status\n                ? lib_base_1._successfulReceipt(rawReceipt, this._parse(rawReceipt), () => parseLogs_1.logsToString(rawReceipt, EthersLiquityConnection_1._getContracts(this._connection)))\n                : lib_base_1._failedReceipt(rawReceipt)\n            : lib_base_1._pendingReceipt;\n    }\n    /** {@inheritDoc @liquity/lib-base#SentLiquityTransaction.getReceipt} */\n    async getReceipt() {\n        return this._receiptFrom(await EthersLiquityConnection_1._getProvider(this._connection).getTransactionReceipt(this.rawSentTransaction.hash));\n    }\n    /** {@inheritDoc @liquity/lib-base#SentLiquityTransaction.waitForReceipt} */\n    async waitForReceipt() {\n        const receipt = this._receiptFrom(await EthersLiquityConnection_1._getProvider(this._connection).waitForTransaction(this.rawSentTransaction.hash));\n        assert_1.default(receipt.status !== \"pending\");\n        return receipt;\n    }\n}\nexports.SentEthersLiquityTransaction = SentEthersLiquityTransaction;\n/**\n * A transaction that has been prepared for sending.\n *\n * @remarks\n * Returned by {@link PopulatableEthersLiquity} functions.\n *\n * @public\n */\nclass PopulatedEthersLiquityTransaction {\n    /** @internal */\n    constructor(rawPopulatedTransaction, connection, parse) {\n        this.rawPopulatedTransaction = rawPopulatedTransaction;\n        this._connection = connection;\n        this._parse = parse;\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatedLiquityTransaction.send} */\n    async send() {\n        return new SentEthersLiquityTransaction(await EthersLiquityConnection_1._requireSigner(this._connection).sendTransaction(this.rawPopulatedTransaction), this._connection, this._parse);\n    }\n}\nexports.PopulatedEthersLiquityTransaction = PopulatedEthersLiquityTransaction;\n/**\n * {@inheritDoc @liquity/lib-base#PopulatedRedemption}\n *\n * @public\n */\nclass PopulatedEthersRedemption extends PopulatedEthersLiquityTransaction {\n    /** @internal */\n    constructor(rawPopulatedTransaction, connection, attemptedZUSDAmount, redeemableZUSDAmount, increaseAmountByMinimumNetDebt) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(connection);\n        super(rawPopulatedTransaction, connection, ({ logs }) => troveManager\n            .extractEvents(logs, \"Redemption\")\n            .map(({ args: { _ETHSent, _ETHFee, _actualZUSDAmount, _attemptedZUSDAmount } }) => ({\n            attemptedZUSDAmount: decimalify(_attemptedZUSDAmount),\n            actualZUSDAmount: decimalify(_actualZUSDAmount),\n            collateralTaken: decimalify(_ETHSent),\n            fee: decimalify(_ETHFee)\n        }))[0]);\n        this.attemptedZUSDAmount = attemptedZUSDAmount;\n        this.redeemableZUSDAmount = redeemableZUSDAmount;\n        this.isTruncated = redeemableZUSDAmount.lt(attemptedZUSDAmount);\n        this._increaseAmountByMinimumNetDebt = increaseAmountByMinimumNetDebt;\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatedRedemption.increaseAmountByMinimumNetDebt} */\n    increaseAmountByMinimumNetDebt(maxRedemptionRate) {\n        if (!this._increaseAmountByMinimumNetDebt) {\n            throw new Error(\"PopulatedEthersRedemption: increaseAmountByMinimumNetDebt() can \" +\n                \"only be called when amount is truncated\");\n        }\n        return this._increaseAmountByMinimumNetDebt(maxRedemptionRate);\n    }\n}\nexports.PopulatedEthersRedemption = PopulatedEthersRedemption;\n/**\n * Ethers-based implementation of {@link @liquity/lib-base#PopulatableLiquity}.\n *\n * @public\n */\nclass PopulatableEthersLiquity {\n    constructor(readable) {\n        this._readable = readable;\n    }\n    _wrapSimpleTransaction(rawPopulatedTransaction) {\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, noDetails);\n    }\n    _wrapTroveChangeWithFees(params, rawPopulatedTransaction) {\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, ({ logs }) => {\n            const [newTrove] = borrowerOperations\n                .extractEvents(logs, \"TroveUpdated\")\n                .map(({ args: { _coll, _debt } }) => new lib_base_1.Trove(decimalify(_coll), decimalify(_debt)));\n            const [fee] = borrowerOperations\n                .extractEvents(logs, \"ZUSDBorrowingFeePaid\")\n                .map(({ args: { _ZUSDFee } }) => decimalify(_ZUSDFee));\n            return {\n                params,\n                newTrove,\n                fee\n            };\n        });\n    }\n    async _wrapTroveClosure(rawPopulatedTransaction) {\n        const { activePool, zusdToken } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, ({ logs, from: userAddress }) => {\n            const [repayZUSD] = zusdToken\n                .extractEvents(logs, \"Transfer\")\n                .filter(({ args: { from, to } }) => from === userAddress && to === constants_1.AddressZero)\n                .map(({ args: { value } }) => decimalify(value));\n            const [withdrawCollateral] = activePool\n                .extractEvents(logs, \"EtherSent\")\n                .filter(({ args: { _to } }) => _to === userAddress)\n                .map(({ args: { _amount } }) => decimalify(_amount));\n            return {\n                params: repayZUSD.nonZero ? { withdrawCollateral, repayZUSD } : { withdrawCollateral }\n            };\n        });\n    }\n    _wrapLiquidation(rawPopulatedTransaction) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, ({ logs }) => {\n            const liquidatedAddresses = troveManager\n                .extractEvents(logs, \"TroveLiquidated\")\n                .map(({ args: { _borrower } }) => _borrower);\n            const [totals] = troveManager\n                .extractEvents(logs, \"Liquidation\")\n                .map(({ args: { _ZUSDGasCompensation, _collGasCompensation, _liquidatedColl, _liquidatedDebt } }) => ({\n                collateralGasCompensation: decimalify(_collGasCompensation),\n                zusdGasCompensation: decimalify(_ZUSDGasCompensation),\n                totalLiquidated: new lib_base_1.Trove(decimalify(_liquidatedColl), decimalify(_liquidatedDebt))\n            }));\n            return {\n                liquidatedAddresses,\n                ...totals\n            };\n        });\n    }\n    _extractStabilityPoolGainsWithdrawalDetails(logs) {\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const [newZUSDDeposit] = stabilityPool\n            .extractEvents(logs, \"UserDepositChanged\")\n            .map(({ args: { _newDeposit } }) => decimalify(_newDeposit));\n        const [[collateralGain, zusdLoss]] = stabilityPool\n            .extractEvents(logs, \"ETHGainWithdrawn\")\n            .map(({ args: { _ETH, _ZUSDLoss } }) => [decimalify(_ETH), decimalify(_ZUSDLoss)]);\n        const [zeroReward] = stabilityPool\n            .extractEvents(logs, \"ZEROPaidToDepositor\")\n            .map(({ args: { _ZERO } }) => decimalify(_ZERO));\n        return {\n            zusdLoss,\n            newZUSDDeposit,\n            collateralGain,\n            zeroReward\n        };\n    }\n    _wrapStabilityPoolGainsWithdrawal(rawPopulatedTransaction) {\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, ({ logs }) => this._extractStabilityPoolGainsWithdrawalDetails(logs));\n    }\n    _wrapStabilityDepositTopup(change, rawPopulatedTransaction) {\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, ({ logs }) => ({\n            ...this._extractStabilityPoolGainsWithdrawalDetails(logs),\n            change\n        }));\n    }\n    async _wrapStabilityDepositWithdrawal(rawPopulatedTransaction) {\n        const { stabilityPool, zusdToken } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, ({ logs, from: userAddress }) => {\n            const gainsWithdrawalDetails = this._extractStabilityPoolGainsWithdrawalDetails(logs);\n            const [withdrawZUSD] = zusdToken\n                .extractEvents(logs, \"Transfer\")\n                .filter(({ args: { from, to } }) => from === stabilityPool.address && to === userAddress)\n                .map(({ args: { value } }) => decimalify(value));\n            return {\n                ...gainsWithdrawalDetails,\n                change: { withdrawZUSD, withdrawAllZUSD: gainsWithdrawalDetails.newZUSDDeposit.isZero }\n            };\n        });\n    }\n    _wrapCollateralGainTransfer(rawPopulatedTransaction) {\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return new PopulatedEthersLiquityTransaction(rawPopulatedTransaction, this._readable.connection, ({ logs }) => {\n            const [newTrove] = borrowerOperations\n                .extractEvents(logs, \"TroveUpdated\")\n                .map(({ args: { _coll, _debt } }) => new lib_base_1.Trove(decimalify(_coll), decimalify(_debt)));\n            return {\n                ...this._extractStabilityPoolGainsWithdrawalDetails(logs),\n                newTrove\n            };\n        });\n    }\n    async _findHintsForNominalCollateralRatio(nominalCollateralRatio) {\n        const { sortedTroves, hintHelpers } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const numberOfTroves = await this._readable.getNumberOfTroves();\n        if (!numberOfTroves) {\n            return [constants_1.AddressZero, constants_1.AddressZero];\n        }\n        if (nominalCollateralRatio.infinite) {\n            return [constants_1.AddressZero, await sortedTroves.getFirst()];\n        }\n        const totalNumberOfTrials = Math.ceil(10 * Math.sqrt(numberOfTroves));\n        const [firstTrials, ...restOfTrials] = generateTrials(totalNumberOfTrials);\n        const collectApproxHint = ({ latestRandomSeed, results }, numberOfTrials) => hintHelpers\n            .getApproxHint(nominalCollateralRatio.hex, numberOfTrials, latestRandomSeed)\n            .then(({ latestRandomSeed, ...result }) => ({\n            latestRandomSeed,\n            results: [...results, result]\n        }));\n        const { results } = await restOfTrials.reduce((p, numberOfTrials) => p.then(state => collectApproxHint(state, numberOfTrials)), collectApproxHint({ latestRandomSeed: randomInteger(), results: [] }, firstTrials));\n        const { hintAddress } = results.reduce((a, b) => (a.diff.lt(b.diff) ? a : b));\n        return sortedTroves.findInsertPosition(nominalCollateralRatio.hex, hintAddress, hintAddress);\n    }\n    async _findHints(trove) {\n        if (trove instanceof lib_base_1.TroveWithPendingRedistribution) {\n            throw new Error(\"Rewards must be applied to this Trove\");\n        }\n        return this._findHintsForNominalCollateralRatio(trove._nominalCollateralRatio);\n    }\n    async _findRedemptionHints(amount) {\n        const { hintHelpers } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const price = await this._readable.getPrice();\n        const { firstRedemptionHint, partialRedemptionHintNICR, truncatedZUSDamount } = await hintHelpers.getRedemptionHints(amount.hex, price.hex, exports._redeemMaxIterations);\n        const [partialRedemptionUpperHint, partialRedemptionLowerHint] = partialRedemptionHintNICR.isZero()\n            ? [constants_1.AddressZero, constants_1.AddressZero]\n            : await this._findHintsForNominalCollateralRatio(decimalify(partialRedemptionHintNICR));\n        return [\n            decimalify(truncatedZUSDamount),\n            firstRedemptionHint,\n            partialRedemptionUpperHint,\n            partialRedemptionLowerHint,\n            partialRedemptionHintNICR\n        ];\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.openTrove} */\n    async openTrove(params, maxBorrowingRate, overrides) {\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const normalized = lib_base_1._normalizeTroveCreation(params);\n        const { depositCollateral, borrowZUSD } = normalized;\n        const fees = await this._readable.getFees();\n        const borrowingRate = fees.borrowingRate();\n        const newTrove = lib_base_1.Trove.create(normalized, borrowingRate);\n        maxBorrowingRate =\n            maxBorrowingRate !== undefined\n                ? lib_base_1.Decimal.from(maxBorrowingRate)\n                : borrowingRate.add(defaultBorrowingRateSlippageTolerance);\n        return this._wrapTroveChangeWithFees(normalized, await borrowerOperations.estimateAndPopulate.openTrove({ value: depositCollateral.hex, ...overrides }, compose(addGasForPotentialLastFeeOperationTimeUpdate, addGasForPotentialListTraversal), maxBorrowingRate.hex, borrowZUSD.hex, ...(await this._findHints(newTrove))));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.openNueTrove} */\n    async openNueTrove(params, maxBorrowingRate, overrides) {\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const normalized = lib_base_1._normalizeTroveCreation(params);\n        const { depositCollateral, borrowZUSD } = normalized;\n        const fees = await this._readable.getFees();\n        const borrowingRate = fees.borrowingRate();\n        const newTrove = lib_base_1.Trove.create(normalized, borrowingRate);\n        maxBorrowingRate =\n            maxBorrowingRate !== undefined\n                ? lib_base_1.Decimal.from(maxBorrowingRate)\n                : borrowingRate.add(defaultBorrowingRateSlippageTolerance);\n        return this._wrapTroveChangeWithFees(normalized, await borrowerOperations.estimateAndPopulate.openNueTrove({ value: depositCollateral.hex, ...overrides }, compose(addGasForPotentialLastFeeOperationTimeUpdate, addGasForPotentialListTraversal), maxBorrowingRate.hex, borrowZUSD.hex, ...(await this._findHints(newTrove))));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.closeTrove} */\n    async closeTrove(overrides) {\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapTroveClosure(await borrowerOperations.estimateAndPopulate.closeTrove({ ...overrides }, id));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.closeNueTrove} */\n    async closeNueTrove(overrides) {\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapTroveClosure(await borrowerOperations.estimateAndPopulate.closeNueTrove({ ...overrides }, (gas) => gas.mul(125).div(100)));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.depositCollateral} */\n    depositCollateral(amount, overrides) {\n        return this.adjustTrove({ depositCollateral: amount }, undefined, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.withdrawCollateral} */\n    withdrawCollateral(amount, overrides) {\n        return this.adjustTrove({ withdrawCollateral: amount }, undefined, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.borrowZUSD} */\n    borrowZUSD(amount, maxBorrowingRate, overrides) {\n        return this.adjustTrove({ borrowZUSD: amount }, maxBorrowingRate, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.repayZUSD} */\n    repayZUSD(amount, overrides) {\n        return this.adjustTrove({ repayZUSD: amount }, undefined, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.adjustTrove} */\n    async adjustTrove(params, maxBorrowingRate, overrides) {\n        var _a, _b;\n        const address = EthersLiquityConnection_1._requireAddress(this._readable.connection, overrides);\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const normalized = lib_base_1._normalizeTroveAdjustment(params);\n        const { depositCollateral, withdrawCollateral, borrowZUSD, repayZUSD } = normalized;\n        const [trove, fees] = await Promise.all([\n            this._readable.getTrove(address),\n            borrowZUSD && this._readable.getFees()\n        ]);\n        const borrowingRate = fees === null || fees === void 0 ? void 0 : fees.borrowingRate();\n        const finalTrove = trove.adjust(normalized, borrowingRate);\n        maxBorrowingRate =\n            maxBorrowingRate !== undefined\n                ? lib_base_1.Decimal.from(maxBorrowingRate)\n                : (_a = borrowingRate === null || borrowingRate === void 0 ? void 0 : borrowingRate.add(defaultBorrowingRateSlippageTolerance)) !== null && _a !== void 0 ? _a : lib_base_1.Decimal.ZERO;\n        return this._wrapTroveChangeWithFees(normalized, await borrowerOperations.estimateAndPopulate.adjustTrove({ value: depositCollateral === null || depositCollateral === void 0 ? void 0 : depositCollateral.hex, ...overrides }, compose(borrowZUSD ? addGasForPotentialLastFeeOperationTimeUpdate : id, addGasForPotentialListTraversal), maxBorrowingRate.hex, (withdrawCollateral !== null && withdrawCollateral !== void 0 ? withdrawCollateral : lib_base_1.Decimal.ZERO).hex, ((_b = borrowZUSD !== null && borrowZUSD !== void 0 ? borrowZUSD : repayZUSD) !== null && _b !== void 0 ? _b : lib_base_1.Decimal.ZERO).hex, !!borrowZUSD, ...(await this._findHints(finalTrove))));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.adjustNueTrove} */\n    async adjustNueTrove(params, maxBorrowingRate, overrides) {\n        var _a, _b;\n        const address = EthersLiquityConnection_1._requireAddress(this._readable.connection, overrides);\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const normalized = lib_base_1._normalizeTroveAdjustment(params);\n        const { depositCollateral, withdrawCollateral, borrowZUSD, repayZUSD } = normalized;\n        const [trove, fees] = await Promise.all([\n            this._readable.getTrove(address),\n            borrowZUSD && this._readable.getFees()\n        ]);\n        const borrowingRate = fees === null || fees === void 0 ? void 0 : fees.borrowingRate();\n        const finalTrove = trove.adjust(normalized, borrowingRate);\n        maxBorrowingRate =\n            maxBorrowingRate !== undefined\n                ? lib_base_1.Decimal.from(maxBorrowingRate)\n                : (_a = borrowingRate === null || borrowingRate === void 0 ? void 0 : borrowingRate.add(defaultBorrowingRateSlippageTolerance)) !== null && _a !== void 0 ? _a : lib_base_1.Decimal.ZERO;\n        return this._wrapTroveChangeWithFees(normalized, await borrowerOperations.estimateAndPopulate.adjustNueTrove({ value: depositCollateral === null || depositCollateral === void 0 ? void 0 : depositCollateral.hex, ...overrides }, compose(borrowZUSD ? addGasForPotentialLastFeeOperationTimeUpdate : id, addGasForPotentialListTraversal), maxBorrowingRate.hex, (withdrawCollateral !== null && withdrawCollateral !== void 0 ? withdrawCollateral : lib_base_1.Decimal.ZERO).hex, ((_b = borrowZUSD !== null && borrowZUSD !== void 0 ? borrowZUSD : repayZUSD) !== null && _b !== void 0 ? _b : lib_base_1.Decimal.ZERO).hex, !!borrowZUSD, ...(await this._findHints(finalTrove))));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.claimCollateralSurplus} */\n    async claimCollateralSurplus(overrides) {\n        const { borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapSimpleTransaction(await borrowerOperations.estimateAndPopulate.claimCollateral({ ...overrides }, id));\n    }\n    /** @internal */\n    async setPrice(price, overrides) {\n        const { priceFeed } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        if (!contracts_1._priceFeedIsTestnet(priceFeed)) {\n            throw new Error(\"setPrice() unavailable on this deployment of Liquity\");\n        }\n        return this._wrapSimpleTransaction(await priceFeed.estimateAndPopulate.setPrice({ ...overrides }, id, lib_base_1.Decimal.from(price).hex));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.liquidate} */\n    async liquidate(address, overrides) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        if (Array.isArray(address)) {\n            return this._wrapLiquidation(await troveManager.estimateAndPopulate.batchLiquidateTroves({ ...overrides }, addGasForZEROIssuance, address));\n        }\n        else {\n            return this._wrapLiquidation(await troveManager.estimateAndPopulate.liquidate({ ...overrides }, addGasForZEROIssuance, address));\n        }\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.liquidateUpTo} */\n    async liquidateUpTo(maximumNumberOfTrovesToLiquidate, overrides) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapLiquidation(await troveManager.estimateAndPopulate.liquidateTroves({ ...overrides }, addGasForZEROIssuance, maximumNumberOfTrovesToLiquidate));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.depositZUSDInStabilityPool} */\n    async depositZUSDInStabilityPool(amount, frontendTag, overrides) {\n        var _a;\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const depositZUSD = lib_base_1.Decimal.from(amount);\n        return this._wrapStabilityDepositTopup({ depositZUSD }, await stabilityPool.estimateAndPopulate.provideToSP({ ...overrides }, addGasForZEROIssuance, depositZUSD.hex, (_a = frontendTag !== null && frontendTag !== void 0 ? frontendTag : this._readable.connection.frontendTag) !== null && _a !== void 0 ? _a : constants_1.AddressZero));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.withdrawZUSDFromStabilityPool} */\n    async withdrawZUSDFromStabilityPool(amount, overrides) {\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapStabilityDepositWithdrawal(await stabilityPool.estimateAndPopulate.withdrawFromSP({ ...overrides }, addGasForZEROIssuance, lib_base_1.Decimal.from(amount).hex));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.withdrawGainsFromStabilityPool} */\n    async withdrawGainsFromStabilityPool(overrides) {\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapStabilityPoolGainsWithdrawal(await stabilityPool.estimateAndPopulate.withdrawFromSP({ ...overrides }, addGasForZEROIssuance, lib_base_1.Decimal.ZERO.hex));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.transferCollateralGainToTrove} */\n    async transferCollateralGainToTrove(overrides) {\n        const address = EthersLiquityConnection_1._requireAddress(this._readable.connection, overrides);\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const [initialTrove, stabilityDeposit] = await Promise.all([\n            this._readable.getTrove(address),\n            this._readable.getStabilityDeposit(address)\n        ]);\n        const finalTrove = initialTrove.addCollateral(stabilityDeposit.collateralGain);\n        return this._wrapCollateralGainTransfer(await stabilityPool.estimateAndPopulate.withdrawETHGainToTrove({ ...overrides }, compose(addGasForPotentialListTraversal, addGasForZEROIssuance), ...(await this._findHints(finalTrove))));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.sendZUSD} */\n    async sendZUSD(toAddress, amount, overrides) {\n        const { zusdToken } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapSimpleTransaction(await zusdToken.estimateAndPopulate.transfer({ ...overrides }, id, toAddress, lib_base_1.Decimal.from(amount).hex));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.sendZERO} */\n    async sendZERO(toAddress, amount, overrides) {\n        const { zeroToken } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapSimpleTransaction(await zeroToken.estimateAndPopulate.transfer({ ...overrides }, id, toAddress, lib_base_1.Decimal.from(amount).hex));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.redeemZUSD} */\n    async redeemZUSD(amount, maxRedemptionRate, overrides) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const attemptedZUSDAmount = lib_base_1.Decimal.from(amount);\n        const [fees, total, [truncatedAmount, firstRedemptionHint, ...partialHints]] = await Promise.all([\n            this._readable.getFees(),\n            this._readable.getTotal(),\n            this._findRedemptionHints(attemptedZUSDAmount)\n        ]);\n        if (truncatedAmount.isZero) {\n            throw new Error(`redeemZUSD: amount too low to redeem (try at least ${lib_base_1.ZUSD_MINIMUM_NET_DEBT})`);\n        }\n        const defaultMaxRedemptionRate = (amount) => lib_base_1.Decimal.min(fees.redemptionRate(amount.div(total.debt)).add(defaultRedemptionRateSlippageTolerance), lib_base_1.Decimal.ONE);\n        const populateRedemption = async (attemptedZUSDAmount, maxRedemptionRate, truncatedAmount = attemptedZUSDAmount, partialHints = [constants_1.AddressZero, constants_1.AddressZero, 0]) => {\n            const maxRedemptionRateOrDefault = maxRedemptionRate !== undefined\n                ? lib_base_1.Decimal.from(maxRedemptionRate)\n                : defaultMaxRedemptionRate(truncatedAmount);\n            return new PopulatedEthersRedemption(await troveManager.estimateAndPopulate.redeemCollateral({ ...overrides }, addGasForPotentialLastFeeOperationTimeUpdate, truncatedAmount.hex, firstRedemptionHint, ...partialHints, exports._redeemMaxIterations, maxRedemptionRateOrDefault.hex), this._readable.connection, attemptedZUSDAmount, truncatedAmount, truncatedAmount.lt(attemptedZUSDAmount)\n                ? newMaxRedemptionRate => populateRedemption(truncatedAmount.add(lib_base_1.ZUSD_MINIMUM_NET_DEBT), newMaxRedemptionRate !== null && newMaxRedemptionRate !== void 0 ? newMaxRedemptionRate : maxRedemptionRate)\n                : undefined);\n        };\n        return populateRedemption(attemptedZUSDAmount, maxRedemptionRate, truncatedAmount, partialHints);\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.stakeZERO} */\n    async stakeZERO(amount, overrides) {\n        const { zeroStaking } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapSimpleTransaction(await zeroStaking.estimateAndPopulate.stake({ ...overrides }, id, lib_base_1.Decimal.from(amount).hex));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.unstakeZERO} */\n    async unstakeZERO(amount, overrides) {\n        const { zeroStaking } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapSimpleTransaction(await zeroStaking.estimateAndPopulate.unstake({ ...overrides }, id, lib_base_1.Decimal.from(amount).hex));\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.withdrawGainsFromStaking} */\n    withdrawGainsFromStaking(overrides) {\n        return this.unstakeZERO(lib_base_1.Decimal.ZERO, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#PopulatableLiquity.registerFrontend} */\n    async registerFrontend(kickbackRate, overrides) {\n        const { stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        return this._wrapSimpleTransaction(await stabilityPool.estimateAndPopulate.registerFrontEnd({ ...overrides }, id, lib_base_1.Decimal.from(kickbackRate).hex));\n    }\n}\nexports.PopulatableEthersLiquity = PopulatableEthersLiquity;\n//# sourceMappingURL=PopulatableEthersLiquity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SendableEthersLiquity = void 0;\nconst sendTransaction = (tx) => tx.send();\n/**\n * Ethers-based implementation of {@link @liquity/lib-base#SendableLiquity}.\n *\n * @public\n */\nclass SendableEthersLiquity {\n    constructor(populatable) {\n        this._populate = populatable;\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.openTrove} */\n    openTrove(params, maxBorrowingRate, overrides) {\n        return this._populate.openTrove(params, maxBorrowingRate, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.openNueTrove} */\n    openNueTrove(params, maxBorrowingRate, overrides) {\n        return this._populate.openNueTrove(params, maxBorrowingRate, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.closeTrove} */\n    closeTrove(overrides) {\n        return this._populate.closeTrove(overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.closeNueTrove} */\n    closeNueTrove(overrides) {\n        return this._populate.closeNueTrove(overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.adjustTrove} */\n    adjustTrove(params, maxBorrowingRate, overrides) {\n        return this._populate.adjustTrove(params, maxBorrowingRate, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.adjustNueTrove} */\n    adjustNueTrove(params, maxBorrowingRate, overrides) {\n        return this._populate.adjustNueTrove(params, maxBorrowingRate, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.depositCollateral} */\n    depositCollateral(amount, overrides) {\n        return this._populate.depositCollateral(amount, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.withdrawCollateral} */\n    withdrawCollateral(amount, overrides) {\n        return this._populate.withdrawCollateral(amount, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.borrowZUSD} */\n    borrowZUSD(amount, maxBorrowingRate, overrides) {\n        return this._populate.borrowZUSD(amount, maxBorrowingRate, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.repayZUSD} */\n    repayZUSD(amount, overrides) {\n        return this._populate.repayZUSD(amount, overrides).then(sendTransaction);\n    }\n    /** @internal */\n    setPrice(price, overrides) {\n        return this._populate.setPrice(price, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.liquidate} */\n    liquidate(address, overrides) {\n        return this._populate.liquidate(address, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.liquidateUpTo} */\n    liquidateUpTo(maximumNumberOfTrovesToLiquidate, overrides) {\n        return this._populate\n            .liquidateUpTo(maximumNumberOfTrovesToLiquidate, overrides)\n            .then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.depositZUSDInStabilityPool} */\n    depositZUSDInStabilityPool(amount, frontendTag, overrides) {\n        return this._populate\n            .depositZUSDInStabilityPool(amount, frontendTag, overrides)\n            .then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.withdrawZUSDFromStabilityPool} */\n    withdrawZUSDFromStabilityPool(amount, overrides) {\n        return this._populate.withdrawZUSDFromStabilityPool(amount, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.withdrawGainsFromStabilityPool} */\n    withdrawGainsFromStabilityPool(overrides) {\n        return this._populate.withdrawGainsFromStabilityPool(overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.transferCollateralGainToTrove} */\n    transferCollateralGainToTrove(overrides) {\n        return this._populate.transferCollateralGainToTrove(overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.sendZUSD} */\n    sendZUSD(toAddress, amount, overrides) {\n        return this._populate.sendZUSD(toAddress, amount, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.sendZERO} */\n    sendZERO(toAddress, amount, overrides) {\n        return this._populate.sendZERO(toAddress, amount, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.redeemZUSD} */\n    redeemZUSD(amount, maxRedemptionRate, overrides) {\n        return this._populate.redeemZUSD(amount, maxRedemptionRate, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.claimCollateralSurplus} */\n    claimCollateralSurplus(overrides) {\n        return this._populate.claimCollateralSurplus(overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.stakeZERO} */\n    stakeZERO(amount, overrides) {\n        return this._populate.stakeZERO(amount, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.unstakeZERO} */\n    unstakeZERO(amount, overrides) {\n        return this._populate.unstakeZERO(amount, overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.withdrawGainsFromStaking} */\n    withdrawGainsFromStaking(overrides) {\n        return this._populate.withdrawGainsFromStaking(overrides).then(sendTransaction);\n    }\n    /** {@inheritDoc @liquity/lib-base#SendableLiquity.registerFrontend} */\n    registerFrontend(kickbackRate, overrides) {\n        return this._populate.registerFrontend(kickbackRate, overrides).then(sendTransaction);\n    }\n}\nexports.SendableEthersLiquity = SendableEthersLiquity;\n//# sourceMappingURL=SendableEthersLiquity.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LiquityStoreProvider = exports.LiquityStoreContext = void 0;\nconst react_1 = __importStar(require(\"react\"));\nexports.LiquityStoreContext = react_1.createContext(undefined);\nconst LiquityStoreProvider = ({ store, loader, children }) => {\n    const [loadedStore, setLoadedStore] = react_1.useState();\n    react_1.useEffect(() => {\n        store.onLoaded = () => setLoadedStore(store);\n        const stop = store.start();\n        return () => {\n            store.onLoaded = undefined;\n            setLoadedStore(undefined);\n            stop();\n        };\n    }, [store]);\n    if (!loadedStore) {\n        return react_1.default.createElement(react_1.default.Fragment, null, loader);\n    }\n    return react_1.default.createElement(exports.LiquityStoreContext.Provider, { value: loadedStore }, children);\n};\nexports.LiquityStoreProvider = LiquityStoreProvider;\n//# sourceMappingURL=LiquityStoreProvider.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.equals = void 0;\nconst hasOwnProperty = (o, key) => Object.prototype.hasOwnProperty.call(o, key);\nconst shallowEquals = (a, b) => {\n    const keysA = Object.keys(a);\n    const keysB = Object.keys(b);\n    return (keysA.length === keysB.length &&\n        keysA.every(key => hasOwnProperty(b, key) && Object.is(a[key], b[key])));\n};\nconst isObject = (a) => a !== null && typeof a === \"object\";\nconst equals = (a, b) => isObject(a) && isObject(b) ? shallowEquals(a, b) : Object.is(a, b);\nexports.equals = equals;\n//# sourceMappingURL=equals.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BatchedWebSocketAugmentedWeb3Provider = exports.Batched = exports.isBatchedProvider = void 0;\nconst address_1 = require(\"@ethersproject/address\");\nconst contracts_1 = require(\"@ethersproject/contracts\");\nconst properties_1 = require(\"@ethersproject/properties\");\nconst WebSocketAugmentedProvider_1 = require(\"./WebSocketAugmentedProvider\");\nconst multicallAddress = {\n    1: \"0xeefBa1e63905eF1D7ACbA5a8513c70307C1cE441\",\n    3: \"0x53C43764255c17BD724F74c4eF150724AC50a3ed\",\n    4: \"0x42Ad527de7d4e9d9d011aC45B31D8551f8Fe9821\",\n    5: \"0x77dCa2C955b15e9dE4dbBCf1246B4B85b651e50e\",\n    42: \"0x2cc8688C5f75E365aaEEb4ea8D6a480405A48D2A\"\n};\nconst hasMulticall = (chainId) => chainId in multicallAddress;\nconst multicallAbi = [\n    {\n        type: \"function\",\n        name: \"aggregate\",\n        stateMutability: \"nonpayable\",\n        constant: false,\n        payable: false,\n        inputs: [\n            {\n                components: [\n                    {\n                        name: \"target\",\n                        type: \"address\"\n                    },\n                    {\n                        name: \"callData\",\n                        type: \"bytes\"\n                    }\n                ],\n                name: \"calls\",\n                type: \"tuple[]\"\n            }\n        ],\n        outputs: [\n            {\n                name: \"blockNumber\",\n                type: \"uint256\"\n            },\n            {\n                name: \"returnData\",\n                type: \"bytes[]\"\n            }\n        ]\n    },\n    {\n        type: \"function\",\n        name: \"getEthBalance\",\n        stateMutability: \"view\",\n        constant: true,\n        payable: false,\n        inputs: [\n            {\n                name: \"addr\",\n                type: \"address\"\n            }\n        ],\n        outputs: [\n            {\n                name: \"balance\",\n                type: \"uint256\"\n            }\n        ]\n    }\n];\nconst emptyBatch = () => ({ calls: [], callbacks: [] });\n// TODO\n//\n// Technically, requests that have a `from` address shouldn't be batched, because `msg.sender` will\n// be replaced with the Multicall contract's address when the batched calls are being executed.\n//\n// Currently, `@liquity/lib-ethers` makes many of its read calls through Signers, which populates\n// `from`. Instead these calls should be made through a Provider, and `from` should be omitted\n// (since none of the read calls in Liquity care about `msg.sender`).\n//\n// Then we'll be able to properly exclude calls that have `from` addresses from batching.\nconst batchableCall = (request) => request.gasLimit === undefined && request.gasPrice === undefined && request.value === undefined;\nconst batchedCall = (request, multicallAddress) => request.to === multicallAddress &&\n    typeof request.data === \"string\" &&\n    request.data.startsWith(\"0x252dba42\"); // signature of `aggregate((address,bytes)[])`\nconst batchedProviders = [];\nconst isBatchedProvider = (provider) => batchedProviders.some(batchedProvider => provider instanceof batchedProvider);\nexports.isBatchedProvider = isBatchedProvider;\nconst Batched = (Base) => {\n    const batchedProvider = class extends Base {\n        constructor() {\n            super(...arguments);\n            this.batchingDelayMs = 10;\n            this._chainId = 0;\n            this._batched = emptyBatch();\n            this._numberOfBatchedCalls = 0;\n            this._numberOfActualCalls = 0;\n        }\n        get chainId() {\n            return this._chainId;\n        }\n        set chainId(chainId) {\n            if (this._multicall) {\n                throw new Error(\"can only set chainId once\");\n            }\n            if (hasMulticall(chainId)) {\n                this._multicall = new contracts_1.Contract(multicallAddress[chainId], multicallAbi, this);\n            }\n            this._chainId = chainId;\n        }\n        async _dispatchCalls() {\n            const { calls, callbacks, blockTag } = this._batched;\n            this._batched = emptyBatch();\n            try {\n                const results = calls.length > 1\n                    ? await this._multicall.callStatic.aggregate(calls, { blockTag }).then(x => x.returnData)\n                    : [await super.call({ to: calls[0].target, data: calls[0].callData }, blockTag)];\n                callbacks.forEach(([resolve], i) => resolve(results[i]));\n            }\n            catch (error) {\n                callbacks.forEach(([, reject]) => reject(error));\n            }\n        }\n        _enqueueCall(call) {\n            if (this._timeoutId !== undefined) {\n                clearTimeout(this._timeoutId);\n            }\n            this._batched.calls.push(call);\n            this._timeoutId = setTimeout(() => this._dispatchCalls(), this.batchingDelayMs);\n            return new Promise((resolve, reject) => this._batched.callbacks.push([resolve, reject]));\n        }\n        _alreadyBatchedCallsConflictWith(blockTag) {\n            var _a;\n            return (this._batched.calls.length !== 0 &&\n                (blockTag !== null && blockTag !== void 0 ? blockTag : \"latest\") !== ((_a = this._batched.blockTag) !== null && _a !== void 0 ? _a : \"latest\"));\n        }\n        async call(request, blockTag) {\n            if (!this._multicall) {\n                return super.call(request, blockTag);\n            }\n            else {\n                const now = new Date().getTime();\n                if (this._timeOfLastRatioCheck === undefined) {\n                    this._timeOfLastRatioCheck = now;\n                }\n                else {\n                    const timeSinceLastRatioCheck = now - this._timeOfLastRatioCheck;\n                    if (timeSinceLastRatioCheck >= 10000 && this._numberOfActualCalls) {\n                        // console.log(\n                        //   `Call batching ratio: ${\n                        //     Math.round((10 * this._numberOfBatchedCalls) / this._numberOfActualCalls) / 10\n                        //   }X`\n                        // );\n                        this._numberOfBatchedCalls = 0;\n                        this._numberOfActualCalls = 0;\n                        this._timeOfLastRatioCheck = now;\n                    }\n                }\n            }\n            const [resolvedRequest, resolvedBlockTag] = await Promise.all([\n                properties_1.resolveProperties(request),\n                blockTag\n            ]);\n            if (batchedCall(resolvedRequest, this._multicall.address) ||\n                !batchableCall(resolvedRequest) ||\n                this._alreadyBatchedCallsConflictWith(resolvedBlockTag)) {\n                this._numberOfActualCalls++;\n                return super.call(resolvedRequest, resolvedBlockTag);\n            }\n            else {\n                this._numberOfBatchedCalls++;\n                if (this._batched.calls.length === 0) {\n                    this._batched.blockTag = resolvedBlockTag;\n                }\n                return this._enqueueCall({ target: resolvedRequest.to, callData: resolvedRequest.data });\n            }\n        }\n        async getBalance(addressOrName, blockTag) {\n            const [resolvedAddressOrName, resolvedBlockTag] = await Promise.all([addressOrName, blockTag]);\n            if (!address_1.isAddress(resolvedAddressOrName) || !this._multicall) {\n                return super.getBalance(resolvedAddressOrName, blockTag);\n            }\n            const [balance] = await this._multicall.functions.getEthBalance(resolvedAddressOrName, {\n                blockTag: resolvedBlockTag\n            });\n            return balance;\n        }\n    };\n    batchedProviders.push(batchedProvider);\n    return batchedProvider;\n};\nexports.Batched = Batched;\nexports.BatchedWebSocketAugmentedWeb3Provider = exports.Batched(WebSocketAugmentedProvider_1.WebSocketAugmentedWeb3Provider);\n//# sourceMappingURL=BatchedProvider.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._connectToMulticall = void 0;\nconst contracts_1 = require(\"@ethersproject/contracts\");\nconst multicallAbi = [\n    {\n        constant: true,\n        inputs: [],\n        name: \"getCurrentBlockTimestamp\",\n        outputs: [\n            {\n                name: \"timestamp\",\n                type: \"uint256\"\n            }\n        ],\n        payable: false,\n        stateMutability: \"view\",\n        type: \"function\"\n    }\n];\nconst multicallAddress = {\n    1: \"0xeefba1e63905ef1d7acba5a8513c70307c1ce441\",\n    3: \"0x53c43764255c17bd724f74c4ef150724ac50a3ed\",\n    4: \"0x42ad527de7d4e9d9d011ac45b31d8551f8fe9821\",\n    5: \"0x77dca2c955b15e9de4dbbcf1246b4b85b651e50e\",\n    42: \"0x2cc8688c5f75e365aaeeb4ea8d6a480405a48d2a\"\n};\nconst hasMulticall = (chainId) => chainId in multicallAddress;\nconst _connectToMulticall = (signerOrProvider, chainId) => hasMulticall(chainId)\n    ? new contracts_1.Contract(multicallAddress[chainId], multicallAbi, signerOrProvider)\n    : undefined;\nexports._connectToMulticall = _connectToMulticall;\n//# sourceMappingURL=_Multicall.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TroveWithPendingRedistribution = exports.UserTrove = exports._emptyTrove = exports.Trove = exports._normalizeTroveAdjustment = exports._normalizeTroveCreation = void 0;\nconst assert_1 = __importDefault(require(\"assert\"));\nconst Decimal_1 = require(\"./Decimal\");\nconst constants_1 = require(\"./constants\");\nconst invalidTroveCreation = (invalidTrove, error) => ({\n    type: \"invalidCreation\",\n    invalidTrove,\n    error\n});\nconst troveCreation = (params) => ({\n    type: \"creation\",\n    params\n});\nconst troveClosure = (params) => ({\n    type: \"closure\",\n    params\n});\nconst troveAdjustment = (params, setToZero) => ({\n    type: \"adjustment\",\n    params,\n    setToZero\n});\nconst valueIsDefined = (entry) => entry[1] !== undefined;\nconst allowedTroveCreationKeys = [\n    \"depositCollateral\",\n    \"borrowZUSD\"\n];\nfunction checkAllowedTroveCreationKeys(entries) {\n    const badKeys = entries\n        .filter(([k]) => !allowedTroveCreationKeys.includes(k))\n        .map(([k]) => `'${k}'`);\n    if (badKeys.length > 0) {\n        throw new Error(`TroveCreationParams: property ${badKeys.join(\", \")} not allowed`);\n    }\n}\nconst troveCreationParamsFromEntries = (entries) => {\n    const params = Object.fromEntries(entries);\n    const missingKeys = allowedTroveCreationKeys.filter(k => !(k in params)).map(k => `'${k}'`);\n    if (missingKeys.length > 0) {\n        throw new Error(`TroveCreationParams: property ${missingKeys.join(\", \")} missing`);\n    }\n    return params;\n};\nconst decimalize = ([k, v]) => [k, Decimal_1.Decimal.from(v)];\nconst nonZero = ([, v]) => !v.isZero;\n/** @internal */\nconst _normalizeTroveCreation = (params) => {\n    const definedEntries = Object.entries(params).filter(valueIsDefined);\n    checkAllowedTroveCreationKeys(definedEntries);\n    const nonZeroEntries = definedEntries.map(decimalize);\n    return troveCreationParamsFromEntries(nonZeroEntries);\n};\nexports._normalizeTroveCreation = _normalizeTroveCreation;\nconst allowedTroveAdjustmentKeys = [\n    \"depositCollateral\",\n    \"withdrawCollateral\",\n    \"borrowZUSD\",\n    \"repayZUSD\"\n];\nfunction checkAllowedTroveAdjustmentKeys(entries) {\n    const badKeys = entries\n        .filter(([k]) => !allowedTroveAdjustmentKeys.includes(k))\n        .map(([k]) => `'${k}'`);\n    if (badKeys.length > 0) {\n        throw new Error(`TroveAdjustmentParams: property ${badKeys.join(\", \")} not allowed`);\n    }\n}\nconst collateralChangeFrom = ({ depositCollateral, withdrawCollateral }) => {\n    if (depositCollateral !== undefined && withdrawCollateral !== undefined) {\n        throw new Error(\"TroveAdjustmentParams: 'depositCollateral' and 'withdrawCollateral' \" +\n            \"can't be present at the same time\");\n    }\n    if (depositCollateral !== undefined) {\n        return { depositCollateral };\n    }\n    if (withdrawCollateral !== undefined) {\n        return { withdrawCollateral };\n    }\n};\nconst debtChangeFrom = ({ borrowZUSD, repayZUSD }) => {\n    if (borrowZUSD !== undefined && repayZUSD !== undefined) {\n        throw new Error(\"TroveAdjustmentParams: 'borrowZUSD' and 'repayZUSD' can't be present at the same time\");\n    }\n    if (borrowZUSD !== undefined) {\n        return { borrowZUSD };\n    }\n    if (repayZUSD !== undefined) {\n        return { repayZUSD };\n    }\n};\nconst troveAdjustmentParamsFromEntries = (entries) => {\n    const params = Object.fromEntries(entries);\n    const collateralChange = collateralChangeFrom(params);\n    const debtChange = debtChangeFrom(params);\n    if (collateralChange !== undefined && debtChange !== undefined) {\n        return { ...collateralChange, ...debtChange };\n    }\n    if (collateralChange !== undefined) {\n        return collateralChange;\n    }\n    if (debtChange !== undefined) {\n        return debtChange;\n    }\n    throw new Error(\"TroveAdjustmentParams: must include at least one non-zero parameter\");\n};\n/** @internal */\nconst _normalizeTroveAdjustment = (params) => {\n    const definedEntries = Object.entries(params).filter(valueIsDefined);\n    checkAllowedTroveAdjustmentKeys(definedEntries);\n    const nonZeroEntries = definedEntries.map(decimalize).filter(nonZero);\n    return troveAdjustmentParamsFromEntries(nonZeroEntries);\n};\nexports._normalizeTroveAdjustment = _normalizeTroveAdjustment;\nconst applyFee = (borrowingRate, debtIncrease) => debtIncrease.mul(Decimal_1.Decimal.ONE.add(borrowingRate));\nconst unapplyFee = (borrowingRate, debtIncrease) => debtIncrease._divCeil(Decimal_1.Decimal.ONE.add(borrowingRate));\nconst NOMINAL_COLLATERAL_RATIO_PRECISION = Decimal_1.Decimal.from(100);\n/**\n * A combination of collateral and debt.\n *\n * @public\n */\nclass Trove {\n    /** @internal */\n    constructor(collateral = Decimal_1.Decimal.ZERO, debt = Decimal_1.Decimal.ZERO) {\n        this.collateral = collateral;\n        this.debt = debt;\n    }\n    get isEmpty() {\n        return this.collateral.isZero && this.debt.isZero;\n    }\n    /**\n     * Amount of ZUSD that must be repaid to close this Trove.\n     *\n     * @remarks\n     * This doesn't include the liquidation reserve, which is refunded in case of normal closure.\n     */\n    get netDebt() {\n        if (this.debt.lt(constants_1.ZUSD_LIQUIDATION_RESERVE)) {\n            throw new Error(`netDebt should not be used when debt < ${constants_1.ZUSD_LIQUIDATION_RESERVE}`);\n        }\n        return this.debt.sub(constants_1.ZUSD_LIQUIDATION_RESERVE);\n    }\n    /** @internal */\n    get _nominalCollateralRatio() {\n        return this.collateral.mulDiv(NOMINAL_COLLATERAL_RATIO_PRECISION, this.debt);\n    }\n    /** Calculate the Trove's collateralization ratio at a given price. */\n    collateralRatio(price) {\n        return this.collateral.mulDiv(price, this.debt);\n    }\n    /**\n     * Whether the Trove is undercollateralized at a given price.\n     *\n     * @returns\n     * `true` if the Trove's collateralization ratio is less than the\n     * {@link MINIMUM_COLLATERAL_RATIO}.\n     */\n    collateralRatioIsBelowMinimum(price) {\n        return this.collateralRatio(price).lt(constants_1.MINIMUM_COLLATERAL_RATIO);\n    }\n    /**\n     * Whether the collateralization ratio is less than the {@link CRITICAL_COLLATERAL_RATIO} at a\n     * given price.\n     *\n     * @example\n     * Can be used to check whether the Liquity protocol is in recovery mode by using it on the return\n     * value of {@link ReadableLiquity.getTotal | getTotal()}. For example:\n     *\n     * ```typescript\n     * const total = await liquity.getTotal();\n     * const price = await liquity.getPrice();\n     *\n     * if (total.collateralRatioIsBelowCritical(price)) {\n     *   // Recovery mode is active\n     * }\n     * ```\n     */\n    collateralRatioIsBelowCritical(price) {\n        return this.collateralRatio(price).lt(constants_1.CRITICAL_COLLATERAL_RATIO);\n    }\n    /** Whether the Trove is sufficiently collateralized to be opened during recovery mode. */\n    isOpenableInRecoveryMode(price) {\n        return this.collateralRatio(price).gte(constants_1.CRITICAL_COLLATERAL_RATIO);\n    }\n    /** @internal */\n    toString() {\n        return `{ collateral: ${this.collateral}, debt: ${this.debt} }`;\n    }\n    equals(that) {\n        return this.collateral.eq(that.collateral) && this.debt.eq(that.debt);\n    }\n    add(that) {\n        return new Trove(this.collateral.add(that.collateral), this.debt.add(that.debt));\n    }\n    addCollateral(collateral) {\n        return new Trove(this.collateral.add(collateral), this.debt);\n    }\n    addDebt(debt) {\n        return new Trove(this.collateral, this.debt.add(debt));\n    }\n    subtract(that) {\n        const { collateral, debt } = that;\n        return new Trove(this.collateral.gt(collateral) ? this.collateral.sub(collateral) : Decimal_1.Decimal.ZERO, this.debt.gt(debt) ? this.debt.sub(debt) : Decimal_1.Decimal.ZERO);\n    }\n    subtractCollateral(collateral) {\n        return new Trove(this.collateral.gt(collateral) ? this.collateral.sub(collateral) : Decimal_1.Decimal.ZERO, this.debt);\n    }\n    subtractDebt(debt) {\n        return new Trove(this.collateral, this.debt.gt(debt) ? this.debt.sub(debt) : Decimal_1.Decimal.ZERO);\n    }\n    multiply(multiplier) {\n        return new Trove(this.collateral.mul(multiplier), this.debt.mul(multiplier));\n    }\n    setCollateral(collateral) {\n        return new Trove(Decimal_1.Decimal.from(collateral), this.debt);\n    }\n    setDebt(debt) {\n        return new Trove(this.collateral, Decimal_1.Decimal.from(debt));\n    }\n    _debtChange({ debt }, borrowingRate) {\n        return debt.gt(this.debt)\n            ? { borrowZUSD: unapplyFee(borrowingRate, debt.sub(this.debt)) }\n            : { repayZUSD: this.debt.sub(debt) };\n    }\n    _collateralChange({ collateral }) {\n        return collateral.gt(this.collateral)\n            ? { depositCollateral: collateral.sub(this.collateral) }\n            : { withdrawCollateral: this.collateral.sub(collateral) };\n    }\n    /**\n     * Calculate the difference between this Trove and another.\n     *\n     * @param that - The other Trove.\n     * @param borrowingRate - Borrowing rate to use when calculating a borrowed amount.\n     *\n     * @returns\n     * An object representing the change, or `undefined` if the Troves are equal.\n     */\n    whatChanged(that, borrowingRate = constants_1.MINIMUM_BORROWING_RATE) {\n        var _a;\n        if (this.collateral.eq(that.collateral) && this.debt.eq(that.debt)) {\n            return undefined;\n        }\n        if (this.isEmpty) {\n            if (that.debt.lt(constants_1.ZUSD_LIQUIDATION_RESERVE)) {\n                return invalidTroveCreation(that, \"missingLiquidationReserve\");\n            }\n            return troveCreation({\n                depositCollateral: that.collateral,\n                borrowZUSD: unapplyFee(borrowingRate, that.netDebt)\n            });\n        }\n        if (that.isEmpty) {\n            return troveClosure(this.netDebt.nonZero\n                ? { withdrawCollateral: this.collateral, repayZUSD: this.netDebt }\n                : { withdrawCollateral: this.collateral });\n        }\n        return this.collateral.eq(that.collateral)\n            ? troveAdjustment(this._debtChange(that, borrowingRate), that.debt.zero && \"debt\")\n            : this.debt.eq(that.debt)\n                ? troveAdjustment(this._collateralChange(that), that.collateral.zero && \"collateral\")\n                : troveAdjustment({\n                    ...this._debtChange(that, borrowingRate),\n                    ...this._collateralChange(that)\n                }, (_a = (that.debt.zero && \"debt\")) !== null && _a !== void 0 ? _a : (that.collateral.zero && \"collateral\"));\n    }\n    /**\n     * Make a new Trove by applying a {@link TroveChange} to this Trove.\n     *\n     * @param change - The change to apply.\n     * @param borrowingRate - Borrowing rate to use when adding a borrowed amount to the Trove's debt.\n     */\n    apply(change, borrowingRate = constants_1.MINIMUM_BORROWING_RATE) {\n        if (!change) {\n            return this;\n        }\n        switch (change.type) {\n            case \"invalidCreation\":\n                if (!this.isEmpty) {\n                    throw new Error(\"Can't create onto existing Trove\");\n                }\n                return change.invalidTrove;\n            case \"creation\": {\n                if (!this.isEmpty) {\n                    throw new Error(\"Can't create onto existing Trove\");\n                }\n                const { depositCollateral, borrowZUSD } = change.params;\n                return new Trove(depositCollateral, constants_1.ZUSD_LIQUIDATION_RESERVE.add(applyFee(borrowingRate, borrowZUSD)));\n            }\n            case \"closure\":\n                if (this.isEmpty) {\n                    throw new Error(\"Can't close empty Trove\");\n                }\n                return exports._emptyTrove;\n            case \"adjustment\": {\n                const { setToZero, params: { depositCollateral, withdrawCollateral, borrowZUSD, repayZUSD } } = change;\n                const collateralDecrease = withdrawCollateral !== null && withdrawCollateral !== void 0 ? withdrawCollateral : Decimal_1.Decimal.ZERO;\n                const collateralIncrease = depositCollateral !== null && depositCollateral !== void 0 ? depositCollateral : Decimal_1.Decimal.ZERO;\n                const debtDecrease = repayZUSD !== null && repayZUSD !== void 0 ? repayZUSD : Decimal_1.Decimal.ZERO;\n                const debtIncrease = borrowZUSD ? applyFee(borrowingRate, borrowZUSD) : Decimal_1.Decimal.ZERO;\n                return setToZero === \"collateral\"\n                    ? this.setCollateral(Decimal_1.Decimal.ZERO).addDebt(debtIncrease).subtractDebt(debtDecrease)\n                    : setToZero === \"debt\"\n                        ? this.setDebt(Decimal_1.Decimal.ZERO)\n                            .addCollateral(collateralIncrease)\n                            .subtractCollateral(collateralDecrease)\n                        : this.add(new Trove(collateralIncrease, debtIncrease)).subtract(new Trove(collateralDecrease, debtDecrease));\n            }\n        }\n    }\n    /**\n     * Calculate the result of an {@link TransactableLiquity.openTrove | openTrove()} transaction.\n     *\n     * @param params - Parameters of the transaction.\n     * @param borrowingRate - Borrowing rate to use when calculating the Trove's debt.\n     */\n    static create(params, borrowingRate) {\n        return exports._emptyTrove.apply(troveCreation(exports._normalizeTroveCreation(params)), borrowingRate);\n    }\n    /**\n     * Calculate the parameters of an {@link TransactableLiquity.openTrove | openTrove()} transaction\n     * that will result in the given Trove.\n     *\n     * @param that - The Trove to recreate.\n     * @param borrowingRate - Current borrowing rate.\n     */\n    static recreate(that, borrowingRate) {\n        const change = exports._emptyTrove.whatChanged(that, borrowingRate);\n        assert_1.default((change === null || change === void 0 ? void 0 : change.type) === \"creation\");\n        return change.params;\n    }\n    /**\n     * Calculate the result of an {@link TransactableLiquity.adjustTrove | adjustTrove()} transaction\n     * on this Trove.\n     *\n     * @param params - Parameters of the transaction.\n     * @param borrowingRate - Borrowing rate to use when adding to the Trove's debt.\n     */\n    adjust(params, borrowingRate) {\n        return this.apply(troveAdjustment(exports._normalizeTroveAdjustment(params)), borrowingRate);\n    }\n    /**\n     * Calculate the parameters of an {@link TransactableLiquity.adjustTrove | adjustTrove()}\n     * transaction that will change this Trove into the given Trove.\n     *\n     * @param that - The desired result of the transaction.\n     * @param borrowingRate - Current borrowing rate.\n     */\n    adjustTo(that, borrowingRate) {\n        const change = this.whatChanged(that, borrowingRate);\n        assert_1.default((change === null || change === void 0 ? void 0 : change.type) === \"adjustment\");\n        return change.params;\n    }\n}\nexports.Trove = Trove;\n/** @internal */\nexports._emptyTrove = new Trove();\n/**\n * A Trove that is associated with a single owner.\n *\n * @remarks\n * The SDK uses the base {@link Trove} class as a generic container of collateral and debt, for\n * example to represent the {@link ReadableLiquity.getTotal | total collateral and debt} locked up\n * in the protocol.\n *\n * The `UserTrove` class extends `Trove` with extra information that's only available for Troves\n * that are associated with a single owner (such as the owner's address, or the Trove's status).\n *\n * @public\n */\nclass UserTrove extends Trove {\n    /** @internal */\n    constructor(ownerAddress, status, collateral, debt) {\n        super(collateral, debt);\n        this.ownerAddress = ownerAddress;\n        this.status = status;\n    }\n    equals(that) {\n        return (super.equals(that) && this.ownerAddress === that.ownerAddress && this.status === that.status);\n    }\n    /** @internal */\n    toString() {\n        return (`{ ownerAddress: \"${this.ownerAddress}\"` +\n            `, collateral: ${this.collateral}` +\n            `, debt: ${this.debt}` +\n            `, status: \"${this.status}\" }`);\n    }\n}\nexports.UserTrove = UserTrove;\n/**\n * A Trove in its state after the last direct modification.\n *\n * @remarks\n * The Trove may have received collateral and debt shares from liquidations since then.\n * Use {@link TroveWithPendingRedistribution.applyRedistribution | applyRedistribution()} to\n * calculate the Trove's most up-to-date state.\n *\n * @public\n */\nclass TroveWithPendingRedistribution extends UserTrove {\n    /** @internal */\n    constructor(ownerAddress, status, collateral, debt, stake = Decimal_1.Decimal.ZERO, snapshotOfTotalRedistributed = exports._emptyTrove) {\n        super(ownerAddress, status, collateral, debt);\n        this.stake = stake;\n        this.snapshotOfTotalRedistributed = snapshotOfTotalRedistributed;\n    }\n    applyRedistribution(totalRedistributed) {\n        const afterRedistribution = this.add(totalRedistributed.subtract(this.snapshotOfTotalRedistributed).multiply(this.stake));\n        return new UserTrove(this.ownerAddress, this.status, afterRedistribution.collateral, afterRedistribution.debt);\n    }\n    equals(that) {\n        return (super.equals(that) &&\n            this.stake.eq(that.stake) &&\n            this.snapshotOfTotalRedistributed.equals(that.snapshotOfTotalRedistributed));\n    }\n}\nexports.TroveWithPendingRedistribution = TroveWithPendingRedistribution;\n//# sourceMappingURL=Trove.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StabilityDeposit = void 0;\nconst Decimal_1 = require(\"./Decimal\");\n/**\n * A Stability Deposit and its accrued gains.\n *\n * @public\n */\nclass StabilityDeposit {\n    /** @internal */\n    constructor(initialZUSD, currentZUSD, collateralGain, zeroReward, frontendTag) {\n        this.initialZUSD = initialZUSD;\n        this.currentZUSD = currentZUSD;\n        this.collateralGain = collateralGain;\n        this.zeroReward = zeroReward;\n        this.frontendTag = frontendTag;\n        if (this.currentZUSD.gt(this.initialZUSD)) {\n            throw new Error(\"currentZUSD can't be greater than initialZUSD\");\n        }\n    }\n    get isEmpty() {\n        return (this.initialZUSD.isZero &&\n            this.currentZUSD.isZero &&\n            this.collateralGain.isZero &&\n            this.zeroReward.isZero);\n    }\n    /** @internal */\n    toString() {\n        return (`{ initialZUSD: ${this.initialZUSD}` +\n            `, currentZUSD: ${this.currentZUSD}` +\n            `, collateralGain: ${this.collateralGain}` +\n            `, zeroReward: ${this.zeroReward}` +\n            `, frontendTag: \"${this.frontendTag}\" }`);\n    }\n    /**\n     * Compare to another instance of `StabilityDeposit`.\n     */\n    equals(that) {\n        return (this.initialZUSD.eq(that.initialZUSD) &&\n            this.currentZUSD.eq(that.currentZUSD) &&\n            this.collateralGain.eq(that.collateralGain) &&\n            this.zeroReward.eq(that.zeroReward) &&\n            this.frontendTag === that.frontendTag);\n    }\n    /**\n     * Calculate the difference between the `currentZUSD` in this Stability Deposit and `thatZUSD`.\n     *\n     * @returns An object representing the change, or `undefined` if the deposited amounts are equal.\n     */\n    whatChanged(thatZUSD) {\n        thatZUSD = Decimal_1.Decimal.from(thatZUSD);\n        if (thatZUSD.lt(this.currentZUSD)) {\n            return { withdrawZUSD: this.currentZUSD.sub(thatZUSD), withdrawAllZUSD: thatZUSD.isZero };\n        }\n        if (thatZUSD.gt(this.currentZUSD)) {\n            return { depositZUSD: thatZUSD.sub(this.currentZUSD) };\n        }\n    }\n    /**\n     * Apply a {@link StabilityDepositChange} to this Stability Deposit.\n     *\n     * @returns The new deposited ZUSD amount.\n     */\n    apply(change) {\n        if (!change) {\n            return this.currentZUSD;\n        }\n        if (change.withdrawZUSD !== undefined) {\n            return change.withdrawAllZUSD || this.currentZUSD.lte(change.withdrawZUSD)\n                ? Decimal_1.Decimal.ZERO\n                : this.currentZUSD.sub(change.withdrawZUSD);\n        }\n        else {\n            return this.currentZUSD.add(change.depositZUSD);\n        }\n    }\n}\nexports.StabilityDeposit = StabilityDeposit;\n//# sourceMappingURL=StabilityDeposit.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ZEROStake = void 0;\nconst Decimal_1 = require(\"./Decimal\");\n/**\n * Represents a user's ZERO stake and accrued gains.\n *\n * @remarks\n * Returned by the {@link ReadableLiquity.getZEROStake | getZEROStake()} function.\n\n * @public\n */\nclass ZEROStake {\n    /** @internal */\n    constructor(stakedZERO = Decimal_1.Decimal.ZERO, collateralGain = Decimal_1.Decimal.ZERO, zusdGain = Decimal_1.Decimal.ZERO) {\n        this.stakedZERO = stakedZERO;\n        this.collateralGain = collateralGain;\n        this.zusdGain = zusdGain;\n    }\n    get isEmpty() {\n        return this.stakedZERO.isZero && this.collateralGain.isZero && this.zusdGain.isZero;\n    }\n    /** @internal */\n    toString() {\n        return (`{ stakedZERO: ${this.stakedZERO}` +\n            `, collateralGain: ${this.collateralGain}` +\n            `, zusdGain: ${this.zusdGain} }`);\n    }\n    /**\n     * Compare to another instance of `ZEROStake`.\n     */\n    equals(that) {\n        return (this.stakedZERO.eq(that.stakedZERO) &&\n            this.collateralGain.eq(that.collateralGain) &&\n            this.zusdGain.eq(that.zusdGain));\n    }\n    /**\n     * Calculate the difference between this `ZEROStake` and `thatStakedZERO`.\n     *\n     * @returns An object representing the change, or `undefined` if the staked amounts are equal.\n     */\n    whatChanged(thatStakedZERO) {\n        thatStakedZERO = Decimal_1.Decimal.from(thatStakedZERO);\n        if (thatStakedZERO.lt(this.stakedZERO)) {\n            return {\n                unstakeZERO: this.stakedZERO.sub(thatStakedZERO),\n                unstakeAllZERO: thatStakedZERO.isZero\n            };\n        }\n        if (thatStakedZERO.gt(this.stakedZERO)) {\n            return { stakeZERO: thatStakedZERO.sub(this.stakedZERO) };\n        }\n    }\n    /**\n     * Apply a {@link ZEROStakeChange} to this `ZEROStake`.\n     *\n     * @returns The new staked ZERO amount.\n     */\n    apply(change) {\n        if (!change) {\n            return this.stakedZERO;\n        }\n        if (change.unstakeZERO !== undefined) {\n            return change.unstakeAllZERO || this.stakedZERO.lte(change.unstakeZERO)\n                ? Decimal_1.Decimal.ZERO\n                : this.stakedZERO.sub(change.unstakeZERO);\n        }\n        else {\n            return this.stakedZERO.add(change.stakeZERO);\n        }\n    }\n}\nexports.ZEROStake = ZEROStake;\n//# sourceMappingURL=ZEROStake.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Fees = void 0;\nconst assert_1 = __importDefault(require(\"assert\"));\nconst Decimal_1 = require(\"./Decimal\");\nconst constants_1 = require(\"./constants\");\n/**\n * Calculator for fees.\n *\n * @remarks\n * Returned by the {@link ReadableLiquity.getFees | getFees()} function.\n *\n * @public\n */\nclass Fees {\n    /** @internal */\n    constructor(baseRateWithoutDecay, minuteDecayFactor, beta, lastFeeOperation, timeOfLatestBlock, recoveryMode) {\n        this._baseRateWithoutDecay = Decimal_1.Decimal.from(baseRateWithoutDecay);\n        this._minuteDecayFactor = Decimal_1.Decimal.from(minuteDecayFactor);\n        this._beta = Decimal_1.Decimal.from(beta);\n        this._lastFeeOperation = lastFeeOperation;\n        this._timeOfLatestBlock = timeOfLatestBlock;\n        this._recoveryMode = recoveryMode;\n        assert_1.default(this._minuteDecayFactor.lt(1));\n    }\n    /** @internal */\n    _setRecoveryMode(recoveryMode) {\n        return new Fees(this._baseRateWithoutDecay, this._minuteDecayFactor, this._beta, this._lastFeeOperation, this._timeOfLatestBlock, recoveryMode);\n    }\n    /**\n     * Compare to another instance of `Fees`.\n     */\n    equals(that) {\n        return (this._baseRateWithoutDecay.eq(that._baseRateWithoutDecay) &&\n            this._minuteDecayFactor.eq(that._minuteDecayFactor) &&\n            this._beta.eq(that._beta) &&\n            this._lastFeeOperation.getTime() === that._lastFeeOperation.getTime() &&\n            this._timeOfLatestBlock.getTime() === that._timeOfLatestBlock.getTime() &&\n            this._recoveryMode === that._recoveryMode);\n    }\n    /** @internal */\n    toString() {\n        return (`{ baseRateWithoutDecay: ${this._baseRateWithoutDecay}` +\n            `, lastFeeOperation: \"${this._lastFeeOperation.toLocaleString()}\"` +\n            `, recoveryMode: ${this._recoveryMode} } `);\n    }\n    /** @internal */\n    baseRate(when = this._timeOfLatestBlock) {\n        const millisecondsSinceLastFeeOperation = Math.max(when.getTime() - this._lastFeeOperation.getTime(), 0 // Clamp negative elapsed time to 0, in case the client's time is in the past.\n        // We will calculate slightly higher than actual fees, which is fine.\n        );\n        const minutesSinceLastFeeOperation = Math.floor(millisecondsSinceLastFeeOperation / 60000);\n        return this._minuteDecayFactor.pow(minutesSinceLastFeeOperation).mul(this._baseRateWithoutDecay);\n    }\n    /**\n     * Calculate the current borrowing rate.\n     *\n     * @param when - Optional timestamp that can be used to calculate what the borrowing rate would\n     *               decay to at a point of time in the future.\n     *\n     * @remarks\n     * By default, the fee is calculated at the time of the latest block. This can be overridden using\n     * the `when` parameter.\n     *\n     * To calculate the borrowing fee in ZUSD, multiply the borrowed ZUSD amount by the borrowing rate.\n     *\n     * @example\n     * ```typescript\n     * const fees = await liquity.getFees();\n     *\n     * const borrowedZUSDAmount = 100;\n     * const borrowingRate = fees.borrowingRate();\n     * const borrowingFeeZUSD = borrowingRate.mul(borrowedZUSDAmount);\n     * ```\n     */\n    borrowingRate(when) {\n        return this._recoveryMode\n            ? Decimal_1.Decimal.ZERO\n            : Decimal_1.Decimal.min(constants_1.MINIMUM_BORROWING_RATE.add(this.baseRate(when)), constants_1.MAXIMUM_BORROWING_RATE);\n    }\n    /**\n     * Calculate the current redemption rate.\n     *\n     * @param redeemedFractionOfSupply - The amount of ZUSD being redeemed divided by the total supply.\n     * @param when - Optional timestamp that can be used to calculate what the redemption rate would\n     *               decay to at a point of time in the future.\n     *\n     * @remarks\n     * By default, the fee is calculated at the time of the latest block. This can be overridden using\n     * the `when` parameter.\n  \n     * Unlike the borrowing rate, the redemption rate depends on the amount being redeemed. To be more\n     * precise, it depends on the fraction of the redeemed amount compared to the total ZUSD supply,\n     * which must be passed as a parameter.\n     *\n     * To calculate the redemption fee in ZUSD, multiply the redeemed ZUSD amount with the redemption\n     * rate.\n     *\n     * @example\n     * ```typescript\n     * const fees = await liquity.getFees();\n     * const total = await liquity.getTotal();\n     *\n     * const redeemedZUSDAmount = Decimal.from(100);\n     * const redeemedFractionOfSupply = redeemedZUSDAmount.div(total.debt);\n     * const redemptionRate = fees.redemptionRate(redeemedFractionOfSupply);\n     * const redemptionFeeZUSD = redemptionRate.mul(redeemedZUSDAmount);\n     * ```\n     */\n    redemptionRate(redeemedFractionOfSupply = Decimal_1.Decimal.ZERO, when) {\n        redeemedFractionOfSupply = Decimal_1.Decimal.from(redeemedFractionOfSupply);\n        let baseRate = this.baseRate(when);\n        if (redeemedFractionOfSupply.nonZero) {\n            baseRate = redeemedFractionOfSupply.div(this._beta).add(baseRate);\n        }\n        return Decimal_1.Decimal.min(constants_1.MINIMUM_REDEMPTION_RATE.add(baseRate), Decimal_1.Decimal.ONE);\n    }\n}\nexports.Fees = Fees;\n//# sourceMappingURL=Fees.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.TransactionFailedError = void 0;\n/**\n * Thrown by {@link TransactableLiquity} functions in case of transaction failure.\n *\n * @public\n */\nclass TransactionFailedError extends Error {\n    /** @internal */\n    constructor(name, message, failedReceipt) {\n        super(message);\n        this.name = name;\n        this.failedReceipt = failedReceipt;\n    }\n}\nexports.TransactionFailedError = TransactionFailedError;\n//# sourceMappingURL=TransactableLiquity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._successfulReceipt = exports._failedReceipt = exports._pendingReceipt = void 0;\n/** @internal */\nexports._pendingReceipt = { status: \"pending\" };\n/** @internal */\nconst _failedReceipt = (rawReceipt) => ({\n    status: \"failed\",\n    rawReceipt\n});\nexports._failedReceipt = _failedReceipt;\n/** @internal */\nconst _successfulReceipt = (rawReceipt, details, toString) => ({\n    status: \"succeeded\",\n    rawReceipt,\n    details,\n    ...(toString ? { toString } : {})\n});\nexports._successfulReceipt = _successfulReceipt;\n//# sourceMappingURL=SendableLiquity.js.map","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LiquityStore = void 0;\nconst assert_1 = __importDefault(require(\"assert\"));\nconst strictEquals = (a, b) => a === b;\nconst eq = (a, b) => a.eq(b);\nconst equals = (a, b) => a.equals(b);\nconst frontendStatusEquals = (a, b) => a.status === \"unregistered\"\n    ? b.status === \"unregistered\"\n    : b.status === \"registered\" && a.kickbackRate.eq(b.kickbackRate);\nconst showFrontendStatus = (x) => x.status === \"unregistered\"\n    ? '{ status: \"unregistered\" }'\n    : `{ status: \"registered\", kickbackRate: ${x.kickbackRate} }`;\nconst wrap = (f) => (...args) => f(...args);\nconst difference = (a, b) => Object.fromEntries(Object.entries(a).filter(([key, value]) => value !== b[key]));\n/**\n * Abstract base class of Liquity data store implementations.\n *\n * @remarks\n * The type parameter `T` may be used to type extra state added to {@link LiquityStoreState} by the\n * subclass.\n *\n * Implemented by {@link @liquity/lib-ethers#BlockPolledLiquityStore}.\n *\n * @public\n */\nclass LiquityStore {\n    constructor() {\n        /** Turn console logging on/off. */\n        this.logging = false;\n        /** @internal */\n        this._loaded = false;\n        this._listeners = new Set();\n    }\n    /**\n     * The current store state.\n     *\n     * @remarks\n     * Should not be accessed before the store is loaded. Assign a function to\n     * {@link LiquityStore.onLoaded | onLoaded} to get a callback when this happens.\n     *\n     * See {@link LiquityStoreState} for the list of properties returned.\n     */\n    get state() {\n        return Object.assign({}, this._baseState, this._derivedState, this._extraState);\n    }\n    /**\n     * Start monitoring the blockchain for Liquity state changes.\n     *\n     * @remarks\n     * The {@link LiquityStore.onLoaded | onLoaded} callback will be called after the state is fetched\n     * for the first time.\n     *\n     * Use the {@link LiquityStore.subscribe | subscribe()} function to register listeners.\n     *\n     * @returns Function to stop the monitoring.\n     */\n    start() {\n        const doStop = this._doStart();\n        return () => {\n            doStop();\n            this._cancelUpdateIfScheduled();\n        };\n    }\n    _cancelUpdateIfScheduled() {\n        if (this._updateTimeoutId !== undefined) {\n            clearTimeout(this._updateTimeoutId);\n        }\n    }\n    _scheduleUpdate() {\n        this._cancelUpdateIfScheduled();\n        this._updateTimeoutId = setTimeout(() => {\n            this._updateTimeoutId = undefined;\n            this._update();\n        }, 30000);\n    }\n    _logUpdate(name, next, show) {\n        if (this.logging) {\n            console.log(`${name} updated to ${show ? show(next) : next}`);\n        }\n        return next;\n    }\n    _updateIfChanged(equals, name, prev, next, show) {\n        return next !== undefined && !equals(prev, next) ? this._logUpdate(name, next, show) : prev;\n    }\n    _silentlyUpdateIfChanged(equals, prev, next) {\n        return next !== undefined && !equals(prev, next) ? next : prev;\n    }\n    _updateFees(name, prev, next) {\n        if (next && !next.equals(prev)) {\n            // Filter out fee update spam that happens on every new block by only logging when string\n            // representation changes.\n            if (`${next}` !== `${prev}`) {\n                this._logUpdate(name, next);\n            }\n            return next;\n        }\n        else {\n            return prev;\n        }\n    }\n    _reduce(baseState, baseStateUpdate) {\n        return {\n            frontend: this._updateIfChanged(frontendStatusEquals, \"frontend\", baseState.frontend, baseStateUpdate.frontend, showFrontendStatus),\n            ownFrontend: this._updateIfChanged(frontendStatusEquals, \"ownFrontend\", baseState.ownFrontend, baseStateUpdate.ownFrontend, showFrontendStatus),\n            numberOfTroves: this._updateIfChanged(strictEquals, \"numberOfTroves\", baseState.numberOfTroves, baseStateUpdate.numberOfTroves),\n            accountBalance: this._updateIfChanged(eq, \"accountBalance\", baseState.accountBalance, baseStateUpdate.accountBalance),\n            zusdBalance: this._updateIfChanged(eq, \"zusdBalance\", baseState.zusdBalance, baseStateUpdate.zusdBalance),\n            nueBalance: this._updateIfChanged(eq, \"nueBalance\", baseState.nueBalance, baseStateUpdate.nueBalance),\n            zeroBalance: this._updateIfChanged(eq, \"zeroBalance\", baseState.zeroBalance, baseStateUpdate.zeroBalance),\n            collateralSurplusBalance: this._updateIfChanged(eq, \"collateralSurplusBalance\", baseState.collateralSurplusBalance, baseStateUpdate.collateralSurplusBalance),\n            price: this._updateIfChanged(eq, \"price\", baseState.price, baseStateUpdate.price),\n            zusdInStabilityPool: this._updateIfChanged(eq, \"zusdInStabilityPool\", baseState.zusdInStabilityPool, baseStateUpdate.zusdInStabilityPool),\n            total: this._updateIfChanged(equals, \"total\", baseState.total, baseStateUpdate.total),\n            totalRedistributed: this._updateIfChanged(equals, \"totalRedistributed\", baseState.totalRedistributed, baseStateUpdate.totalRedistributed),\n            troveBeforeRedistribution: this._updateIfChanged(equals, \"troveBeforeRedistribution\", baseState.troveBeforeRedistribution, baseStateUpdate.troveBeforeRedistribution),\n            stabilityDeposit: this._updateIfChanged(equals, \"stabilityDeposit\", baseState.stabilityDeposit, baseStateUpdate.stabilityDeposit),\n            remainingStabilityPoolZEROReward: this._silentlyUpdateIfChanged(eq, baseState.remainingStabilityPoolZEROReward, baseStateUpdate.remainingStabilityPoolZEROReward),\n            _feesInNormalMode: this._silentlyUpdateIfChanged(equals, baseState._feesInNormalMode, baseStateUpdate._feesInNormalMode),\n            zeroStake: this._updateIfChanged(equals, \"zeroStake\", baseState.zeroStake, baseStateUpdate.zeroStake),\n            totalStakedZERO: this._updateIfChanged(eq, \"totalStakedZERO\", baseState.totalStakedZERO, baseStateUpdate.totalStakedZERO),\n            _riskiestTroveBeforeRedistribution: this._silentlyUpdateIfChanged(equals, baseState._riskiestTroveBeforeRedistribution, baseStateUpdate._riskiestTroveBeforeRedistribution)\n        };\n    }\n    _derive({ troveBeforeRedistribution, totalRedistributed, _feesInNormalMode, total, price, _riskiestTroveBeforeRedistribution }) {\n        const fees = _feesInNormalMode._setRecoveryMode(total.collateralRatioIsBelowCritical(price));\n        return {\n            trove: troveBeforeRedistribution.applyRedistribution(totalRedistributed),\n            fees,\n            borrowingRate: fees.borrowingRate(),\n            redemptionRate: fees.redemptionRate(),\n            haveUndercollateralizedTroves: _riskiestTroveBeforeRedistribution\n                .applyRedistribution(totalRedistributed)\n                .collateralRatioIsBelowMinimum(price)\n        };\n    }\n    _reduceDerived(derivedState, derivedStateUpdate) {\n        return {\n            fees: this._updateFees(\"fees\", derivedState.fees, derivedStateUpdate.fees),\n            trove: this._updateIfChanged(equals, \"trove\", derivedState.trove, derivedStateUpdate.trove),\n            borrowingRate: this._silentlyUpdateIfChanged(eq, derivedState.borrowingRate, derivedStateUpdate.borrowingRate),\n            redemptionRate: this._silentlyUpdateIfChanged(eq, derivedState.redemptionRate, derivedStateUpdate.redemptionRate),\n            haveUndercollateralizedTroves: this._updateIfChanged(strictEquals, \"haveUndercollateralizedTroves\", derivedState.haveUndercollateralizedTroves, derivedStateUpdate.haveUndercollateralizedTroves)\n        };\n    }\n    _notify(params) {\n        // Iterate on a copy of `_listeners`, to avoid notifying any new listeners subscribed by\n        // existing listeners, as that could result in infinite loops.\n        //\n        // Before calling a listener from our copy of `_listeners`, check if it has been removed from\n        // the original set. This way we avoid calling listeners that have already been unsubscribed\n        // by an earlier listener callback.\n        [...this._listeners].forEach(listener => {\n            if (this._listeners.has(listener)) {\n                listener(params);\n            }\n        });\n    }\n    /**\n     * Register a state change listener.\n     *\n     * @param listener - Function that will be called whenever state changes.\n     * @returns Function to unregister this listener.\n     */\n    subscribe(listener) {\n        const uniqueListener = wrap(listener);\n        this._listeners.add(uniqueListener);\n        return () => {\n            this._listeners.delete(uniqueListener);\n        };\n    }\n    /** @internal */\n    _load(baseState, extraState) {\n        assert_1.default(!this._loaded);\n        this._baseState = baseState;\n        this._derivedState = this._derive(baseState);\n        this._extraState = extraState;\n        this._loaded = true;\n        this._scheduleUpdate();\n        if (this.onLoaded) {\n            this.onLoaded();\n        }\n    }\n    /** @internal */\n    _update(baseStateUpdate, extraStateUpdate) {\n        assert_1.default(this._baseState && this._derivedState);\n        const oldState = this.state;\n        if (baseStateUpdate) {\n            this._baseState = this._reduce(this._baseState, baseStateUpdate);\n        }\n        // Always running this lets us derive state based on passage of time, like baseRate decay\n        this._derivedState = this._reduceDerived(this._derivedState, this._derive(this._baseState));\n        if (extraStateUpdate) {\n            assert_1.default(this._extraState);\n            this._extraState = this._reduceExtra(this._extraState, extraStateUpdate);\n        }\n        this._scheduleUpdate();\n        this._notify({\n            newState: this.state,\n            oldState,\n            stateChange: difference(this.state, oldState)\n        });\n    }\n}\nexports.LiquityStore = LiquityStore;\n//# sourceMappingURL=LiquityStore.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports._CachedReadableLiquity = void 0;\n/** @internal */\nclass _CachedReadableLiquity {\n    constructor(readable, cache) {\n        this._readable = readable;\n        this._cache = cache;\n    }\n    async getTotalRedistributed(...extraParams) {\n        var _a;\n        return ((_a = this._cache.getTotalRedistributed(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getTotalRedistributed(...extraParams));\n    }\n    async getTroveBeforeRedistribution(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getTroveBeforeRedistribution(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getTroveBeforeRedistribution(address, ...extraParams));\n    }\n    async getTrove(address, ...extraParams) {\n        const [troveBeforeRedistribution, totalRedistributed] = await Promise.all([\n            this.getTroveBeforeRedistribution(address, ...extraParams),\n            this.getTotalRedistributed(...extraParams)\n        ]);\n        return troveBeforeRedistribution.applyRedistribution(totalRedistributed);\n    }\n    async getNumberOfTroves(...extraParams) {\n        var _a;\n        return ((_a = this._cache.getNumberOfTroves(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getNumberOfTroves(...extraParams));\n    }\n    async getPrice(...extraParams) {\n        var _a;\n        return (_a = this._cache.getPrice(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getPrice(...extraParams);\n    }\n    async getTotal(...extraParams) {\n        var _a;\n        return (_a = this._cache.getTotal(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getTotal(...extraParams);\n    }\n    async getStabilityDeposit(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getStabilityDeposit(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getStabilityDeposit(address, ...extraParams));\n    }\n    async getRemainingStabilityPoolZEROReward(...extraParams) {\n        var _a;\n        return ((_a = this._cache.getRemainingStabilityPoolZEROReward(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getRemainingStabilityPoolZEROReward(...extraParams));\n    }\n    async getZUSDInStabilityPool(...extraParams) {\n        var _a;\n        return ((_a = this._cache.getZUSDInStabilityPool(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getZUSDInStabilityPool(...extraParams));\n    }\n    async getZUSDBalance(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getZUSDBalance(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getZUSDBalance(address, ...extraParams));\n    }\n    async getNUEBalance(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getNUEBalance(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getNUEBalance(address, ...extraParams));\n    }\n    async getZEROBalance(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getZEROBalance(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getZEROBalance(address, ...extraParams));\n    }\n    async getCollateralSurplusBalance(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getCollateralSurplusBalance(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getCollateralSurplusBalance(address, ...extraParams));\n    }\n    async getTroves(params, ...extraParams) {\n        var _a;\n        const { beforeRedistribution, ...restOfParams } = params;\n        const [totalRedistributed, troves] = await Promise.all([\n            beforeRedistribution ? undefined : this.getTotalRedistributed(...extraParams),\n            (_a = this._cache.getTroves({ beforeRedistribution: true, ...restOfParams }, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getTroves({ beforeRedistribution: true, ...restOfParams }, ...extraParams)\n        ]);\n        if (totalRedistributed) {\n            return troves.map(trove => trove.applyRedistribution(totalRedistributed));\n        }\n        else {\n            return troves;\n        }\n    }\n    async getFees(...extraParams) {\n        var _a;\n        return (_a = this._cache.getFees(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getFees(...extraParams);\n    }\n    async getZEROStake(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getZEROStake(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getZEROStake(address, ...extraParams));\n    }\n    async getTotalStakedZERO(...extraParams) {\n        var _a;\n        return ((_a = this._cache.getTotalStakedZERO(...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getTotalStakedZERO(...extraParams));\n    }\n    async getFrontendStatus(address, ...extraParams) {\n        var _a;\n        return ((_a = this._cache.getFrontendStatus(address, ...extraParams)) !== null && _a !== void 0 ? _a : this._readable.getFrontendStatus(address, ...extraParams));\n    }\n}\nexports._CachedReadableLiquity = _CachedReadableLiquity;\n//# sourceMappingURL=_CachedReadableLiquity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ObservableEthersLiquity = void 0;\nconst EthersLiquityConnection_1 = require(\"./EthersLiquityConnection\");\nconst debouncingDelayMs = 50;\nconst debounce = (listener) => {\n    let timeoutId = undefined;\n    let latestBlock = 0;\n    return (...args) => {\n        const event = args[args.length - 1];\n        if (event.blockNumber !== undefined && event.blockNumber > latestBlock) {\n            latestBlock = event.blockNumber;\n        }\n        if (timeoutId !== undefined) {\n            clearTimeout(timeoutId);\n        }\n        timeoutId = setTimeout(() => {\n            listener(latestBlock);\n            timeoutId = undefined;\n        }, debouncingDelayMs);\n    };\n};\n/** @alpha */\nclass ObservableEthersLiquity {\n    constructor(readable) {\n        this._readable = readable;\n    }\n    watchTotalRedistributed(onTotalRedistributedChanged) {\n        const { activePool, defaultPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const etherSent = activePool.filters.EtherSent();\n        const redistributionListener = debounce((blockTag) => {\n            this._readable.getTotalRedistributed({ blockTag }).then(onTotalRedistributedChanged);\n        });\n        const etherSentListener = (toAddress, _amount, event) => {\n            if (toAddress === defaultPool.address) {\n                redistributionListener(event);\n            }\n        };\n        activePool.on(etherSent, etherSentListener);\n        return () => {\n            activePool.removeListener(etherSent, etherSentListener);\n        };\n    }\n    watchTroveWithoutRewards(onTroveChanged, address) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this._readable.connection));\n        const { troveManager, borrowerOperations } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const troveUpdatedByTroveManager = troveManager.filters.TroveUpdated(address);\n        const troveUpdatedByBorrowerOperations = borrowerOperations.filters.TroveUpdated(address);\n        const troveListener = debounce((blockTag) => {\n            this._readable.getTroveBeforeRedistribution(address, { blockTag }).then(onTroveChanged);\n        });\n        troveManager.on(troveUpdatedByTroveManager, troveListener);\n        borrowerOperations.on(troveUpdatedByBorrowerOperations, troveListener);\n        return () => {\n            troveManager.removeListener(troveUpdatedByTroveManager, troveListener);\n            borrowerOperations.removeListener(troveUpdatedByBorrowerOperations, troveListener);\n        };\n    }\n    watchNumberOfTroves(onNumberOfTrovesChanged) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const { TroveUpdated } = troveManager.filters;\n        const troveUpdated = TroveUpdated();\n        const troveUpdatedListener = debounce((blockTag) => {\n            this._readable.getNumberOfTroves({ blockTag }).then(onNumberOfTrovesChanged);\n        });\n        troveManager.on(troveUpdated, troveUpdatedListener);\n        return () => {\n            troveManager.removeListener(troveUpdated, troveUpdatedListener);\n        };\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    watchPrice(onPriceChanged) {\n        // TODO revisit\n        // We no longer have our own PriceUpdated events. If we want to implement this in an event-based\n        // manner, we'll need to listen to aggregator events directly. Or we could do polling.\n        throw new Error(\"Method not implemented.\");\n    }\n    watchTotal(onTotalChanged) {\n        const { troveManager } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const { TroveUpdated } = troveManager.filters;\n        const troveUpdated = TroveUpdated();\n        const totalListener = debounce((blockTag) => {\n            this._readable.getTotal({ blockTag }).then(onTotalChanged);\n        });\n        troveManager.on(troveUpdated, totalListener);\n        return () => {\n            troveManager.removeListener(troveUpdated, totalListener);\n        };\n    }\n    watchStabilityDeposit(onStabilityDepositChanged, address) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this._readable.connection));\n        const { activePool, stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const { UserDepositChanged } = stabilityPool.filters;\n        const { EtherSent } = activePool.filters;\n        const userDepositChanged = UserDepositChanged(address);\n        const etherSent = EtherSent();\n        const depositListener = debounce((blockTag) => {\n            this._readable.getStabilityDeposit(address, { blockTag }).then(onStabilityDepositChanged);\n        });\n        const etherSentListener = (toAddress, _amount, event) => {\n            if (toAddress === stabilityPool.address) {\n                // Liquidation while Stability Pool has some deposits\n                // There may be new gains\n                depositListener(event);\n            }\n        };\n        stabilityPool.on(userDepositChanged, depositListener);\n        activePool.on(etherSent, etherSentListener);\n        return () => {\n            stabilityPool.removeListener(userDepositChanged, depositListener);\n            activePool.removeListener(etherSent, etherSentListener);\n        };\n    }\n    watchZUSDInStabilityPool(onZUSDInStabilityPoolChanged) {\n        const { zusdToken, stabilityPool } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const { Transfer } = zusdToken.filters;\n        const transferZUSDFromStabilityPool = Transfer(stabilityPool.address);\n        const transferZUSDToStabilityPool = Transfer(null, stabilityPool.address);\n        const stabilityPoolZUSDFilters = [transferZUSDFromStabilityPool, transferZUSDToStabilityPool];\n        const stabilityPoolZUSDListener = debounce((blockTag) => {\n            this._readable.getZUSDInStabilityPool({ blockTag }).then(onZUSDInStabilityPoolChanged);\n        });\n        stabilityPoolZUSDFilters.forEach(filter => zusdToken.on(filter, stabilityPoolZUSDListener));\n        return () => stabilityPoolZUSDFilters.forEach(filter => zusdToken.removeListener(filter, stabilityPoolZUSDListener));\n    }\n    watchZUSDBalance(onZUSDBalanceChanged, address) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this._readable.connection));\n        const { zusdToken } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        const { Transfer } = zusdToken.filters;\n        const transferZUSDFromUser = Transfer(address);\n        const transferZUSDToUser = Transfer(null, address);\n        const zusdTransferFilters = [transferZUSDFromUser, transferZUSDToUser];\n        const zusdTransferListener = debounce((blockTag) => {\n            this._readable.getZUSDBalance(address, { blockTag }).then(onZUSDBalanceChanged);\n        });\n        zusdTransferFilters.forEach(filter => zusdToken.on(filter, zusdTransferListener));\n        return () => zusdTransferFilters.forEach(filter => zusdToken.removeListener(filter, zusdTransferListener));\n    }\n    watchNUEBalance(onNUEBalanceChanged, address) {\n        address !== null && address !== void 0 ? address : (address = EthersLiquityConnection_1._requireAddress(this._readable.connection));\n        const { nueToken } = EthersLiquityConnection_1._getContracts(this._readable.connection);\n        if (!nueToken) {\n            throw \"nue token address not set\";\n        }\n        const { Transfer } = nueToken.filters;\n        const transferNUEFromUser = Transfer(address);\n        const transferNUEToUser = Transfer(null, address);\n        const nueTransferFilters = [transferNUEFromUser, transferNUEToUser];\n        const zusdTransferListener = debounce((blockTag) => {\n            this._readable.getNUEBalance(address, { blockTag }).then(onNUEBalanceChanged);\n        });\n        nueTransferFilters.forEach(filter => nueToken.on(filter, zusdTransferListener));\n        return () => nueTransferFilters.forEach(filter => nueToken.removeListener(filter, zusdTransferListener));\n    }\n}\nexports.ObservableEthersLiquity = ObservableEthersLiquity;\n//# sourceMappingURL=ObservableEthersLiquity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.logsToString = void 0;\nconst bignumber_1 = require(\"@ethersproject/bignumber\");\nconst constants_1 = require(\"@ethersproject/constants\");\nconst lib_base_1 = require(\"@liquity/lib-base\");\nconst interfaceLookupFrom = (contractLookup) => {\n    return Object.fromEntries(Object.entries(contractLookup).map(([, contract]) => [contract.address, contract.interface]));\n};\nconst nameLookupFrom = (contractLookup) => {\n    return Object.fromEntries(Object.entries(contractLookup).map(([name, contract]) => [contract.address, name]));\n};\nconst tryToParseLog = (log, interfaceLookup) => {\n    const { address } = log;\n    if (address in interfaceLookup) {\n        try {\n            return { address, logDescription: interfaceLookup[address].parseLog(log) };\n        }\n        catch (err) {\n            console.warn(\"Failed to parse log:\");\n            console.warn(log);\n            console.warn(\"Caught:\");\n            console.warn(err);\n        }\n    }\n};\nconst parseLogs = (logs, interfaceLookup) => {\n    const parsedLogs = [];\n    const unparsedLogs = [];\n    logs.forEach(log => {\n        const parsedLog = tryToParseLog(log, interfaceLookup);\n        if (parsedLog) {\n            parsedLogs.push(parsedLog);\n        }\n        else {\n            unparsedLogs.push(log);\n        }\n    });\n    return [parsedLogs, unparsedLogs];\n};\nconst VERY_BIG = bignumber_1.BigNumber.from(10).pow(9);\nconst prettify = (arg, nameLookup) => {\n    if (bignumber_1.BigNumber.isBigNumber(arg)) {\n        if (arg.gte(VERY_BIG)) {\n            return `${lib_base_1.Decimal.fromBigNumberString(arg.toHexString())}e18`;\n        }\n        else {\n            return arg.toString();\n        }\n    }\n    else if (typeof arg === \"string\") {\n        return arg === constants_1.AddressZero\n            ? \"address(0)\"\n            : nameLookup && arg in nameLookup\n                ? nameLookup[arg]\n                : arg;\n    }\n    else {\n        return String(arg);\n    }\n};\nconst logDescriptionToString = (logDescription, nameLookup) => {\n    const prettyEntries = Object.entries(logDescription.args)\n        .filter(([key]) => !key.match(/^[0-9]/))\n        .map(([key, value]) => `${key}: ${prettify(value, nameLookup)}`);\n    return `${logDescription.name}({ ${prettyEntries.join(\", \")} })`;\n};\nconst logsToString = (receipt, contracts) => {\n    const contractLookup = contracts;\n    const interfaceLookup = interfaceLookupFrom(contractLookup);\n    const contractNameLookup = nameLookupFrom(contractLookup);\n    const nameLookup = {\n        [receipt.from]: \"user\",\n        ...contractNameLookup\n    };\n    const [parsedLogs, unparsedLogs] = parseLogs(receipt.logs, interfaceLookup);\n    if (unparsedLogs.length > 0) {\n        console.warn(\"Warning: not all logs were parsed. Unparsed logs:\");\n        console.warn(unparsedLogs);\n    }\n    if (parsedLogs.length > 0) {\n        return (`Logs of tx ${receipt.transactionHash}:\\n` +\n            parsedLogs\n                .map(({ address, logDescription }) => `  ${contractNameLookup[address]}.${logDescriptionToString(logDescription, nameLookup)}`)\n                .join(\"\\n\"));\n    }\n    else {\n        return `No logs were parsed in tx ${receipt.transactionHash}`;\n    }\n};\nexports.logsToString = logsToString;\n//# sourceMappingURL=parseLogs.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EthersLiquity = exports.EthersTransactionFailedError = void 0;\nconst lib_base_1 = require(\"@liquity/lib-base\");\nconst EthersLiquityConnection_1 = require(\"./EthersLiquityConnection\");\nconst PopulatableEthersLiquity_1 = require(\"./PopulatableEthersLiquity\");\nconst ReadableEthersLiquity_1 = require(\"./ReadableEthersLiquity\");\nconst SendableEthersLiquity_1 = require(\"./SendableEthersLiquity\");\n/**\n * Thrown by {@link EthersLiquity} in case of transaction failure.\n *\n * @public\n */\nclass EthersTransactionFailedError extends lib_base_1.TransactionFailedError {\n    constructor(message, failedReceipt) {\n        super(\"EthersTransactionFailedError\", message, failedReceipt);\n    }\n}\nexports.EthersTransactionFailedError = EthersTransactionFailedError;\nconst waitForSuccess = async (tx) => {\n    const receipt = await tx.waitForReceipt();\n    if (receipt.status !== \"succeeded\") {\n        throw new EthersTransactionFailedError(\"Transaction failed\", receipt);\n    }\n    return receipt.details;\n};\n/**\n * Convenience class that combines multiple interfaces of the library in one object.\n *\n * @public\n */\nclass EthersLiquity {\n    /** @internal */\n    constructor(readable) {\n        this._readable = readable;\n        this.connection = readable.connection;\n        this.populate = new PopulatableEthersLiquity_1.PopulatableEthersLiquity(readable);\n        this.send = new SendableEthersLiquity_1.SendableEthersLiquity(this.populate);\n    }\n    /** @internal */\n    static _from(connection) {\n        if (EthersLiquityConnection_1._usingStore(connection)) {\n            return new _EthersLiquityWithStore(ReadableEthersLiquity_1.ReadableEthersLiquity._from(connection));\n        }\n        else {\n            return new EthersLiquity(ReadableEthersLiquity_1.ReadableEthersLiquity._from(connection));\n        }\n    }\n    static async connect(signerOrProvider, optionalParams) {\n        return EthersLiquity._from(await EthersLiquityConnection_1._connect(signerOrProvider, optionalParams));\n    }\n    hasStore() {\n        return false;\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTotalRedistributed} */\n    getTotalRedistributed(overrides) {\n        return this._readable.getTotalRedistributed(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTroveBeforeRedistribution} */\n    getTroveBeforeRedistribution(address, overrides) {\n        return this._readable.getTroveBeforeRedistribution(address, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTrove} */\n    getTrove(address, overrides) {\n        return this._readable.getTrove(address, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getNumberOfTroves} */\n    getNumberOfTroves(overrides) {\n        return this._readable.getNumberOfTroves(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getPrice} */\n    getPrice(overrides) {\n        return this._readable.getPrice(overrides);\n    }\n    /** @internal */\n    _getActivePool(overrides) {\n        return this._readable._getActivePool(overrides);\n    }\n    /** @internal */\n    _getDefaultPool(overrides) {\n        return this._readable._getDefaultPool(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTotal} */\n    getTotal(overrides) {\n        return this._readable.getTotal(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getStabilityDeposit} */\n    getStabilityDeposit(address, overrides) {\n        return this._readable.getStabilityDeposit(address, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getRemainingStabilityPoolZEROReward} */\n    getRemainingStabilityPoolZEROReward(overrides) {\n        return this._readable.getRemainingStabilityPoolZEROReward(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZUSDInStabilityPool} */\n    getZUSDInStabilityPool(overrides) {\n        return this._readable.getZUSDInStabilityPool(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZUSDBalance} */\n    getZUSDBalance(address, overrides) {\n        return this._readable.getZUSDBalance(address, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getNUEBalance} */\n    getNUEBalance(address, overrides) {\n        return this._readable.getNUEBalance(address, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZEROBalance} */\n    getZEROBalance(address, overrides) {\n        return this._readable.getZEROBalance(address, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getCollateralSurplusBalance} */\n    getCollateralSurplusBalance(address, overrides) {\n        return this._readable.getCollateralSurplusBalance(address, overrides);\n    }\n    getTroves(params, overrides) {\n        return this._readable.getTroves(params, overrides);\n    }\n    /** @internal */\n    _getFeesFactory(overrides) {\n        return this._readable._getFeesFactory(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getFees} */\n    getFees(overrides) {\n        return this._readable.getFees(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getZEROStake} */\n    getZEROStake(address, overrides) {\n        return this._readable.getZEROStake(address, overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getTotalStakedZERO} */\n    getTotalStakedZERO(overrides) {\n        return this._readable.getTotalStakedZERO(overrides);\n    }\n    /** {@inheritDoc @liquity/lib-base#ReadableLiquity.getFrontendStatus} */\n    getFrontendStatus(address, overrides) {\n        return this._readable.getFrontendStatus(address, overrides);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.openTrove}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    openTrove(params, maxBorrowingRate, overrides) {\n        return this.send.openTrove(params, maxBorrowingRate, overrides).then(waitForSuccess);\n    }\n    /**\n   * {@inheritDoc @liquity/lib-base#TransactableLiquity.openTrove}\n   *\n   * @throws\n   * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n   */\n    openNueTrove(params, maxBorrowingRate, overrides) {\n        return this.send.openNueTrove(params, maxBorrowingRate, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.closeTrove}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    closeTrove(overrides) {\n        return this.send.closeTrove(overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.closeNueTrove}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    closeNueTrove(overrides) {\n        return this.send.closeNueTrove(overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.adjustTrove}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    adjustTrove(params, maxBorrowingRate, overrides) {\n        return this.send.adjustTrove(params, maxBorrowingRate, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.adjustNueTrove}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    adjustNueTrove(params, maxBorrowingRate, overrides) {\n        return this.send.adjustNueTrove(params, maxBorrowingRate, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.depositCollateral}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    depositCollateral(amount, overrides) {\n        return this.send.depositCollateral(amount, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.withdrawCollateral}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    withdrawCollateral(amount, overrides) {\n        return this.send.withdrawCollateral(amount, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.borrowZUSD}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    borrowZUSD(amount, maxBorrowingRate, overrides) {\n        return this.send.borrowZUSD(amount, maxBorrowingRate, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.repayZUSD}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    repayZUSD(amount, overrides) {\n        return this.send.repayZUSD(amount, overrides).then(waitForSuccess);\n    }\n    /** @internal */\n    setPrice(price, overrides) {\n        return this.send.setPrice(price, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.liquidate}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    liquidate(address, overrides) {\n        return this.send.liquidate(address, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.liquidateUpTo}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    liquidateUpTo(maximumNumberOfTrovesToLiquidate, overrides) {\n        return this.send.liquidateUpTo(maximumNumberOfTrovesToLiquidate, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.depositZUSDInStabilityPool}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    depositZUSDInStabilityPool(amount, frontendTag, overrides) {\n        return this.send.depositZUSDInStabilityPool(amount, frontendTag, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.withdrawZUSDFromStabilityPool}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    withdrawZUSDFromStabilityPool(amount, overrides) {\n        return this.send.withdrawZUSDFromStabilityPool(amount, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.withdrawGainsFromStabilityPool}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    withdrawGainsFromStabilityPool(overrides) {\n        return this.send.withdrawGainsFromStabilityPool(overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.transferCollateralGainToTrove}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    transferCollateralGainToTrove(overrides) {\n        return this.send.transferCollateralGainToTrove(overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.sendZUSD}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    sendZUSD(toAddress, amount, overrides) {\n        return this.send.sendZUSD(toAddress, amount, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.sendZERO}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    sendZERO(toAddress, amount, overrides) {\n        return this.send.sendZERO(toAddress, amount, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.redeemZUSD}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    redeemZUSD(amount, maxRedemptionRate, overrides) {\n        return this.send.redeemZUSD(amount, maxRedemptionRate, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.claimCollateralSurplus}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    claimCollateralSurplus(overrides) {\n        return this.send.claimCollateralSurplus(overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.stakeZERO}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    stakeZERO(amount, overrides) {\n        return this.send.stakeZERO(amount, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.unstakeZERO}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    unstakeZERO(amount, overrides) {\n        return this.send.unstakeZERO(amount, overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.withdrawGainsFromStaking}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    withdrawGainsFromStaking(overrides) {\n        return this.send.withdrawGainsFromStaking(overrides).then(waitForSuccess);\n    }\n    /**\n     * {@inheritDoc @liquity/lib-base#TransactableLiquity.registerFrontend}\n     *\n     * @throws\n     * Throws {@link EthersTransactionFailedError} in case of transaction failure.\n     */\n    registerFrontend(kickbackRate, overrides) {\n        return this.send.registerFrontend(kickbackRate, overrides).then(waitForSuccess);\n    }\n}\nexports.EthersLiquity = EthersLiquity;\nclass _EthersLiquityWithStore extends EthersLiquity {\n    constructor(readable) {\n        super(readable);\n        this.store = readable.store;\n    }\n    hasStore(store) {\n        return store === undefined || store === this.connection.useStore;\n    }\n}\n//# sourceMappingURL=EthersLiquity.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useLiquityReducer = void 0;\nconst react_1 = require(\"react\");\nconst equals_1 = require(\"../utils/equals\");\nconst useLiquityStore_1 = require(\"./useLiquityStore\");\nconst useLiquityReducer = (reduce, init) => {\n    const store = useLiquityStore_1.useLiquityStore();\n    const oldStore = react_1.useRef(store);\n    const state = react_1.useRef(init(store.state));\n    const [, rerender] = react_1.useReducer(() => ({}), {});\n    const dispatch = react_1.useCallback((action) => {\n        const newState = reduce(state.current, action);\n        if (!equals_1.equals(newState, state.current)) {\n            state.current = newState;\n            rerender();\n        }\n    }, [reduce]);\n    react_1.useEffect(() => store.subscribe(params => dispatch({ type: \"updateStore\", ...params })), [\n        store,\n        dispatch\n    ]);\n    if (oldStore.current !== store) {\n        state.current = init(store.state);\n        oldStore.current = store;\n    }\n    return [state.current, dispatch];\n};\nexports.useLiquityReducer = useLiquityReducer;\n//# sourceMappingURL=useLiquityReducer.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useLiquitySelector = void 0;\nconst react_1 = require(\"react\");\nconst equals_1 = require(\"../utils/equals\");\nconst useLiquityStore_1 = require(\"./useLiquityStore\");\nconst useLiquitySelector = (select) => {\n    const store = useLiquityStore_1.useLiquityStore();\n    const [, rerender] = react_1.useReducer(() => ({}), {});\n    react_1.useEffect(() => store.subscribe(({ newState, oldState }) => {\n        if (!equals_1.equals(select(newState), select(oldState))) {\n            rerender();\n        }\n    }), [store, select]);\n    return select(store.state);\n};\nexports.useLiquitySelector = useLiquitySelector;\n//# sourceMappingURL=useLiquitySelector.js.map","import { AddressZero } from \"@ethersproject/constants\";\nimport { isAddress, getAddress } from \"@ethersproject/address\";\n\nexport type LiquityFrontendConfig = {\n  frontendTag: string;\n  infuraApiKey?: string;\n  testnetOnly?: boolean;\n};\n\nconst defaultConfig: LiquityFrontendConfig = {\n  frontendTag: AddressZero\n};\n\nfunction hasKey<K extends string>(o: object, k: K): o is Record<K, unknown> {\n  return k in o;\n}\n\nconst parseConfig = (json: unknown): LiquityFrontendConfig => {\n  const config = { ...defaultConfig };\n\n  if (typeof json === \"object\" && json !== null) {\n    if (hasKey(json, \"frontendTag\") && json.frontendTag !== \"\") {\n      const { frontendTag } = json;\n\n      if (typeof frontendTag === \"string\" && isAddress(frontendTag)) {\n        config.frontendTag = getAddress(frontendTag);\n      } else {\n        console.error(\"Malformed frontendTag:\");\n        console.log(frontendTag);\n      }\n    }\n\n    if (hasKey(json, \"infuraApiKey\") && json.infuraApiKey !== \"\") {\n      const { infuraApiKey } = json;\n\n      if (typeof infuraApiKey === \"string\") {\n        config.infuraApiKey = infuraApiKey;\n      } else {\n        console.error(\"Malformed infuraApiKey:\");\n        console.log(infuraApiKey);\n      }\n    }\n\n    if (hasKey(json, \"testnetOnly\")) {\n      const { testnetOnly } = json;\n\n      if (typeof testnetOnly === \"boolean\") {\n        config.testnetOnly = testnetOnly;\n      } else {\n        console.error(\"Malformed testnetOnly:\");\n        console.log(testnetOnly);\n      }\n    }\n  } else {\n    console.error(\"Malformed config:\");\n    console.log(json);\n  }\n\n  return config;\n};\n\nlet configPromise: Promise<LiquityFrontendConfig> | undefined = undefined;\n\nconst fetchConfig = async () => {\n  try {\n    const response = await fetch(\"config.json\");\n\n    if (!response.ok) {\n      throw new Error(`Failed to fetch config.json (status ${response.status})`);\n    }\n\n    return parseConfig(await response.json());\n  } catch (err) {\n    console.error(err);\n    return { ...defaultConfig };\n  }\n};\n\nexport const getConfig = (): Promise<LiquityFrontendConfig> => {\n  if (!configPromise) {\n    configPromise = fetchConfig();\n  }\n\n  return configPromise;\n};\n","import React, { createContext, useContext, useEffect, useMemo, useState } from \"react\";\nimport { Provider } from \"@ethersproject/abstract-provider\";\nimport { getNetwork } from \"@ethersproject/networks\";\nimport { Web3Provider } from \"@ethersproject/providers\";\nimport { useWeb3React } from \"@web3-react/core\";\n\nimport { isBatchedProvider, isWebSocketAugmentedProvider } from \"@liquity/providers\";\nimport {\n  BlockPolledLiquityStore,\n  EthersLiquity,\n  EthersLiquityWithStore,\n  _connectByChainId\n} from \"@liquity/lib-ethers\";\n\nimport { LiquityFrontendConfig, getConfig } from \"../config\";\n\ntype LiquityContextValue = {\n  config: LiquityFrontendConfig;\n  account: string;\n  provider: Provider;\n  liquity: EthersLiquityWithStore<BlockPolledLiquityStore>;\n};\n\nconst LiquityContext = createContext<LiquityContextValue | undefined>(undefined);\n\ntype LiquityProviderProps = {\n  loader?: React.ReactNode;\n  unsupportedNetworkFallback?: (chainId: number) => React.ReactNode;\n  unsupportedMainnetFallback?: React.ReactNode;\n};\n\nconst wsParams = (network: string, infuraApiKey: string): [string, string] => [\n  `wss://${network === \"homestead\" ? \"mainnet\" : network}.infura.io/ws/v3/${infuraApiKey}`,\n  network\n];\n\nconst supportedNetworks = [\"homestead\", \"kovan\", \"rinkeby\", \"ropsten\", \"goerli\", \"rsktestoracles\"];\n\nexport const LiquityProvider: React.FC<LiquityProviderProps> = ({\n  children,\n  loader,\n  unsupportedNetworkFallback,\n  unsupportedMainnetFallback\n}) => {\n  const { library: provider, account, chainId } = useWeb3React<Web3Provider>();\n  const [config, setConfig] = useState<LiquityFrontendConfig>();\n\n  const connection = useMemo(() => {\n    if (config && provider && account && chainId) {\n      try {\n        return _connectByChainId(provider, provider.getSigner(account), chainId, {\n          userAddress: account,\n          frontendTag: config.frontendTag,\n          useStore: \"blockPolled\"\n        });\n      } catch (e) {\n        console.log(e)\n      }\n    }\n  }, [config, provider, account, chainId]);\n\n  useEffect(() => {\n    getConfig().then(setConfig);\n  }, []);\n\n  useEffect(() => {\n    if (config && connection) {\n      const { provider, chainId } = connection;\n\n      if (isBatchedProvider(provider) && provider.chainId !== chainId) {\n        provider.chainId = chainId;\n      }\n\n      if (isWebSocketAugmentedProvider(provider)) {\n        const network = getNetwork(chainId);\n\n        if (network.name && supportedNetworks.includes(network.name) && config.infuraApiKey) {\n          provider.openWebSocket(...wsParams(network.name, config.infuraApiKey));\n        } else if (connection._isDev) {\n          provider.openWebSocket(`ws://${window.location.hostname}:8546`, chainId);\n        }\n\n        return () => {\n          provider.closeWebSocket();\n        };\n      }\n    }\n  }, [config, connection]);\n\n  if (!config || !provider || !account || !chainId) {\n    return <>{loader}</>;\n  }\n\n  if (config.testnetOnly && chainId === 1) {\n    return <>{unsupportedMainnetFallback}</>;\n  }\n\n  if (!connection) {\n    return unsupportedNetworkFallback ? <>{unsupportedNetworkFallback(chainId)}</> : null;\n  }\n\n  const liquity = EthersLiquity._from(connection);\n  liquity.store.logging = true;\n\n  return (\n    <LiquityContext.Provider value={{ config, account, provider, liquity }}>\n      {children}\n    </LiquityContext.Provider>\n  );\n};\n\nexport const useLiquity = () => {\n  const liquityContext = useContext(LiquityContext);\n\n  if (!liquityContext) {\n    throw new Error(\"You must provide a LiquityContext via LiquityProvider\");\n  }\n\n  return liquityContext;\n};\n","import { InjectedConnector } from \"@web3-react/injected-connector\";\n\nexport const injectedConnector = new InjectedConnector({});\n","import React from \"react\";\nimport { library, IconName, IconProp } from \"@fortawesome/fontawesome-svg-core\";\nimport {\n  faCircleNotch,\n  faCheckCircle,\n  faExclamationTriangle,\n  faInfoCircle,\n  faTimes,\n  faTrash,\n  faChartLine,\n  faRedo,\n  faHistory,\n  faChevronLeft,\n  faChevronRight,\n  faUserCircle,\n  faWallet,\n  faExternalLinkAlt,\n  faClipboardCheck,\n  faCog,\n  faCheck,\n  faPlug,\n  faExclamationCircle,\n  faAngleUp,\n  faAngleDoubleUp,\n  faAngleDown,\n  faAngleDoubleDown,\n  faPen,\n  faHandPaper,\n  faHeartbeat,\n  faBars\n} from \"@fortawesome/free-solid-svg-icons\";\nimport { faClipboard, faQuestionCircle } from \"@fortawesome/free-regular-svg-icons\";\nimport { FontAwesomeIcon, FontAwesomeIconProps } from \"@fortawesome/react-fontawesome\";\n\nlibrary.add(\n  faCircleNotch,\n  faCheck,\n  faCheckCircle,\n  faExclamationTriangle,\n  faInfoCircle,\n  faTimes,\n  faTrash,\n  faChartLine,\n  faRedo,\n  faHistory,\n  faChevronLeft,\n  faChevronRight,\n  faClipboard,\n  faClipboardCheck,\n  faUserCircle,\n  faWallet,\n  faExternalLinkAlt,\n  faCog,\n  faPlug,\n  faExclamationCircle,\n  faAngleUp,\n  faAngleDoubleUp,\n  faAngleDown,\n  faAngleDoubleDown,\n  faPen,\n  faHandPaper,\n  faHeartbeat,\n  faBars,\n  faQuestionCircle\n);\n\nconst getIcon = (name: IconName): IconProp => {\n  switch (name) {\n    case \"clipboard\":\n      return [\"far\", \"clipboard\"];\n    case \"question-circle\":\n      return [\"far\", \"question-circle\"];\n    default:\n      return name;\n  }\n};\n\nexport type IconProps = Pick<FontAwesomeIconProps, \"style\" | \"size\" | \"color\" | \"spin\"> & {\n  name: IconName;\n};\n\nexport const Icon: React.FC<IconProps> = ({ name, style, ...rest }) => (\n  <FontAwesomeIcon style={style} icon={getIcon(name)} {...rest} />\n);\n","import React from \"react\";\nimport { Heading, Flex, Card, Button, Box } from \"theme-ui\";\n\nimport { Icon } from \"./Icon\";\n\ntype DialogIntent = \"success\" | \"warning\" | \"danger\" | \"info\";\n\ntype DialogProps = {\n  intent?: DialogIntent;\n  title: string;\n  icon?: React.ReactNode;\n  cancelLabel?: string;\n  onCancel: () => void;\n};\n\nconst iconFromIntent = (intent: DialogIntent | undefined) => {\n  switch (intent) {\n    case \"success\":\n      return <Icon name=\"check-circle\" color=\"success\" aria-label=\"Success\" />;\n    case \"warning\":\n      return <Icon name=\"exclamation-triangle\" color=\"warning\" aria-label=\"Warning\" />;\n    case \"danger\":\n      return <Icon name=\"exclamation-triangle\" color=\"danger\" aria-label=\"Danger\" />;\n    case \"info\":\n      return <Icon name=\"info-circle\" color=\"info\" aria-label=\"Info\" />;\n  }\n  return null;\n};\n\nexport const Dialog: React.FC<DialogProps> = ({\n  intent,\n  title,\n  icon,\n  cancelLabel,\n  onCancel,\n  children\n}) => (\n  <Card sx={{ p: 0, borderRadius: \"4px\" }}>\n    {intent ? <Box sx={{ height: \"4px\", bg: intent, borderRadius: \"3px 3px 0 0\" }} /> : null}\n    <Flex\n      sx={{\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n        borderBottom: 1,\n        borderColor: \"muted\",\n        p: [3, 4],\n        pb: 3\n      }}\n    >\n      {icon || iconFromIntent(intent)}\n      <Heading as=\"h1\" sx={{ textAlign: \"center\", fontSize: [2, 3], px: [3, 0] }}>\n        {title}\n      </Heading>\n      <Button variant=\"icon\" onClick={onCancel}>\n        <Icon name=\"times\" size=\"lg\" aria-label={cancelLabel || \"Cancel\"} />\n      </Button>\n    </Flex>\n    {children}\n  </Card>\n);\n","import React from \"react\";\nimport { Box, Button, Flex } from \"theme-ui\";\n\nimport { Dialog } from \"./Dialog\";\n\ntype RetryDialogProps = {\n  title: string;\n  cancelLabel?: string;\n  retryLabel?: string;\n  onCancel: () => void;\n  onRetry: () => void;\n};\n\nexport const RetryDialog: React.FC<RetryDialogProps> = ({\n  title,\n  cancelLabel,\n  onCancel,\n  retryLabel,\n  onRetry,\n  children\n}) => (\n  <Dialog intent=\"danger\" title={title} cancelLabel={cancelLabel} onCancel={onCancel}>\n    <Box sx={{ p: [3, 4] }}>{children}</Box>\n    <Flex\n      sx={{\n        p: [3, 4],\n        borderTop: 1,\n        borderColor: \"muted\",\n        justifyContent: \"flex-end\",\n        flexDirection: [\"column\", \"row\"],\n        alignItems: \"center\"\n      }}\n    >\n      <Button\n        variant=\"danger\"\n        sx={{\n          mr: [0, 3],\n          mb: [2, 0],\n          width: [\"100%\", \"auto\"]\n        }}\n        onClick={onCancel}\n      >\n        {cancelLabel || \"Cancel\"}\n      </Button>\n      <Button sx={{ width: [\"100%\", \"auto\"] }} onClick={onRetry}>\n        {retryLabel || \"Retry\"}\n      </Button>\n    </Flex>\n  </Dialog>\n);\n","import React from \"react\";\nimport { Box, Flex, Spinner } from \"theme-ui\";\n\nimport { Dialog } from \"./Dialog\";\n\ntype WaitingDialogProps = {\n  title: string;\n  icon?: React.ReactNode;\n  waitReason: React.ReactNode;\n  cancelLabel?: string;\n  onCancel: () => void;\n};\n\nexport const WaitingDialog: React.FC<WaitingDialogProps> = ({\n  title,\n  icon,\n  waitReason,\n  cancelLabel,\n  onCancel,\n  children\n}) => (\n  <Dialog title={title} icon={icon} cancelLabel={cancelLabel} onCancel={onCancel}>\n    {children}\n    <Box sx={{ px: [3, 4], pb: [3, 4] }}>\n      <Flex\n        sx={{\n          flexDirection: [\"column\", \"row\"],\n          bg: \"muted\",\n          p: [3, 4],\n          alignItems: [\"center\", \"auto\"]\n        }}\n      >\n        <Spinner size=\"3em\" sx={{ mr: [0, 3], mb: [2, 0] }} />\n        <Flex sx={{ flexDirection: \"column\", alignItems: [\"center\", \"flex-start\"] }}>\n          {waitReason}\n        </Flex>\n      </Flex>\n    </Box>\n  </Dialog>\n);\n","import React from \"react\";\nimport { Text, Box } from \"theme-ui\";\n\nimport { WaitingDialog } from \"./WaitingDialog\";\n\ntype ConnectionConfirmationDialogProps = {\n  title: string;\n  icon?: React.ReactNode;\n  onCancel: () => void;\n};\n\nexport const ConnectionConfirmationDialog: React.FC<ConnectionConfirmationDialogProps> = ({\n  title,\n  icon,\n  onCancel,\n  children\n}) => (\n  <WaitingDialog\n    title={title}\n    icon={icon}\n    waitReason={\n      <>\n        <Text sx={{ fontWeight: \"bold\" }}>Waiting for connection confirmation...</Text>\n        <Text>This wont cost you any RBTC</Text>\n      </>\n    }\n    cancelLabel=\"Cancel connection\"\n    onCancel={onCancel}\n  >\n    <Box sx={{ p: [3, 4] }}>{children}</Box>\n  </WaitingDialog>\n);\n","import React from \"react\";\n\nexport const MetaMaskIcon: React.FC = () => (\n  <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n    <title>MetaMask extension icon</title>\n    <path\n      d=\"M8.49025 3.49976L1.49216 0.499756L0.492432 3.49976L2.49189 11.9998L21.4867 11.4998L23.4861 3.49976L21.9866 0.499756L15.4883 3.49976H8.49025Z\"\n      fill=\"#763D16\"\n    />\n    <path d=\"M6.99048 11.9998H17.9875V18.9998H6.99048V11.9998Z\" fill=\"#333333\" />\n    <rect x=\"7.99023\" y=\"16.9998\" width=\"5.99836\" height=\"3\" fill=\"#333333\" />\n    <path\n      d=\"M1.58124 10.6642C1.72755 10.8311 1.76935 11.0607 1.70665 11.2485L0.222731 15.8398C0.18093 15.9651 0.18093 16.0903 0.222731 16.1946L1.51854 20.6398C1.62304 20.9738 1.95745 21.1616 2.27095 21.0572L6.7227 19.8259C6.9108 19.7633 7.1198 19.8259 7.287 19.9511L8.06031 20.5772C8.08121 20.5981 8.08121 20.5981 8.10211 20.5981L10.0249 21.9338C10.1294 21.9964 10.2548 22.0381 10.3802 22.0381H13.5989C13.7243 22.0381 13.8497 21.9964 13.9542 21.9338L15.877 20.5981C15.8979 20.5981 15.8979 20.5772 15.9188 20.5772L16.6921 19.9511C16.8384 19.8259 17.0474 19.7842 17.2564 19.8259L21.7081 21.0572C22.0426 21.1407 22.377 20.9529 22.4606 20.6398L23.7564 16.1946C23.7982 16.0694 23.7982 15.9442 23.7564 15.8398L22.2725 11.2485C22.2098 11.0398 22.2516 10.8311 22.3979 10.6642L23.9863 3.54766C24.0072 3.44331 24.0072 3.33897 23.9654 3.23462L23.0249 0.417226C22.9204 0.0833133 22.5442 -0.0836433 22.2098 0.0415742L15.2709 2.6294C15.2082 2.65027 15.1246 2.67114 15.0619 2.67114H8.91722C8.83362 2.67114 8.77092 2.65027 8.70822 2.6294L1.76935 0.0415742C1.43494 -0.0836433 1.05874 0.0833133 0.954238 0.417226L0.0346286 3.23462C-0.00717182 3.3181 -0.00717182 3.44331 0.0137284 3.54766L1.58124 10.6642ZM13.996 14.2537L14.5185 13.1685C14.5812 13.0433 14.7484 12.9807 14.8738 13.0433L16.1278 13.6068C16.3577 13.7111 16.3368 14.0451 16.086 14.1285L14.3304 14.6503C14.1005 14.7129 13.8915 14.4833 13.996 14.2537ZM13.8915 6.71984C13.7661 6.61549 13.7661 6.40679 13.9124 6.32331L21.8126 0.918096C21.9381 0.834618 22.1262 0.876357 22.1889 1.04331L23.1712 3.73549C23.1921 3.77723 23.1921 3.81897 23.1712 3.88157L21.5618 10.0798C21.52 10.2051 21.3946 10.2677 21.2692 10.2259L16.922 9.05723C16.8802 9.05723 16.8593 9.03636 16.8384 9.01549L13.8915 6.71984ZM10.0667 19.5338L10.213 18.3233C10.213 18.2607 10.2548 18.1981 10.3175 18.1564L10.6101 17.9477C10.6519 17.9268 10.6937 17.9059 10.7355 17.9059H13.2018C13.2436 17.9059 13.3063 17.9268 13.3272 17.9477L13.6198 18.1564C13.6825 18.1981 13.7034 18.2607 13.7243 18.3233L13.8497 19.5338C13.8706 19.6798 13.7452 19.8051 13.6198 19.8051H10.2757C10.1712 19.8051 10.0667 19.6798 10.0667 19.5338ZM7.85131 13.6068L9.10532 13.0433C9.25162 12.9807 9.39792 13.0433 9.46062 13.1685L9.98313 14.2537C10.0876 14.4624 9.87863 14.692 9.64873 14.6294L7.87221 14.1077C7.64231 14.0451 7.62141 13.7111 7.85131 13.6068ZM0.807936 3.86071C0.787036 3.81897 0.807936 3.75636 0.807936 3.71462L1.79025 1.04331C1.85295 0.897226 2.04105 0.834618 2.16645 0.918096L10.0667 6.32331C10.213 6.42766 10.213 6.61549 10.0876 6.71984L7.1407 9.01549C7.1198 9.03636 7.078 9.05723 7.0571 9.05723L2.70986 10.2259C2.58445 10.2677 2.45905 10.2051 2.41725 10.0798L0.807936 3.86071Z\"\n      fill=\"#F36D34\"\n    />\n  </svg>\n);\n","import React from \"react\";\nimport { Container } from \"theme-ui\";\n\nexport const Modal: React.FC = ({ children }) => (\n  <Container variant=\"modalOverlay\">\n    <Container variant=\"modal\">{children}</Container>\n  </Container>\n);\n","import React, { useEffect, useReducer } from \"react\";\nimport { useWeb3React } from \"@web3-react/core\";\nimport { AbstractConnector } from \"@web3-react/abstract-connector\";\nimport { Button, Text, Flex, Link, Box } from \"theme-ui\";\n\nimport { injectedConnector } from \"../connectors/injectedConnector\";\nimport { useAuthorizedConnection } from \"../hooks/useAuthorizedConnection\";\n\nimport { RetryDialog } from \"./RetryDialog\";\nimport { ConnectionConfirmationDialog } from \"./ConnectionConfirmationDialog\";\nimport { MetaMaskIcon } from \"./MetaMaskIcon\";\nimport { Icon } from \"./Icon\";\nimport { Modal } from \"./Modal\";\n\ninterface MaybeHasMetaMask {\n  ethereum?: {\n    isMetaMask?: boolean;\n  };\n}\n\ntype ConnectionState =\n  | { type: \"inactive\" }\n  | {\n      type: \"activating\" | \"active\" | \"rejectedByUser\" | \"alreadyPending\" | \"failed\";\n      connector: AbstractConnector;\n    };\n\ntype ConnectionAction =\n  | { type: \"startActivating\"; connector: AbstractConnector }\n  | { type: \"fail\"; error: Error }\n  | { type: \"finishActivating\" | \"retry\" | \"cancel\" | \"deactivate\" };\n\nconst connectionReducer: React.Reducer<ConnectionState, ConnectionAction> = (state, action) => {\n  switch (action.type) {\n    case \"startActivating\":\n      return {\n        type: \"activating\",\n        connector: action.connector\n      };\n    case \"finishActivating\":\n      return {\n        type: \"active\",\n        connector: state.type === \"inactive\" ? injectedConnector : state.connector\n      };\n    case \"fail\":\n      if (state.type !== \"inactive\") {\n        return {\n          type: action.error.message.match(/user rejected/i)\n            ? \"rejectedByUser\"\n            : action.error.message.match(/already pending/i)\n            ? \"alreadyPending\"\n            : \"failed\",\n          connector: state.connector\n        };\n      }\n      break;\n    case \"retry\":\n      if (state.type !== \"inactive\") {\n        return {\n          type: \"activating\",\n          connector: state.connector\n        };\n      }\n      break;\n    case \"cancel\":\n      return {\n        type: \"inactive\"\n      };\n    case \"deactivate\":\n      return {\n        type: \"inactive\"\n      };\n  }\n\n  console.warn(\"Ignoring connectionReducer action:\");\n  console.log(action);\n  console.log(\"  in state:\");\n  console.log(state);\n\n  return state;\n};\n\nconst detectMetaMask = () => (window as MaybeHasMetaMask).ethereum?.isMetaMask ?? false;\n\ntype WalletConnectorProps = {\n  loader?: React.ReactNode;\n};\n\nexport const WalletConnector: React.FC<WalletConnectorProps> = ({ children, loader }) => {\n  const { activate, deactivate, active, error } = useWeb3React<unknown>();\n  const triedAuthorizedConnection = useAuthorizedConnection();\n  const [connectionState, dispatch] = useReducer(connectionReducer, { type: \"inactive\" });\n  const isMetaMask = detectMetaMask();\n\n  useEffect(() => {\n    if (error) {\n      dispatch({ type: \"fail\", error });\n      deactivate();\n    }\n  }, [error, deactivate]);\n\n  useEffect(() => {\n    if (active) {\n      dispatch({ type: \"finishActivating\" });\n    } else {\n      dispatch({ type: \"deactivate\" });\n    }\n  }, [active]);\n\n  if (!triedAuthorizedConnection) {\n    return <>{loader}</>;\n  }\n\n  if (connectionState.type === \"active\") {\n    return <>{children}</>;\n  }\n\n  return (\n    <>\n      <Flex sx={{ height: \"100vh\", justifyContent: \"center\", alignItems: \"center\" }}>\n        <Button\n          onClick={() => {\n            dispatch({ type: \"startActivating\", connector: injectedConnector });\n            activate(injectedConnector);\n          }}\n        >\n          {isMetaMask ? (\n            <>\n              <MetaMaskIcon />\n              <Box sx={{ ml: 2 }}>Connect to MetaMask</Box>\n            </>\n          ) : (\n            <>\n              <Icon name=\"plug\" size=\"lg\" />\n              <Box sx={{ ml: 2 }}>Connect wallet</Box>\n            </>\n          )}\n        </Button>\n      </Flex>\n\n      {connectionState.type === \"failed\" && (\n        <Modal>\n          <RetryDialog\n            title={isMetaMask ? \"Failed to connect to MetaMask\" : \"Failed to connect wallet\"}\n            onCancel={() => dispatch({ type: \"cancel\" })}\n            onRetry={() => {\n              dispatch({ type: \"retry\" });\n              activate(connectionState.connector);\n            }}\n          >\n            <Box sx={{ textAlign: \"center\" }}>\n              You might need to install MetaMask or use a different browser.\n            </Box>\n            <Link sx={{ lineHeight: 3 }} href=\"https://metamask.io/download.html\" target=\"_blank\">\n              Learn more <Icon size=\"xs\" name=\"external-link-alt\" />\n            </Link>\n          </RetryDialog>\n        </Modal>\n      )}\n\n      {connectionState.type === \"activating\" && (\n        <Modal>\n          <ConnectionConfirmationDialog\n            title={\n              isMetaMask ? \"Confirm connection in MetaMask\" : \"Confirm connection in your wallet\"\n            }\n            icon={isMetaMask ? <MetaMaskIcon /> : <Icon name=\"wallet\" size=\"lg\" />}\n            onCancel={() => dispatch({ type: \"cancel\" })}\n          >\n            <Text sx={{ textAlign: \"center\" }}>\n              Confirm the request that&apos;s just appeared.\n              {isMetaMask ? (\n                <> If you can&apos;t see a request, open your MetaMask extension via your browser.</>\n              ) : (\n                <> If you can&apos;t see a request, you might have to open your wallet.</>\n              )}\n            </Text>\n          </ConnectionConfirmationDialog>\n        </Modal>\n      )}\n\n      {connectionState.type === \"rejectedByUser\" && (\n        <Modal>\n          <RetryDialog\n            title=\"Cancel connection?\"\n            onCancel={() => dispatch({ type: \"cancel\" })}\n            onRetry={() => {\n              dispatch({ type: \"retry\" });\n              activate(connectionState.connector);\n            }}\n          >\n            <Text>To use Zero, you need to connect your RSK account.</Text>\n          </RetryDialog>\n        </Modal>\n      )}\n\n      {connectionState.type === \"alreadyPending\" && (\n        <Modal>\n          <RetryDialog\n            title=\"Connection already requested\"\n            onCancel={() => dispatch({ type: \"cancel\" })}\n            onRetry={() => {\n              dispatch({ type: \"retry\" });\n              activate(connectionState.connector);\n            }}\n          >\n            <Text>Please check your wallet and accept the connection request before retrying.</Text>\n          </RetryDialog>\n        </Modal>\n      )}\n    </>\n  );\n};\n","import { useState, useEffect } from \"react\";\nimport { useWeb3React } from \"@web3-react/core\";\n\nimport { injectedConnector } from \"../connectors/injectedConnector\";\n\n/**\n * React hook that tries to activate the InjectedConnector if the app's already authorized in the\n * browser's wallet (in the case of dApp-enabled browsers) or its wallet extension (e.g. MetaMask).\n *\n * Example: user has a browser with the MetaMask extension. MetaMask injects an Ethereum provider\n * into the window object. We check via InjectedConnector if our app is already authorized to use\n * the wallet through this provider, and in that case we try to activate the connector.\n *\n * @returns true when finished trying to activate the InjectedConnector, false otherwise\n */\n\nexport function useAuthorizedConnection(): boolean {\n  const { activate, active } = useWeb3React<unknown>();\n  const [tried, setTried] = useState(false);\n\n  useEffect(() => {\n    const tryToActivateIfAuthorized = async () => {\n      try {\n        if (await injectedConnector.isAuthorized()) {\n          await activate(injectedConnector, undefined, true);\n        } else {\n          throw new Error(\"Unauthorized\");\n        }\n      } catch {\n        setTried(true);\n      }\n    };\n    tryToActivateIfAuthorized();\n  }, [activate]);\n\n  useEffect(() => {\n    if (active) {\n      setTried(true);\n    }\n  }, [active]);\n\n  return tried;\n}\n","import React, { useState, useRef } from \"react\";\nimport { VirtualElement } from \"@popperjs/core\";\nimport { usePopper } from \"react-popper\";\nimport { Card } from \"theme-ui\";\n\nexport type Hoverable = {\n  onMouseOver: () => void;\n  onMouseOut: () => void;\n  ref: (instance: Element | VirtualElement | null) => void;\n};\n\nexport type TooltipProps<C> = {\n  children: C;\n  message: string;\n  placement?: \"top\" | \"bottom\" | \"left\" | \"right\";\n};\n\nexport function Tooltip<C extends React.ReactElement<Hoverable>>({\n  children,\n  message,\n  placement = \"top\"\n}: TooltipProps<C>) {\n  const event = useRef<\"over\" | \"out\">();\n  const [show, setShow] = useState(false);\n  const [referenceElement, setReferenceElement] = useState<Element | VirtualElement | null>();\n  const [popperElement, setPopperElement] = useState<HTMLElement | null>();\n\n  const { styles, attributes } = usePopper(referenceElement, popperElement, { placement });\n\n  return (\n    <>\n      {React.cloneElement(React.Children.only<C>(children), {\n        // Use a debounced onMouseOver/onMouseOut instead of onMouseEnter/onMouseLeave to\n        // work around https://github.com/facebook/react/issues/10109\n\n        onMouseOver: () => {\n          event.current = \"over\";\n\n          if (!show) {\n            setShow(true);\n          }\n        },\n\n        onMouseOut: () => {\n          event.current = \"out\";\n\n          setTimeout(() => {\n            if (event.current === \"out\") {\n              setShow(false);\n            }\n          }, 0);\n        },\n\n        ref: setReferenceElement\n      })}\n\n      {show && (\n        <Card variant=\"tooltip\" ref={setPopperElement} style={styles.popper} {...attributes.popper}>\n          {message}\n        </Card>\n      )}\n    </>\n  );\n}\n","import React, { useState, useContext, useEffect, useCallback } from \"react\";\nimport { Flex, Text, Box } from \"theme-ui\";\nimport { Provider, TransactionResponse, TransactionReceipt } from \"@ethersproject/abstract-provider\";\nimport { hexDataSlice, hexDataLength } from \"@ethersproject/bytes\";\nimport { defaultAbiCoder } from \"@ethersproject/abi\";\n\nimport { buildStyles, CircularProgressbarWithChildren } from \"react-circular-progressbar\";\nimport \"react-circular-progressbar/dist/styles.css\";\n\nimport { EthersTransactionOverrides } from \"@liquity/lib-ethers\";\nimport { SentLiquityTransaction, LiquityReceipt } from \"@liquity/lib-base\";\n\nimport { useLiquity } from \"../hooks/LiquityContext\";\n\nimport { Icon } from \"./Icon\";\nimport { Tooltip, TooltipProps, Hoverable } from \"./Tooltip\";\n\nconst strokeWidth = 10;\n\nconst circularProgressbarStyle = {\n  strokeLinecap: \"butt\",\n  pathColor: \"white\",\n  trailColor: \"rgba(255, 255, 255, 0.33)\"\n};\n\nconst slowProgress = {\n  strokeWidth,\n  styles: buildStyles({\n    ...circularProgressbarStyle,\n    pathTransitionDuration: 30\n  })\n};\n\nconst fastProgress = {\n  strokeWidth,\n  styles: buildStyles({\n    ...circularProgressbarStyle,\n    pathTransitionDuration: 0.75\n  })\n};\n\ntype TransactionIdle = {\n  type: \"idle\";\n};\n\ntype TransactionFailed = {\n  type: \"failed\";\n  id: string;\n  error: Error;\n};\n\ntype TransactionWaitingForApproval = {\n  type: \"waitingForApproval\";\n  id: string;\n};\n\ntype TransactionCancelled = {\n  type: \"cancelled\";\n  id: string;\n};\n\ntype TransactionWaitingForConfirmations = {\n  type: \"waitingForConfirmation\";\n  id: string;\n  tx: SentTransaction;\n};\n\ntype TransactionConfirmed = {\n  type: \"confirmed\";\n  id: string;\n};\n\ntype TransactionConfirmedOneShot = {\n  type: \"confirmedOneShot\";\n  id: string;\n};\n\ntype TransactionState =\n  | TransactionIdle\n  | TransactionFailed\n  | TransactionWaitingForApproval\n  | TransactionCancelled\n  | TransactionWaitingForConfirmations\n  | TransactionConfirmed\n  | TransactionConfirmedOneShot;\n\nconst TransactionContext = React.createContext<\n  [TransactionState, (state: TransactionState) => void] | undefined\n>(undefined);\n\nexport const TransactionProvider: React.FC = ({ children }) => {\n  const transactionState = useState<TransactionState>({ type: \"idle\" });\n  return (\n    <TransactionContext.Provider value={transactionState}>{children}</TransactionContext.Provider>\n  );\n};\n\nconst useTransactionState = () => {\n  const transactionState = useContext(TransactionContext);\n\n  if (!transactionState) {\n    throw new Error(\"You must provide a TransactionContext via TransactionProvider\");\n  }\n\n  return transactionState;\n};\n\nexport const useMyTransactionState = (myId: string | RegExp): TransactionState => {\n  const [transactionState] = useTransactionState();\n\n  return transactionState.type !== \"idle\" &&\n    (typeof myId === \"string\" ? transactionState.id === myId : transactionState.id.match(myId))\n    ? transactionState\n    : { type: \"idle\" };\n};\n\nconst hasMessage = (error: unknown): error is { message: string } =>\n  typeof error === \"object\" &&\n  error !== null &&\n  \"message\" in error &&\n  typeof (error as { message: unknown }).message === \"string\";\n\ntype ButtonlikeProps = {\n  disabled?: boolean;\n  variant?: string;\n  onClick?: () => void;\n};\n\ntype SentTransaction = SentLiquityTransaction<\n  TransactionResponse,\n  LiquityReceipt<TransactionReceipt>\n>;\n\nexport type TransactionFunction = (\n  overrides?: EthersTransactionOverrides\n) => Promise<SentTransaction>;\n\ntype TransactionProps<C> = {\n  id: string;\n  tooltip?: string;\n  tooltipPlacement?: TooltipProps<C>[\"placement\"];\n  showFailure?: \"asTooltip\" | \"asChildText\";\n  requires?: readonly (readonly [boolean, string])[];\n  send: TransactionFunction;\n  children: C;\n};\n\nexport const useTransactionFunction = (\n  id: string,\n  send: TransactionFunction\n): [sendTransaction: () => Promise<void>, transactionState: TransactionState] => {\n  const [transactionState, setTransactionState] = useTransactionState();\n\n  const sendTransaction = useCallback(async () => {\n    setTransactionState({ type: \"waitingForApproval\", id });\n\n    try {\n      const tx = await send();\n\n      setTransactionState({\n        type: \"waitingForConfirmation\",\n        id,\n        tx\n      });\n    } catch (error) {\n      if (hasMessage(error) && error.message.includes(\"User denied transaction signature\")) {\n        setTransactionState({ type: \"cancelled\", id });\n      } else {\n        console.error(error);\n\n        setTransactionState({\n          type: \"failed\",\n          id,\n          error: new Error(\"Failed to send transaction (try again)\")\n        });\n      }\n    }\n  }, [send, id, setTransactionState]);\n\n  return [sendTransaction, transactionState];\n};\n\nexport function Transaction<C extends React.ReactElement<ButtonlikeProps & Hoverable>>({\n  id,\n  tooltip,\n  tooltipPlacement,\n  showFailure,\n  requires,\n  send,\n  children\n}: TransactionProps<C>) {\n  const [sendTransaction, transactionState] = useTransactionFunction(id, send);\n  const trigger = React.Children.only<C>(children);\n\n  const failureReasons = (requires || [])\n    .filter(([requirement]) => !requirement)\n    .map(([, reason]) => reason);\n\n  if (\n    transactionState.type === \"waitingForApproval\" ||\n    transactionState.type === \"waitingForConfirmation\"\n  ) {\n    failureReasons.push(\"You must wait for confirmation\");\n  }\n\n  showFailure =\n    failureReasons.length > 0 ? showFailure ?? (tooltip ? \"asTooltip\" : \"asChildText\") : undefined;\n\n  const clonedTrigger =\n    showFailure === \"asChildText\"\n      ? React.cloneElement(\n          trigger,\n          {\n            disabled: true,\n            variant: \"danger\"\n          },\n          failureReasons[0]\n        )\n      : showFailure === \"asTooltip\"\n      ? React.cloneElement(trigger, { disabled: true })\n      : React.cloneElement(trigger, { onClick: sendTransaction });\n\n  if (showFailure === \"asTooltip\") {\n    tooltip = failureReasons[0];\n  }\n\n  return tooltip ? (\n    <>\n      <Tooltip message={tooltip} placement={tooltipPlacement || \"right\"}>\n        {clonedTrigger}\n      </Tooltip>\n    </>\n  ) : (\n    clonedTrigger\n  );\n}\n\n// Doesn't work on Kovan:\n// https://github.com/MetaMask/metamask-extension/issues/5579\nconst tryToGetRevertReason = async (provider: Provider, hash: string) => {\n  try {\n    const tx = await provider.getTransaction(hash);\n    const result = await provider.call(tx, tx.blockNumber);\n\n    if (hexDataLength(result) % 32 === 4 && hexDataSlice(result, 0, 4) === \"0x08c379a0\") {\n      return (defaultAbiCoder.decode([\"string\"], hexDataSlice(result, 4)) as [string])[0];\n    }\n  } catch {\n    return undefined;\n  }\n};\n\nconst Donut = React.memo(\n  CircularProgressbarWithChildren,\n  ({ value: prev }, { value: next }) => prev === next\n);\n\ntype TransactionProgressDonutProps = {\n  state: TransactionState[\"type\"];\n};\n\nconst TransactionProgressDonut: React.FC<TransactionProgressDonutProps> = ({ state }) => {\n  const [value, setValue] = useState(0);\n  const maxValue = 1;\n\n  useEffect(() => {\n    if (state === \"confirmed\") {\n      setTimeout(() => setValue(maxValue), 40);\n    } else {\n      setTimeout(() => setValue(maxValue * 0.67), 20);\n    }\n  }, [state]);\n\n  return state === \"confirmed\" ? (\n    <Donut {...{ value, maxValue, ...fastProgress }}>\n      <Icon name=\"check\" color=\"white\" size=\"lg\" />\n    </Donut>\n  ) : state === \"failed\" || state === \"cancelled\" ? (\n    <Donut value={0} {...{ maxValue, ...fastProgress }}>\n      <Icon name=\"times\" color=\"white\" size=\"lg\" />\n    </Donut>\n  ) : (\n    <Donut {...{ value, maxValue, ...slowProgress }}>\n      <Icon name=\"cog\" color=\"white\" size=\"lg\" spin />\n    </Donut>\n  );\n};\n\nexport const TransactionMonitor: React.FC = () => {\n  const { provider } = useLiquity();\n  const [transactionState, setTransactionState] = useTransactionState();\n\n  const id = transactionState.type !== \"idle\" ? transactionState.id : undefined;\n  const tx = transactionState.type === \"waitingForConfirmation\" ? transactionState.tx : undefined;\n\n  useEffect(() => {\n    if (id && tx) {\n      let cancelled = false;\n      let finished = false;\n\n      const txHash = tx.rawSentTransaction.hash;\n\n      const waitForConfirmation = async () => {\n        try {\n          const receipt = await tx.waitForReceipt();\n\n          if (cancelled) {\n            return;\n          }\n\n          const { confirmations } = receipt.rawReceipt;\n          const blockNumber = receipt.rawReceipt.blockNumber + confirmations - 1;\n          console.log(`Block #${blockNumber} ${confirmations}-confirms tx ${txHash}`);\n          console.log(`Finish monitoring tx ${txHash}`);\n          finished = true;\n\n          if (receipt.status === \"succeeded\") {\n            console.log(`${receipt}`);\n\n            setTransactionState({\n              type: \"confirmedOneShot\",\n              id\n            });\n          } else {\n            const reason = await tryToGetRevertReason(provider, txHash);\n\n            if (cancelled) {\n              return;\n            }\n\n            console.error(`Tx ${txHash} failed`);\n            if (reason) {\n              console.error(`Revert reason: ${reason}`);\n            }\n\n            setTransactionState({\n              type: \"failed\",\n              id,\n              error: new Error(reason ? `Reverted: ${reason}` : \"Failed\")\n            });\n          }\n        } catch (rawError) {\n          if (cancelled) {\n            return;\n          }\n\n          console.error(`Failed to get receipt for tx ${txHash}`);\n          console.error(rawError);\n\n          setTransactionState({\n            type: \"failed\",\n            id,\n            error: new Error(\"Failed\")\n          });\n        }\n      };\n\n      console.log(`Start monitoring tx ${txHash}`);\n      waitForConfirmation();\n\n      return () => {\n        if (!finished) {\n          setTransactionState({ type: \"idle\" });\n          console.log(`Cancel monitoring tx ${txHash}`);\n          cancelled = true;\n        }\n      };\n    }\n  }, [provider, id, tx, setTransactionState]);\n\n  useEffect(() => {\n    if (transactionState.type === \"confirmedOneShot\" && id) {\n      // hack: the txn confirmed state lasts 5 seconds which blocks other states, review with Dani\n      setTransactionState({ type: \"confirmed\", id });\n    } else if (\n      transactionState.type === \"confirmed\" ||\n      transactionState.type === \"failed\" ||\n      transactionState.type === \"cancelled\"\n    ) {\n      let cancelled = false;\n\n      setTimeout(() => {\n        if (!cancelled) {\n          setTransactionState({ type: \"idle\" });\n        }\n      }, 5000);\n\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [transactionState.type, setTransactionState, id]);\n\n  if (transactionState.type === \"idle\" || transactionState.type === \"waitingForApproval\") {\n    return null;\n  }\n\n  return (\n    <Flex\n      sx={{\n        alignItems: \"center\",\n        bg:\n          transactionState.type === \"confirmed\"\n            ? \"success\"\n            : transactionState.type === \"cancelled\"\n            ? \"warning\"\n            : transactionState.type === \"failed\"\n            ? \"danger\"\n            : \"primary\",\n        p: 3,\n        pl: 4,\n        position: \"fixed\",\n        width: \"100vw\",\n        bottom: 0,\n        overflow: \"hidden\"\n      }}\n    >\n      <Box sx={{ mr: 3, width: \"40px\", height: \"40px\" }}>\n        <TransactionProgressDonut state={transactionState.type} />\n      </Box>\n\n      <Text sx={{ fontSize: 3, color: \"white\" }}>\n        {transactionState.type === \"waitingForConfirmation\"\n          ? \"Waiting for confirmation\"\n          : transactionState.type === \"cancelled\"\n          ? \"Cancelled\"\n          : transactionState.type === \"failed\"\n          ? transactionState.error.message\n          : \"Confirmed\"}\n      </Text>\n    </Flex>\n  );\n};\n","import { Theme, ThemeUIStyleObject } from \"theme-ui\";\n\nconst baseColors = {\n  blue: \"#4fbfd4\",\n  yellow: \"rgb(254, 192, 4)\",\n  red: \"#dc2c10\",\n  lightRed: \"#ff755f\",\n  orange: \"rgb(254, 192, 4)\",\n  black: 'black'\n};\n\nconst colors = {\n  primary: baseColors.orange,\n  secondary: baseColors.blue,\n  accent: baseColors.orange,\n  success: baseColors.blue,\n  warning: baseColors.yellow,\n  danger: baseColors.red,\n  dangerHover: baseColors.lightRed,\n  info: baseColors.blue,\n  invalid: \"pink\",\n  text: \"#E8E8E8\",\n  background: \"#181C1F\",\n  cardBackground: baseColors.black,\n  muted: \"#eaebed\",\n  bonded: \"#5C5C5C\",\n  highlight: \"#5C5C5C\"\n};\n\nconst buttonBase: ThemeUIStyleObject = {\n  display: \"flex\",\n  alignItems: \"center\",\n  justifyContent: \"center\",\n\n  \":enabled\": { cursor: \"pointer\" }\n};\n\nconst button: ThemeUIStyleObject = {\n  ...buttonBase,\n\n  px: \"32px\",\n  py: \"12px\",\n\n  color: \"black\",\n  border: 2,\n  borderColor: \"white\",\n\n  fontWeight: \"bold\",\n\n  \":disabled\": {\n    opacity: 0.5\n  }\n};\n\nconst buttonOutline = (color: string, hoverColor: string): ThemeUIStyleObject => ({\n  color,\n  borderColor: color,\n  background: \"none\",\n\n  \":enabled:hover\": {\n    color: hoverColor,\n    borderColor: hoverColor\n  }\n});\n\nconst iconButton: ThemeUIStyleObject = {\n  ...buttonBase,\n\n  padding: 0,\n  width: \"40px\",\n  height: \"40px\",\n\n  background: \"none\",\n\n  \":disabled\": {\n    color: \"text\",\n    opacity: 0.25\n  }\n};\n\nconst cardHeadingFontSize = 18.7167;\n\nconst cardGapX = [0, 3, 4];\nconst cardGapY = [3, 3, 4];\n\nconst card: ThemeUIStyleObject = {\n  position: \"relative\",\n  mt: cardGapY,\n  boxShadow: [1, null, 2],\n  borderRadius: 13\n};\n\nconst infoCard: ThemeUIStyleObject = {\n  ...card,\n\n  padding: 3,\n  borderColor: \"rgba(122,199,240,0.4)\",\n  background: `linear-gradient(200deg, #26899b, #030c0d)`,\n\n  h2: {\n    mb: 2,\n    fontSize: cardHeadingFontSize\n  }\n};\n\nconst formBase: ThemeUIStyleObject = {\n  display: \"block\",\n  width: \"auto\",\n  flexShrink: 0,\n  padding: 2,\n  fontSize: 3\n};\n\nconst formCell: ThemeUIStyleObject = {\n  ...formBase,\n\n  bg: \"background\",\n  border: 1,\n  borderColor: \"muted\",\n  borderRadius: 0,\n  boxShadow: [1, 2]\n};\n\nconst overlay: ThemeUIStyleObject = {\n  position: \"absolute\",\n\n  left: 0,\n  top: 0,\n  width: \"100%\",\n  height: \"100%\"\n};\n\nconst modalOverlay: ThemeUIStyleObject = {\n  position: \"fixed\",\n\n  left: 0,\n  top: 0,\n  width: \"100vw\",\n  height: \"100vh\"\n};\n\nconst headerGradient: ThemeUIStyleObject = {\n  background: colors.cardBackground\n};\n\nconst theme: Theme = {\n  breakpoints: [\"48em\", \"52em\", \"64em\"],\n\n  space: [0, 4, 8, 16, 32, 64, 128, 256, 512],\n\n  fonts: {\n    body: [\n      \"system-ui\",\n      \"-apple-system\",\n      \"BlinkMacSystemFont\",\n      '\"Segoe UI\"',\n      \"Roboto\",\n      '\"Helvetica Neue\"',\n      \"sans-serif\"\n    ].join(\", \"),\n    heading: \"inherit\",\n    monospace: \"Menlo, monospace\"\n  },\n\n  fontSizes: [12, 14, 16, 20, 24, 32, 48, 64, 96],\n\n  fontWeights: {\n    body: 400,\n    heading: 600,\n\n    light: 200,\n    medium: 500,\n    bold: 600\n  },\n\n  lineHeights: {\n    body: 1.5,\n    heading: 1.25\n  },\n\n  colors,\n\n  borders: [0, \"1px solid\", \"2px solid\"],\n\n  shadows: [\"0\", \"0px 4px 8px rgba(41, 49, 71, 0.1)\", \"0px 8px 16px rgba(41, 49, 71, 0.1)\"],\n\n  text: {\n    address: {\n      fontFamily: \"monospace\",\n      fontSize: 1\n    }\n  },\n\n  buttons: {\n    primary: {\n      ...button,\n\n      bg: \"primary\",\n      borderColor: \"primary\",\n\n      \":enabled:hover\": {\n        bg: \"secondary\",\n        borderColor: \"muted\",\n      }\n    },\n\n    outline: {\n      ...button,\n      ...buttonOutline(\"primary\", \"secondary\")\n    },\n\n    cancel: {\n      ...button,\n      ...buttonOutline(\"text\", \"secondary\"),\n\n      opacity: 0.8\n    },\n\n    danger: {\n      ...button,\n\n      bg: \"danger\",\n      borderColor: \"danger\",\n\n      \":enabled:hover\": {\n        bg: \"dangerHover\",\n        borderColor: \"dangerHover\"\n      }\n    },\n\n    icon: {\n      ...iconButton,\n      color: \"primary\",\n      \":enabled:hover\": { color: \"accent\" }\n    },\n\n    dangerIcon: {\n      ...iconButton,\n      color: \"danger\",\n      \":enabled:hover\": { color: \"dangerHover\" }\n    },\n\n    titleIcon: {\n      ...iconButton,\n      color: \"text\",\n      \":enabled:hover\": { color: \"success\" }\n    }\n  },\n\n  cards: {\n    primary: {\n      ...card,\n\n      padding: 0,\n      bg: colors.cardBackground,\n\n      \"> h2\": {\n        display: \"flex\",\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n\n        borderRadius: 13,\n        height: \"56px\",\n\n        pl: 3,\n        py: 2,\n        pr: 2,\n\n        bg: colors.cardBackground,\n\n        fontSize: cardHeadingFontSize\n      }\n    },\n\n    info: {\n      ...infoCard,\n\n      display: [\"none\", \"block\"]\n    },\n\n    infoPopup: {\n      ...infoCard,\n\n      position: \"fixed\",\n      top: 0,\n      right: 3,\n      left: 3,\n      mt: \"72px\",\n      height: \"80%\",\n      overflowY: \"scroll\"\n    },\n\n    tooltip: {\n      padding: 2,\n\n      border: 1,\n      borderColor: \"muted\",\n      borderRadius: \"4px\",\n      bg: \"background\",\n      boxShadow: 2,\n\n      fontSize: 1,\n      color: \"text\",\n      fontWeight: \"body\",\n      zIndex: 1\n    }\n  },\n\n  forms: {\n    label: {\n      ...formBase\n    },\n\n    unit: {\n      ...formCell,\n\n      textAlign: \"center\",\n      bg: \"muted\"\n    },\n\n    input: {\n      ...formCell,\n\n      flex: 1\n    },\n\n    editor: {}\n  },\n\n  layout: {\n    header: {\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      alignItems: \"stretch\",\n\n      position: [\"fixed\", \"relative\"],\n      width: \"100vw\",\n      top: 0,\n      zIndex: 1,\n\n      px: [2, \"12px\", \"12px\", 5],\n      py: [2, \"12px\", \"12px\"],\n\n      ...headerGradient,\n      boxShadow: [1, \"none\"]\n    },\n\n    footer: {\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n\n      mt: cardGapY,\n      px: 3,\n      minHeight: \"72px\",\n\n      bg: \"muted\"\n    },\n\n    main: {\n      width: \"100%\",\n      maxWidth: \"912px\",\n      mx: \"auto\",\n      mt: [\"40px\", 0],\n      mb: [\"40px\", \"40px\"],\n      px: cardGapX\n    },\n\n    columns: {\n      display: \"flex\",\n      flexWrap: \"wrap\",\n      justifyItems: \"center\"\n    },\n\n    left: {\n      pr: cardGapX,\n      width: [\"100%\", \"58%\"]\n    },\n\n    right: {\n      width: [\"100%\", \"42%\"]\n    },\n\n    actions: {\n      justifyContent: \"flex-end\",\n      mt: 2,\n\n      button: {\n        ml: 2\n      }\n    },\n\n    disabledOverlay: {\n      ...overlay,\n\n      bg: \"rgba(255, 255, 255, 0.5)\"\n    },\n\n    modalOverlay: {\n      ...modalOverlay,\n\n      bg: \"rgba(0, 0, 0, 0.8)\",\n\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\"\n    },\n\n    modal: {\n      padding: 3,\n      width: [\"100%\", \"40em\"]\n    },\n\n    infoOverlay: {\n      ...modalOverlay,\n\n      display: [\"block\", \"none\"],\n\n      bg: \"rgba(255, 255, 255, 0.8)\"\n    },\n\n    infoMessage: {\n      display: \"flex\",\n      justifyContent: \"center\",\n      m: 3,\n      alignItems: \"center\",\n      minWidth: \"128px\"\n    },\n\n    sidenav: {\n      display: [\"flex\", \"none\"],\n      flexDirection: \"column\",\n      p: 0,\n      m: 0,\n      borderColor: \"muted\",\n      mr: \"25vw\",\n      height: \"100%\",\n      ...headerGradient\n    },\n\n    badge: {\n      border: 0,\n      borderRadius: 3,\n      p: 1,\n      px: 2,\n      backgroundColor: \"muted\",\n      color: \"slate\",\n      fontSize: 1,\n      fontWeight: \"body\"\n    }\n  },\n\n  styles: {\n    root: {\n      fontFamily: \"body\",\n      lineHeight: \"body\",\n      fontWeight: \"body\",\n\n      height: \"100%\",\n\n      \"#root\": {\n        height: \"100%\"\n      }\n    },\n\n    a: {\n      color: \"primary\",\n      \":hover\": { color: \"accent\" },\n      textDecoration: \"none\",\n      fontWeight: \"bold\"\n    }\n  },\n\n  links: {\n    nav: {\n      px: 2,\n      py: 1,\n      fontWeight: \"medium\",\n      fontSize: 2,\n      textTransform: \"uppercase\",\n      letterSpacing: \"2px\",\n      width: [\"100%\", \"auto\"],\n      mt: [3, \"auto\"]\n    }\n  }\n};\n\nexport default theme;\n","import { hexlify } from \"@ethersproject/bytes\";\nimport { Wallet } from \"@ethersproject/wallet\";\n\nimport { Decimal, Decimalish } from \"@liquity/lib-base\";\n\nexport class DisposableWalletProvider {\n  private readonly url: string;\n  private id: number = 0;\n\n  private readonly wallet: Wallet;\n  private readonly funderWallet: Wallet;\n\n  private readonly ethAmount: Decimal;\n  private haveFunded = false;\n\n  constructor(url: string, funderPrivateKey: string, ethAmount: Decimalish = 100) {\n    this.url = url;\n    this.wallet = Wallet.createRandom();\n    this.funderWallet = new Wallet(funderPrivateKey);\n    this.ethAmount = Decimal.from(ethAmount);\n  }\n\n  private findWallet(address: string) {\n    const wallet = [this.wallet, this.funderWallet].find(\n      wallet => wallet.address.toLowerCase() === address.toLowerCase()\n    );\n\n    if (!wallet) {\n      throw new Error(`Unknow account ${address}`);\n    }\n\n    return wallet;\n  }\n\n  private async fund() {\n    return this.send(\"eth_sendTransaction\", [\n      {\n        from: this.funderWallet.address,\n        to: this.wallet.address,\n        value: this.ethAmount.hex,\n        gas: hexlify(21000)\n      }\n    ]);\n\n    // TODO maybe wait for tx to be mined (not a problem on devchains though)\n  }\n\n  async send(method: string, params: any[]): Promise<any> {\n    if (!this.haveFunded) {\n      this.haveFunded = true;\n      await this.fund();\n    }\n\n    switch (method) {\n      case \"eth_accounts\":\n      case \"eth_requestAccounts\":\n        return [this.wallet.address];\n\n      case \"eth_sendTransaction\":\n        return this.send(\n          \"eth_sendRawTransaction\",\n          await Promise.all(\n            params.map(async ({ from, nonce, gas, ...rest }) => {\n              if (nonce === undefined) {\n                nonce = await this.send(\"eth_getTransactionCount\", [from]);\n              }\n\n              return this.findWallet(from).signTransaction({\n                from,\n                nonce,\n                ...(gas !== undefined ? { gasLimit: gas } : {}),\n                ...rest\n              });\n            })\n          )\n        );\n    }\n\n    //console.log({ method, params });\n\n    const response = await fetch(this.url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify({\n        method: method,\n        params: params,\n        id: this.id++,\n        jsonrpc: \"2.0\"\n      })\n    });\n\n    const json = await response.json();\n\n    //console.log(json);\n\n    if (json.error) {\n      const { message, ...rest } = json.error;\n      const error = new Error(`${message} ${JSON.stringify(rest)}`);\n      throw Object.assign(error, rest);\n    }\n\n    return json.result;\n  }\n\n  request({ method, params }: { method: string; params: any[] }) {\n    return this.send(method, params);\n  }\n}\n","export const COIN = \"ZUSD\";\nexport const GT = \"ZERO\";\nexport const LP = \"UNI LP\";\nexport const COIN2 = \"NUE\"\n// export const LP = \"ETH/ZUSD LP\";\n","export const shortenAddress = (address: string) => address.substr(0, 6) + \"...\" + address.substr(-4);\n","import React from \"react\";\nimport { Text, Flex, Box, Heading } from \"theme-ui\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { COIN, COIN2, GT } from \"../strings\";\nimport { useLiquity } from \"../hooks/LiquityContext\";\nimport { shortenAddress } from \"../utils/shortenAddress\";\n\nimport { Icon } from \"./Icon\";\n\nconst select = ({ accountBalance, zusdBalance, zeroBalance, nueBalance }: LiquityStoreState) => ({\n  accountBalance,\n  zusdBalance,\n  zeroBalance,\n  nueBalance\n});\n\nexport const UserAccount: React.FC = () => {\n  const { account } = useLiquity();\n  const { accountBalance, zusdBalance, zeroBalance, nueBalance } = useLiquitySelector(select);\n\n  return (\n    <Box sx={{ display: [\"none\", \"flex\"] }}>\n      <Flex sx={{ alignItems: \"center\" }}>\n        <Icon name=\"user-circle\" size=\"lg\" />\n        <Flex sx={{ ml: 3, mr: 4, flexDirection: \"column\" }}>\n          <Heading sx={{ fontSize: 1 }}>Connected as</Heading>\n          <Text as=\"span\" sx={{ fontSize: 1 }}>\n            {shortenAddress(account)}\n          </Text>\n        </Flex>\n      </Flex>\n\n      <Flex sx={{ alignItems: \"center\" }}>\n        <Icon name=\"wallet\" size=\"lg\" />\n\n        {([\n          [\"RBTC\", accountBalance],\n          [COIN, zusdBalance],\n          [COIN2, nueBalance],\n          [GT, zeroBalance]\n        ] as const).map(([currency, balance], i) => (\n          <Flex key={i} sx={{ ml: 3, flexDirection: \"column\" }}>\n            <Heading sx={{ fontSize: 1 }}>{currency}</Heading>\n            <Text sx={{ fontSize: 1 }}>{balance.prettify()}</Text>\n          </Flex>\n        ))}\n      </Flex>\n    </Box>\n  );\n};\n","import React from \"react\";\nimport Tippy, { TippyProps } from \"@tippyjs/react\";\nimport { Icon } from \"./Icon\";\nimport { FontAwesomeIconProps } from \"@fortawesome/react-fontawesome\";\n\nexport type InfoIconProps = Pick<TippyProps, \"placement\"> &\n  Pick<FontAwesomeIconProps, \"size\"> & {\n    tooltip: React.ReactNode;\n  };\n\nexport const InfoIcon: React.FC<InfoIconProps> = ({ placement = \"right\", tooltip, size = \"1x\" }) => {\n  return (\n    <Tippy interactive={true} placement={placement} content={tooltip} maxWidth=\"268px\">\n      <span>\n        &nbsp;\n        <Icon name=\"question-circle\" size={size} />\n      </span>\n    </Tippy>\n  );\n};\n","import React from \"react\";\nimport { Flex, Card } from \"theme-ui\";\nimport { InfoIcon } from \"./InfoIcon\";\n\ntype StatisticProps = {\n  name: React.ReactNode;\n  tooltip?: React.ReactNode;\n};\n\nexport const Statistic: React.FC<StatisticProps> = ({ name, tooltip, children }) => {\n  return (\n    <Flex sx={{ borderBottom: 1, borderColor: \"rgba(0, 0, 0, 0.1)\" }}>\n      <Flex sx={{ alignItems: \"center\", justifyContent: \"flex-start\", flex: 1.2, fontWeight: 200 }}>\n        <Flex>{name}</Flex>\n        {tooltip && <InfoIcon size=\"xs\" tooltip={<Card variant=\"tooltip\">{tooltip}</Card>} />}\n      </Flex>\n      <Flex sx={{ justifyContent: \"flex-start\", flex: 0.8, alignItems: \"center\" }}>{children}</Flex>\n    </Flex>\n  );\n};\n","import React from \"react\";\nimport { Card, Heading, Link, Box, Text } from \"theme-ui\";\nimport { AddressZero } from \"@ethersproject/constants\";\nimport { Decimal, Percent, LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"../hooks/LiquityContext\";\nimport { COIN, GT } from \"../strings\";\nimport { Statistic } from \"./Statistic\";\n\nconst selectBalances = ({ accountBalance, zusdBalance, zeroBalance }: LiquityStoreState) => ({\n  accountBalance,\n  zusdBalance,\n  zeroBalance\n});\n\nconst Balances: React.FC = () => {\n  const { accountBalance, zusdBalance, zeroBalance } = useLiquitySelector(selectBalances);\n\n  return (\n    <Box sx={{ mb: 3 }}>\n      <Heading>My Account Balances</Heading>\n      <Statistic name=\"RBTC\"> {accountBalance.prettify(4)}</Statistic>\n      <Statistic name={COIN}> {zusdBalance.prettify()}</Statistic>\n      <Statistic name={GT}>{zeroBalance.prettify()}</Statistic>\n    </Box>\n  );\n};\n\nconst GitHubCommit: React.FC<{ children?: string }> = ({ children }) =>\n  children?.match(/[0-9a-f]{40}/) ? (\n    <Link href={`https://github.com/DistributedCollective/zero/commit/${children}`}>{children.substr(0, 7)}</Link>\n  ) : (\n    <>unknown</>\n  );\n\ntype SystemStatsProps = {\n  variant?: string;\n  showBalances?: boolean;\n};\n\nconst select = ({\n  numberOfTroves,\n  price,\n  total,\n  zusdInStabilityPool,\n  borrowingRate,\n  redemptionRate,\n  totalStakedZERO,\n  frontend\n}: LiquityStoreState) => ({\n  numberOfTroves,\n  price,\n  total,\n  zusdInStabilityPool,\n  borrowingRate,\n  redemptionRate,\n  totalStakedZERO,\n  kickbackRate: frontend.status === \"registered\" ? frontend.kickbackRate : null\n});\n\nexport const SystemStats: React.FC<SystemStatsProps> = ({ variant = \"info\", showBalances }) => {\n  const {\n    liquity: {\n      connection: { version: contractsVersion, deploymentDate, frontendTag }\n    }\n  } = useLiquity();\n\n  const {\n    numberOfTroves,\n    price,\n    zusdInStabilityPool,\n    total,\n    borrowingRate,\n    totalStakedZERO,\n    kickbackRate\n  } = useLiquitySelector(select);\n\n  const zusdInStabilityPoolPct =\n    total.debt.nonZero && new Percent(zusdInStabilityPool.div(total.debt));\n  const totalCollateralRatioPct = new Percent(total.collateralRatio(price));\n  const borrowingFeePct = new Percent(borrowingRate);\n  const kickbackRatePct = frontendTag === AddressZero ? \"100\" : kickbackRate?.mul(100).prettify();\n\n  return (\n    <Card {...{ variant }}>\n      {showBalances && <Balances />}\n\n      <Heading>Zero statistics</Heading>\n\n      <Heading as=\"h2\" sx={{ mt: 3, fontWeight: \"body\" }}>\n        Protocol\n      </Heading>\n\n      <Statistic\n        name=\"Borrowing Fee\"\n        tooltip=\"The Borrowing Fee is a one-off fee charged as a percentage of the borrowed amount (in ZUSD) and is part of a Line of Credit's debt. The fee varies between 0.5% and 5% depending on ZUSD redemption volumes.\"\n      >\n        {borrowingFeePct.toString(2)}\n      </Statistic>\n\n      <Statistic\n        name=\"TVL\"\n        tooltip=\"The Total Value Locked (TVL) is the total value of RBTC locked as collateral in the system, given in RBTC and USD.\"\n      >\n        {total.collateral.shorten()} <Text sx={{ fontSize: 1 }}>&nbsp;RBTC</Text>\n        <Text sx={{ fontSize: 1 }}>\n          &nbsp;(${Decimal.from(total.collateral.mul(price)).shorten()})\n        </Text>\n      </Statistic>\n      <Statistic name=\"Credit Lines\" tooltip=\"The total number of active Lines of Credit in the system.\">\n        {Decimal.from(numberOfTroves).prettify(0)}\n      </Statistic>\n      <Statistic name=\"ZUSD supply\" tooltip=\"The total ZUSD minted by the Zero Protocol.\">\n        {total.debt.shorten()}\n      </Statistic>\n      {zusdInStabilityPoolPct && (\n        <Statistic\n          name=\"ZUSD in Stability Pool\"\n          tooltip=\"The total ZUSD currently held in the Stability Pool, expressed as an amount and a fraction of the ZUSD supply.\n        \"\n        >\n          {zusdInStabilityPool.shorten()}\n          <Text sx={{ fontSize: 1 }}>&nbsp;({zusdInStabilityPoolPct.toString(1)})</Text>\n        </Statistic>\n      )}\n      <Statistic\n        name=\"Staked ZERO\"\n        tooltip=\"The total amount of ZERO that is staked for earning fee revenue.\"\n      >\n        {totalStakedZERO.shorten()}\n      </Statistic>\n      <Statistic\n        name=\"Total Collateral Ratio\"\n        tooltip=\"The ratio of the USD value of the entire system collateral at the current RBTC:USD price, to the entire system debt.\"\n      >\n        {totalCollateralRatioPct.prettify()}\n      </Statistic>\n      <Statistic\n        name=\"Recovery Mode\"\n        tooltip=\"Recovery Mode is activated when the Total Collateral Ratio (TCR) falls below 150%. When active, your Line of Credit can be liquidated if its collateral ratio is below the TCR. The maximum collateral you can lose from liquidation is capped at 110% of your Line of Credit's debt. Operations are also restricted that would negatively impact the TCR.\"\n      >\n        {total.collateralRatioIsBelowCritical(price) ? <Box color=\"danger\">Yes</Box> : \"No\"}\n      </Statistic>\n      {}\n\n      <Heading as=\"h2\" sx={{ mt: 3, fontWeight: \"body\" }}>\n        Frontend\n      </Heading>\n      {kickbackRatePct && (\n        <Statistic\n          name=\"Kickback Rate\"\n          tooltip=\"A rate between 0 and 100% set by the Frontend Operator that determines the fraction of ZERO that will be paid out as a kickback to the Stability Providers using the frontend.\"\n        >\n          {kickbackRatePct}%\n        </Statistic>\n      )}\n\n      <Box sx={{ mt: 3, opacity: 0.66 }}>\n        <Box sx={{ fontSize: 0 }}>\n          Contracts version: <GitHubCommit>{contractsVersion}</GitHubCommit>\n        </Box>\n        <Box sx={{ fontSize: 0 }}>Deployed: {deploymentDate.toLocaleString()}</Box>\n        <Box sx={{ fontSize: 0 }}>\n          Frontend version:{\" \"}\n          {process.env.NODE_ENV === \"development\" ? (\n            \"development\"\n          ) : (\n            <GitHubCommit>{process.env.REACT_APP_VERSION}</GitHubCommit>\n          )}\n        </Box>\n      </Box>\n    </Card>\n  );\n};\n","import React, { useState, useRef } from \"react\";\nimport { Container, Flex, Button } from \"theme-ui\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { Icon } from \"./Icon\";\nimport { SystemStats } from \"./SystemStats\";\n\nconst select = ({ total, price }: LiquityStoreState) => ({ total, price });\n\nexport const SystemStatsPopup: React.FC = () => {\n  const { price, total } = useLiquitySelector(select);\n\n  const [systemStatsOpen, setSystemStatsOpen] = useState(false);\n  const systemStatsOverlayRef = useRef<HTMLDivElement>(null);\n\n  return (\n    <>\n      <Button\n        onClick={() => setSystemStatsOpen(!systemStatsOpen)}\n        variant=\"icon\"\n        sx={{\n          position: \"relative\",\n          display: [\"block\", \"none\"]\n        }}\n      >\n        <Icon name=\"info-circle\" size=\"2x\" />\n\n        {total.collateralRatioIsBelowCritical(price) && (\n          <Flex\n            sx={{\n              position: \"absolute\",\n              right: 0,\n              top: 0,\n              width: \"100%\",\n              height: \"100%\",\n\n              alignItems: \"flex-start\",\n              justifyContent: \"flex-end\",\n              pt: \"2px\",\n\n              color: \"danger\"\n            }}\n          >\n            <Icon name=\"exclamation-circle\" size=\"xs\" />\n          </Flex>\n        )}\n      </Button>\n\n      {systemStatsOpen && (\n        <Container\n          variant=\"infoOverlay\"\n          ref={systemStatsOverlayRef}\n          onClick={e => {\n            if (e.target === systemStatsOverlayRef.current) {\n              setSystemStatsOpen(false);\n            }\n          }}\n        >\n          <SystemStats variant=\"infoPopup\" showBalances />\n        </Container>\n      )}\n    </>\n  );\n};\n","import React from \"react\";\nimport { Box } from \"theme-ui\";\n\ntype LiquityLogoProps = React.ComponentProps<typeof Box> & {\n  height?: number | string;\n};\n\nexport const LiquityLogo: React.FC<LiquityLogoProps> = ({ height, ...boxProps }) => (\n  <Box sx={{ lineHeight: 0 }} {...boxProps}>\n    <svg id=\"Group_6\" data-name=\"Group 6\" xmlns=\"http://www.w3.org/2000/svg\" height={height} viewBox=\"0 0 384.667 101.786\">\n      <path id=\"Path_30\" data-name=\"Path 30\" d=\"M57.768,14.291v-9.4H18.473L55.982-32.925A5.955,5.955,0,0,0,58-37.118c0-3.339-2.718-5.048-5.591-5.048H3.019v9.4H41.848L4.339,5.05A5.955,5.955,0,0,0,2.32,9.244c0,3.339,2.64,5.048,5.591,5.048Zm59.1,0V4.429H76.173V-32.3h40.615v-9.863h-50.4V14.291Zm-2.174-24.54v-8.309H83.4v8.309Zm77.037,24.54L174.721-2.871c7.3-2.8,11.649-9.4,11.649-18.716,0-12.581-7.61-20.579-20.5-20.579H125.33V14.291h9.785V-32.3h30.753c6.756,0,10.794,3.572,10.794,10.872s-3.728,11.338-10.794,11.338h-23.53v8.7H163.46L177.75,14.291Zm43.333,0c16.075,0,27.646-12.425,27.646-28.811s-11.338-27.646-27.646-27.646H221.316c-15.765,0-27.413,11.027-27.413,27.646,0,16.386,11.649,28.811,27.413,28.811ZM221.316,4.429c-10.173,0-17.551-7.843-17.551-18.483,0-10.717,7.455-18.25,17.551-18.25h13.745c10.406,0,17.784,7.61,17.784,18.25S245.467,4.429,235.061,4.429Z\" transform=\"translate(121.96 63.367)\" fill=\"#e8e8e8\" />\n      <path id=\"Path_29\" data-name=\"Path 29\" d=\"M1839.307,339.146l-16.094-16.094-9.453,9.453a48.194,48.194,0,0,0-66.439,66.439l-9.8,9.8,16.094,16.094,10.011-10.01a48.2,48.2,0,0,0,66.017-66.017Zm-79.276,34.187a28.113,28.113,0,0,1,38.877-25.975l-36.735,36.735A28.012,28.012,0,0,1,1760.031,373.333Zm56.235,0a28.054,28.054,0,0,1-37.592,26.447l35.921-35.921A28.013,28.013,0,0,1,1816.266,373.333Z\" transform=\"translate(-1737.521 -323.052)\" fill=\"#e8e8e8\" />\n    </svg>\n  </Box>\n);\n","import { NavLink as RouterLink, NavLinkProps as RouterLinkProps } from \"react-router-dom\";\nimport { NavLink as ThemeUINavLink, NavLinkProps as ThemeUILinkProps } from \"theme-ui\";\n\ntype CombinedProps = ThemeUILinkProps & RouterLinkProps<{}>;\n\nconst ExactLink: React.FC<CombinedProps> = props => {\n  return <RouterLink exact {...props} />;\n};\n\nexport const Link: React.FC<CombinedProps> = props => {\n  return <ThemeUINavLink {...props} as={ExactLink} />;\n};\n","import { Flex, Box, NavLink } from \"theme-ui\";\nimport { Link } from \"./Link\";\n\nexport const Nav: React.FC = () => {\n  return (\n    <Box as=\"nav\" sx={{ display: [\"none\", \"flex\"], alignItems: \"center\", flex: 1 }}>\n      <Flex>\n        <Link to=\"/\">Dashboard</Link>\n        <NavLink href=\"https://live.sovryn.app/swap\" target=\"_blank\">Trade</NavLink>\n      </Flex>\n      <Flex sx={{ justifyContent: \"flex-end\", mr: 3, flex: 1 }}>\n        <Link sx={{ fontSize: 1 }} to=\"/liquidation\">\n          Liquidation\n        </Link>\n        <Link sx={{ fontSize: 1 }} to=\"/redemption\">\n          Redemption\n        </Link>\n      </Flex>\n    </Box>\n  );\n};\n","import React, { useState, useRef } from \"react\";\nimport { Box, Button, Container, Flex, NavLink } from \"theme-ui\";\nimport { Icon } from \"./Icon\";\nimport { LiquityLogo } from \"./LiquityLogo\";\nimport { Link } from \"./Link\";\n\nconst logoHeight = \"32px\";\n\nexport const SideNav: React.FC = () => {\n  const [isVisible, setIsVisible] = useState(false);\n  const overlay = useRef<HTMLDivElement>(null);\n\n  if (!isVisible) {\n    return (\n      <Button sx={{ display: [\"flex\", \"none\"] }} variant=\"icon\" onClick={() => setIsVisible(true)}>\n        <Icon name=\"bars\" size=\"lg\" />\n      </Button>\n    );\n  }\n  return (\n    <Container\n      variant=\"infoOverlay\"\n      ref={overlay}\n      onClick={e => {\n        if (e.target === overlay.current) {\n          setIsVisible(false);\n        }\n      }}\n    >\n      <Flex variant=\"layout.sidenav\">\n        <Button\n          sx={{ position: \"fixed\", right: \"25vw\", m: 2 }}\n          variant=\"icon\"\n          onClick={() => setIsVisible(false)}\n        >\n          <Icon name=\"times\" size=\"2x\" />\n        </Button>\n        <LiquityLogo height={logoHeight} p={2} />\n        <Box as=\"nav\" sx={{ m: 3, mt: 1, p: 0 }} onClick={() => setIsVisible(false)}>\n          <Link to=\"/\">Dashboard</Link>\n          <NavLink href=\"https://live.sovryn.app/swap\" target=\"_blank\">Trade</NavLink>\n          <Link to=\"/liquidation\">Liquidation</Link>\n          <Link to=\"/redemption\">Redemption</Link>\n        </Box>\n      </Flex>\n    </Container>\n  );\n};\n","import React from \"react\";\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { Container, Flex, Box } from \"theme-ui\";\nimport { AddressZero } from \"@ethersproject/constants\";\nimport { useLiquity } from \"../hooks/LiquityContext\";\n\nimport { LiquityLogo } from \"./LiquityLogo\";\nimport { Nav } from \"./Nav\";\nimport { SideNav } from \"./SideNav\";\n\nconst logoHeight = \"32px\";\n\nconst select = ({ frontend }: LiquityStoreState) => ({\n  frontend\n});\n\nexport const Header: React.FC = ({ children }) => {\n  const {\n    config: { frontendTag }\n  } = useLiquity();\n  const { frontend } = useLiquitySelector(select);\n  const isFrontendRegistered = frontendTag === AddressZero || frontend.status === \"registered\";\n\n  return (\n    <Container variant=\"header\">\n      <Flex sx={{ alignItems: \"center\", flex: 1 }}>\n        <LiquityLogo height={logoHeight} />\n\n        <Box\n          sx={{\n            mx: [2, 3],\n            width: \"0px\",\n            height: \"100%\",\n            borderLeft: [\"none\", \"1px solid lightgrey\"]\n          }}\n        />\n        {isFrontendRegistered && (\n          <>\n            <SideNav />\n            <Nav />\n          </>\n        )}\n      </Flex>\n\n      {children}\n    </Container>\n  );\n};\n","import { Box, Flex, Text } from \"theme-ui\";\n\nimport { Icon } from \"./Icon\";\n\nexport const ActionDescription: React.FC = ({ children }) => (\n  <Box\n    sx={{\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"space-around\",\n\n      mb: [2, 3],\n      p: 3,\n\n      border: 1,\n      borderRadius: \"8px\",\n      borderColor: \"primary\",\n      boxShadow: 2,\n      bg: \"background\",\n      '& svg': {\n        color: \"primary\"\n      }\n    }}\n  >\n    <Flex sx={{ alignItems: \"center\" }}>\n      <Icon name=\"info-circle\" size=\"lg\" />\n      <Text sx={{ ml: 2 }}>{children}</Text>\n    </Flex>\n  </Box>\n);\n\nexport const Amount: React.FC = ({ children }) => (\n  <Text sx={{ fontWeight: \"bold\", whiteSpace: \"nowrap\" }}>{children}</Text>\n);\n","import React, { useState } from \"react\";\nimport { Text, Flex, Label, Input, SxProp, Button, ThemeUICSSProperties } from \"theme-ui\";\n\nimport { Icon } from \"../Icon\";\n\ntype RowProps = SxProp & {\n  label: string;\n  labelId?: string;\n  labelFor?: string;\n  infoIcon?: React.ReactNode;\n};\n\nexport const Row: React.FC<RowProps> = ({ sx, label, labelId, labelFor, children, infoIcon }) => {\n  return (\n    <Flex sx={{ alignItems: \"stretch\", ...sx }}>\n      <Label\n        id={labelId}\n        htmlFor={labelFor}\n        sx={{\n          p: 0,\n          pl: 3,\n          pt: \"12px\",\n          position: \"absolute\",\n\n          fontSize: 1,\n          border: 1,\n          borderColor: \"transparent\"\n        }}\n      >\n        <Flex sx={{ alignItems: \"center\" }}>\n          {label}\n          {infoIcon && infoIcon}\n        </Flex>\n      </Label>\n      {children}\n    </Flex>\n  );\n};\n\ntype PendingAmountProps = {\n  value: string;\n};\n\nconst PendingAmount: React.FC<PendingAmountProps & SxProp> = ({ sx, value }) => (\n  <Text {...{ sx }}>\n    (\n    {value === \"++\" ? (\n      <Icon name=\"angle-double-up\" />\n    ) : value === \"--\" ? (\n      <Icon name=\"angle-double-down\" />\n    ) : value?.startsWith(\"+\") ? (\n      <>\n        <Icon name=\"angle-up\" /> {value.substr(1)}\n      </>\n    ) : value?.startsWith(\"-\") ? (\n      <>\n        <Icon name=\"angle-down\" /> {value.substr(1)}\n      </>\n    ) : (\n      value\n    )}\n    )\n  </Text>\n);\n\ntype StaticAmountsProps = {\n  inputId: string;\n  labelledBy?: string;\n  amount: string;\n  unit?: string;\n  color?: string;\n  pendingAmount?: string;\n  pendingColor?: string;\n  onClick?: () => void;\n};\n\nexport const StaticAmounts: React.FC<StaticAmountsProps & SxProp> = ({\n  sx,\n  inputId,\n  labelledBy,\n  amount,\n  unit,\n  color,\n  pendingAmount,\n  pendingColor,\n  onClick,\n  children\n}) => {\n  return (\n    <Flex\n      id={inputId}\n      aria-labelledby={labelledBy}\n      {...{ onClick }}\n      sx={{\n        justifyContent: \"space-between\",\n        alignItems: \"center\",\n\n        ...(onClick ? { cursor: \"text\" } : {}),\n\n        ...staticStyle,\n        ...sx\n      }}\n    >\n      <Flex sx={{ alignItems: \"center\" }}>\n        <Text sx={{ color, fontWeight: \"medium\" }}>{amount}</Text>\n\n        {unit && (\n          <>\n            &nbsp;\n            <Text sx={{ fontWeight: \"light\", opacity: 0.8 }}>{unit}</Text>\n          </>\n        )}\n\n        {pendingAmount && (\n          <>\n            &nbsp;\n            <PendingAmount\n              sx={{ color: pendingColor, opacity: 0.8, fontSize: \"0.666em\" }}\n              value={pendingAmount}\n            />\n          </>\n        )}\n      </Flex>\n\n      {children}\n    </Flex>\n  );\n};\n\nconst staticStyle: ThemeUICSSProperties = {\n  flexGrow: 1,\n\n  mb: 0,\n  pl: 3,\n  pr: \"11px\",\n  pb: 0,\n  pt: \"28px\",\n\n  fontSize: 3,\n\n  border: 1,\n  borderColor: \"transparent\"\n};\n\nconst editableStyle: ThemeUICSSProperties = {\n  flexGrow: 1,\n\n  mb: [2, 3],\n  pl: 3,\n  pr: \"11px\",\n  pb: 2,\n  pt: \"28px\",\n\n  fontSize: 4,\n\n  boxShadow: [1, 2],\n  border: 1,\n  borderColor: \"muted\"\n};\n\ntype StaticRowProps = RowProps & StaticAmountsProps;\n\nexport const StaticRow: React.FC<StaticRowProps> = ({\n  label,\n  labelId,\n  labelFor,\n  infoIcon,\n  ...props\n}) => (\n  <Row {...{ label, labelId, labelFor, infoIcon }} sx={{ mt: [-2, -3], pb: [2, 3] }}>\n    <StaticAmounts {...props} />\n  </Row>\n);\n\ntype DisabledEditableRowProps = Omit<StaticAmountsProps, \"labelledBy\" | \"onClick\"> & {\n  label: string;\n};\n\nexport const DisabledEditableRow: React.FC<DisabledEditableRowProps> = ({\n  inputId,\n  label,\n  unit,\n  amount,\n  color,\n  pendingAmount,\n  pendingColor\n}) => (\n  <Row labelId={`${inputId}-label`} {...{ label, unit }}>\n    <StaticAmounts\n      sx={{ ...editableStyle, boxShadow: 0 }}\n      labelledBy={`${inputId}-label`}\n      {...{ inputId, amount, unit, color, pendingAmount, pendingColor }}\n    />\n  </Row>\n);\n\ntype EditableRowProps = DisabledEditableRowProps & {\n  editingState: [string | undefined, (editing: string | undefined) => void];\n  editedAmount: string;\n  setEditedAmount: (editedAmount: string) => void;\n  maxAmount?: string;\n  maxedOut?: boolean;\n};\n\nexport const EditableRow: React.FC<EditableRowProps> = ({\n  label,\n  inputId,\n  unit,\n  amount,\n  color,\n  pendingAmount,\n  pendingColor,\n  editingState,\n  editedAmount,\n  setEditedAmount,\n  maxAmount,\n  maxedOut\n}) => {\n  const [editing, setEditing] = editingState;\n  const [invalid, setInvalid] = useState(false);\n\n  return editing === inputId ? (\n    <Row {...{ label, labelFor: inputId, unit }}>\n      <Input\n        autoFocus\n        id={inputId}\n        type=\"number\"\n        step=\"any\"\n        defaultValue={editedAmount}\n        {...{ invalid }}\n        onChange={e => {\n          try {\n            setEditedAmount(e.target.value);\n            setInvalid(false);\n          } catch {\n            setInvalid(true);\n          }\n        }}\n        onBlur={() => {\n          setEditing(undefined);\n          setInvalid(false);\n        }}\n        variant=\"editor\"\n        sx={{\n          ...editableStyle,\n          fontWeight: \"medium\",\n          bg: invalid ? \"danger\" : \"background\"\n        }}\n      />\n    </Row>\n  ) : (\n    <Row labelId={`${inputId}-label`} {...{ label, unit }}>\n      <StaticAmounts\n        sx={{\n          ...editableStyle,\n          bg: invalid ? \"invalid\" : \"background\"\n        }}\n        labelledBy={`${inputId}-label`}\n        onClick={() => setEditing(inputId)}\n        {...{ inputId, amount, unit, color, pendingAmount, pendingColor, invalid }}\n      >\n        {maxAmount && (\n          <Button\n            sx={{ fontSize: 1, p: 1, px: 3 }}\n            onClick={event => {\n              setEditedAmount(maxAmount);\n              event.stopPropagation();\n            }}\n            disabled={maxedOut}\n          >\n            max\n          </Button>\n        )}\n      </StaticAmounts>\n    </Row>\n  );\n};\n","import React from \"react\";\nimport { Container, Spinner } from \"theme-ui\";\n\nexport const LoadingOverlay: React.FC = () => (\n  <Container\n    variant=\"disabledOverlay\"\n    sx={{ p: \"14px\", display: \"flex\", justifyContent: \"flex-end\" }}\n  >\n    <Spinner size=\"28px\" sx={{ color: \"text\" }} />\n  </Container>\n);\n","import React from \"react\";\nimport { Flex, Box, Card } from \"theme-ui\";\n\nimport { CRITICAL_COLLATERAL_RATIO, Decimal, Difference, Percent } from \"@liquity/lib-base\";\n\nimport { Icon } from \"../Icon\";\n\nimport { StaticRow } from \"./Editor\";\nimport { InfoIcon } from \"../InfoIcon\";\nimport { ActionDescription } from \"../ActionDescription\";\n\ntype CollateralRatioProps = {\n  value?: Decimal;\n  change?: Difference;\n};\n\nexport const CollateralRatio: React.FC<CollateralRatioProps> = ({ value, change }) => {\n  const collateralRatioPct = new Percent(value ?? { toString: () => \"N/A\" });\n  const changePct = change && new Percent(change);\n  return (\n    <>\n      <Flex>\n        <Box sx={{ mt: [2, 0], ml: 3, mr: -2, fontSize: \"24px\" }}>\n          <Icon name=\"heartbeat\" />\n        </Box>\n\n        <StaticRow\n          label=\"Collateral ratio\"\n          inputId=\"trove-collateral-ratio\"\n          amount={collateralRatioPct.prettify()}\n          color={\n            value?.gt(CRITICAL_COLLATERAL_RATIO)\n              ? \"success\"\n              : value?.gt(1.2)\n              ? \"warning\"\n              : value?.lte(1.2)\n              ? \"danger\"\n              : \"muted\"\n          }\n          pendingAmount={\n            change?.positive?.absoluteValue?.gt(10)\n              ? \"++\"\n              : change?.negative?.absoluteValue?.gt(10)\n              ? \"--\"\n              : changePct?.nonZeroish(2)?.prettify()\n          }\n          pendingColor={change?.positive ? \"success\" : \"danger\"}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"220px\" }}>\n                  The ratio between the dollar value of the collateral and the debt (in ZUSD) you are\n                  depositing. While the Minimum Collateral Ratio is 110% during normal operation, it\n                  is recommended to keep the Collateral Ratio always above 150% to avoid liquidation\n                  under Recovery Mode. A Collateral Ratio above 200% or 250% is recommended for\n                  additional safety.\n                </Card>\n              }\n            />\n          }\n        />\n      </Flex>\n      {value?.lt(1.5) && (\n        <ActionDescription>\n          Keeping your CR above 150% can help avoid liquidation under Recovery Mode.\n        </ActionDescription>\n      )}\n    </>\n  );\n};\n","import React from \"react\";\nimport { Checkbox, CheckboxProps, Label } from \"@theme-ui/components\";\n\nexport type NueCheckboxProps = Pick<CheckboxProps, \"checked\" | \"onChange\">;\n\nexport const NueCheckbox: React.FC<NueCheckboxProps> = ({\n  checked,\n  onChange\n}) => (\n  <Label sx={{ display: \"flex\" }}>\n    <Checkbox checked={checked} onChange={onChange} />\n    Use NUE\n  </Label>\n)\n","import React from \"react\";\nimport { Heading, Box, Card } from \"theme-ui\";\n\nimport {\n  Percent,\n  Difference,\n  Decimalish,\n  Decimal,\n  Trove,\n  LiquityStoreState,\n  ZUSD_LIQUIDATION_RESERVE\n} from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { StaticRow } from \"./Editor\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\nimport { CollateralRatio } from \"./CollateralRatio\";\nimport { InfoIcon } from \"../InfoIcon\";\nimport { NueCheckbox } from \"./NueCheckbox\";\n\ntype TroveEditorProps = {\n  borrowedToken: string;\n  useNueToken: boolean;\n  handleSetNueToken: () => void;\n  original: Trove;\n  edited: Trove;\n  fee: Decimal;\n  borrowingRate: Decimal;\n  changePending: boolean;\n  dispatch: (\n    action: { type: \"setCollateral\" | \"setDebt\"; newValue: Decimalish } | { type: \"revert\" }\n  ) => void;\n};\n\nconst select = ({ price }: LiquityStoreState) => ({ price });\n\nexport const TroveEditor: React.FC<TroveEditorProps> = ({\n  children,\n  original,\n  edited,\n  fee,\n  useNueToken,\n  handleSetNueToken,\n  borrowedToken,\n  borrowingRate,\n  changePending\n}) => {\n  const { price } = useLiquitySelector(select);\n\n  const feePct = new Percent(borrowingRate);\n\n  const originalCollateralRatio = !original.isEmpty ? original.collateralRatio(price) : undefined;\n  const collateralRatio = !edited.isEmpty ? edited.collateralRatio(price) : undefined;\n  const collateralRatioChange = Difference.between(collateralRatio, originalCollateralRatio);\n\n  return (\n    <Card>\n      <Heading>Line of Credit</Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <StaticRow\n          label=\"Collateral\"\n          inputId=\"trove-collateral\"\n          amount={edited.collateral.prettify(4)}\n          unit=\"RBTC\"\n        />\n\n        <NueCheckbox checked={useNueToken} onChange={handleSetNueToken} />\n\n        <StaticRow label=\"Debt\" inputId=\"trove-debt\" amount={edited.debt.prettify()} unit={borrowedToken} />\n\n        {original.isEmpty && (\n          <StaticRow\n            label=\"Liquidation Reserve\"\n            inputId=\"trove-liquidation-reserve\"\n            amount={`${ZUSD_LIQUIDATION_RESERVE}`}\n            unit={borrowedToken}\n            infoIcon={\n              <InfoIcon\n                tooltip={\n                  <Card variant=\"tooltip\" sx={{ width: \"200px\" }}>\n                    An amount set aside to cover the liquidators gas costs if your Line of Credit needs \n                    to be liquidated. The amount increases your debt and is refunded if you close your\n                    Line of Credit by fully paying off its net debt.\n                  </Card>\n                }\n              />\n            }\n          />\n        )}\n\n        <StaticRow\n          label=\"Borrowing Fee\"\n          inputId=\"trove-borrowing-fee\"\n          amount={fee.toString(2)}\n          pendingAmount={feePct.toString(2)}\n          unit={borrowedToken}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"240px\" }}>\n                  This amount is deducted from the borrowed amount as a one-time fee. There are no\n                  recurring fees for borrowing, which is thus interest-free.\n                </Card>\n              }\n            />\n          }\n        />\n\n        <CollateralRatio value={collateralRatio} change={collateralRatioChange} />\n\n        {children}\n      </Box>\n\n      {changePending && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import { useMemo } from \"react\";\nimport { Button } from \"theme-ui\";\n\nimport { Decimal, TroveChange } from \"@liquity/lib-base\";\n\nimport { useLiquity } from \"../../hooks/LiquityContext\";\nimport { TransactionFunction, useTransactionFunction } from \"../Transaction\";\n\ntype TroveActionProps = {\n  transactionId: string;\n  useNueToken: boolean;\n  change: Exclude<TroveChange<Decimal>, { type: \"invalidCreation\" }>;\n  maxBorrowingRate: Decimal;\n};\n\nexport const TroveAction: React.FC<TroveActionProps> = ({\n  children,\n  transactionId,\n  change,\n  useNueToken,\n  maxBorrowingRate\n}) => {\n  const { liquity } = useLiquity();\n\n  const troveAction = useMemo(() => {\n    let action: TransactionFunction;\n\n    switch (change.type) {\n      case 'creation': {\n        action = useNueToken\n          ? liquity.send.openNueTrove.bind(liquity.send, change.params, maxBorrowingRate)\n          : liquity.send.openTrove.bind(liquity.send, change.params, maxBorrowingRate)\n        break;\n      }\n\n      case 'closure': {\n        action = useNueToken\n          ? liquity.send.closeNueTrove.bind(liquity.send)\n          : liquity.send.closeTrove.bind(liquity.send)\n        break;\n      }\n\n      case 'adjustment': {\n        action = useNueToken\n          ? liquity.send.adjustNueTrove.bind(liquity.send, change.params, maxBorrowingRate)\n          : liquity.send.adjustTrove.bind(liquity.send, change.params, maxBorrowingRate)\n        break;\n      }\n    }\n\n    return action;\n  }, [change.params, change.type, liquity.send, maxBorrowingRate, useNueToken]);\n\n  const [sendTransaction] = useTransactionFunction(\n    transactionId,\n    troveAction\n  );\n\n  return <Button onClick={sendTransaction}>{children}</Button>;\n};\n","import { createContext, useContext } from \"react\";\nimport type { TroveView, TroveEvent } from \"./types\";\n\ntype TroveViewContextType = {\n  view: TroveView;\n  dispatchEvent: (event: TroveEvent) => void;\n};\n\nexport const TroveViewContext = createContext<TroveViewContextType | null>(null);\n\nexport const useTroveView = (): TroveViewContextType => {\n  const context: TroveViewContextType | null = useContext(TroveViewContext);\n\n  if (context === null) {\n    throw new Error(\"You must add a <TroveViewProvider> into the React tree\");\n  }\n\n  return context;\n};\n","import { Box, Flex, Text } from \"theme-ui\";\n\nimport { Icon } from \"./Icon\";\n\nexport const ErrorDescription: React.FC = ({ children }) => (\n  <Box\n    sx={{\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"space-around\",\n\n      mb: [2, 3],\n      p: 3,\n\n      border: 1,\n      borderRadius: \"8px\",\n      borderColor: \"danger\",\n      boxShadow: 2,\n      bg: \"rgba(220, 44, 16, 0.05)\",\n      '& svg': {\n        color: \"danger\"\n      }\n    }}\n  >\n    <Flex sx={{ alignItems: \"center\" }}>\n      <Icon name=\"exclamation-triangle\" size=\"lg\" />\n      <Text sx={{ ml: 2 }}>{children}</Text>\n    </Flex>\n  </Box>\n);\n","import {\n  Decimal,\n  ZUSD_MINIMUM_DEBT,\n  Trove,\n  TroveAdjustmentParams,\n  TroveChange,\n  Percent,\n  MINIMUM_COLLATERAL_RATIO,\n  CRITICAL_COLLATERAL_RATIO,\n  LiquityStoreState,\n  TroveClosureParams,\n  TroveCreationParams\n} from \"@liquity/lib-base\";\n\nimport { COIN, COIN2 } from \"../../../strings\";\n\nimport { ActionDescription, Amount } from \"../../ActionDescription\";\nimport { ErrorDescription } from \"../../ErrorDescription\";\n\nconst mcrPercent = new Percent(MINIMUM_COLLATERAL_RATIO).toString(0);\nconst ccrPercent = new Percent(CRITICAL_COLLATERAL_RATIO).toString(0);\n\ntype TroveAdjustmentDescriptionParams = {\n  params: TroveAdjustmentParams<Decimal>;\n  useNueBalance: Boolean\n};\n\nconst TroveChangeDescription: React.FC<TroveAdjustmentDescriptionParams> = ({ params, useNueBalance }) => (\n  <ActionDescription>\n    {params.depositCollateral && params.borrowZUSD ? (\n      <>\n        You will deposit <Amount>{params.depositCollateral.prettify()} RBTC</Amount> and receive{\" \"}\n        <Amount>\n          {params.borrowZUSD.prettify()} {useNueBalance ? COIN2 : COIN}\n        </Amount>\n      </>\n    ) : params.repayZUSD && params.withdrawCollateral ? (\n      <>\n        You will pay{\" \"}\n        <Amount>\n          {params.repayZUSD.prettify()} {useNueBalance ? COIN2 : COIN}\n        </Amount>{\" \"}\n        and receive <Amount>{params.withdrawCollateral.prettify()} RBTC</Amount>\n      </>\n    ) : params.depositCollateral && params.repayZUSD ? (\n      <>\n        You will deposit <Amount>{params.depositCollateral.prettify()} RBTC</Amount> and pay{\" \"}\n        <Amount>\n          {params.repayZUSD.prettify()} {useNueBalance ? COIN2 : COIN}\n        </Amount>\n      </>\n    ) : params.borrowZUSD && params.withdrawCollateral ? (\n      <>\n        You will receive <Amount>{params.withdrawCollateral.prettify()} RBTC</Amount> and{\" \"}\n        <Amount>\n          {params.borrowZUSD.prettify()} {useNueBalance ? COIN2 : COIN}\n        </Amount>\n      </>\n    ) : params.depositCollateral ? (\n      <>\n        You will deposit <Amount>{params.depositCollateral.prettify()} RBTC</Amount>\n      </>\n    ) : params.withdrawCollateral ? (\n      <>\n        You will receive <Amount>{params.withdrawCollateral.prettify()} RBTC</Amount>\n      </>\n    ) : params.borrowZUSD ? (\n      <>\n        You will receive{\" \"}\n        <Amount>\n          {params.borrowZUSD.prettify()} {useNueBalance ? COIN2 : COIN}\n        </Amount>\n      </>\n    ) : (\n      <>\n        You will pay{\" \"}\n        <Amount>\n          {params.repayZUSD.prettify()} {useNueBalance ? COIN2 : COIN}\n        </Amount>\n      </>\n    )}\n    .\n  </ActionDescription>\n);\n\nexport const selectForTroveChangeValidation = ({\n  price,\n  total,\n  accountBalance,\n  zusdBalance,\n  nueBalance,\n  numberOfTroves\n}: LiquityStoreState) => ({ price, total, accountBalance, zusdBalance, nueBalance, numberOfTroves });\n\ntype TroveChangeValidationSelectedState = ReturnType<typeof selectForTroveChangeValidation>;\n\ninterface TroveChangeValidationContext extends TroveChangeValidationSelectedState {\n  originalTrove: Trove;\n  resultingTrove: Trove;\n  recoveryMode: boolean;\n  wouldTriggerRecoveryMode: boolean;\n}\n\nexport const validateTroveChange = (\n  originalTrove: Trove,\n  adjustedTrove: Trove,\n  borrowingRate: Decimal,\n  useNueBalance: Boolean,\n  selectedState: TroveChangeValidationSelectedState\n): [\n  validChange: Exclude<TroveChange<Decimal>, { type: \"invalidCreation\" }> | undefined,\n  description: JSX.Element | undefined\n] => {\n  const { total, price } = selectedState;\n  const change = originalTrove.whatChanged(adjustedTrove, borrowingRate);\n\n  if (!change) {\n    return [undefined, undefined];\n  }\n\n  // Reapply change to get the exact state the Trove will end up in (which could be slightly\n  // different from `edited` due to imprecision).\n  const resultingTrove = originalTrove.apply(change, borrowingRate);\n  const recoveryMode = total.collateralRatioIsBelowCritical(price);\n  const wouldTriggerRecoveryMode = total\n    .subtract(originalTrove)\n    .add(resultingTrove)\n    .collateralRatioIsBelowCritical(price);\n\n  const context: TroveChangeValidationContext = {\n    ...selectedState,\n    originalTrove,\n    resultingTrove,\n    recoveryMode,\n    wouldTriggerRecoveryMode\n  };\n\n  if (change.type === \"invalidCreation\") {\n    // Trying to create a Trove with negative net debt\n    return [\n      undefined,\n      <ErrorDescription>\n        Total debt must be at least{\" \"}\n        <Amount>\n          {ZUSD_MINIMUM_DEBT.toString()} {COIN}\n        </Amount>\n        .\n      </ErrorDescription>\n    ];\n  }\n\n  const errorDescription =\n    change.type === \"creation\"\n      ? validateTroveCreation(change.params, context)\n      : change.type === \"closure\"\n      ? validateTroveClosure(useNueBalance, change.params, context)\n      : validateTroveAdjustment(useNueBalance, change.params, context);\n\n  if (errorDescription) {\n    return [undefined, errorDescription];\n  }\n\n  return [change, <TroveChangeDescription params={change.params} useNueBalance={useNueBalance} />];\n};\n\nconst validateTroveCreation = (\n  { depositCollateral }: TroveCreationParams<Decimal>,\n  {\n    resultingTrove,\n    recoveryMode,\n    wouldTriggerRecoveryMode,\n    accountBalance,\n    price\n  }: TroveChangeValidationContext\n): JSX.Element | null => {\n  if (resultingTrove.debt.lt(ZUSD_MINIMUM_DEBT)) {\n    return (\n      <ErrorDescription>\n        Total debt must be at least{\" \"}\n        <Amount>\n          {ZUSD_MINIMUM_DEBT.toString()} {COIN}\n        </Amount>\n        .\n      </ErrorDescription>\n    );\n  }\n\n  if (recoveryMode) {\n    if (!resultingTrove.isOpenableInRecoveryMode(price)) {\n      return (\n        <ErrorDescription>\n          You're not allowed to open a Line of Credit with less than <Amount>{ccrPercent}</Amount> Collateral\n          Ratio during recovery mode. Please increase your Line of Credit's Collateral Ratio.\n        </ErrorDescription>\n      );\n    }\n  } else {\n    if (resultingTrove.collateralRatioIsBelowMinimum(price)) {\n      return (\n        <ErrorDescription>\n          Collateral ratio must be at least <Amount>{mcrPercent}</Amount>.\n        </ErrorDescription>\n      );\n    }\n\n    if (wouldTriggerRecoveryMode) {\n      return (\n        <ErrorDescription>\n          You're not allowed to open a Line of Credit that would cause the Total Collateral Ratio to fall\n          below <Amount>{ccrPercent}</Amount>. Please increase your Line of Credit's Collateral Ratio.\n        </ErrorDescription>\n      );\n    }\n  }\n\n  if (depositCollateral.gt(accountBalance)) {\n    return (\n      <ErrorDescription>\n        The amount you're trying to deposit exceeds your balance by{\" \"}\n        <Amount>{depositCollateral.sub(accountBalance).prettify()} RBTC</Amount>.\n      </ErrorDescription>\n    );\n  }\n\n  return null;\n};\n\nconst validateTroveAdjustment = (\n  useNueBalance : Boolean,\n  { depositCollateral, withdrawCollateral, borrowZUSD, repayZUSD }: TroveAdjustmentParams<Decimal>,\n  {\n    originalTrove,\n    resultingTrove,\n    recoveryMode,\n    wouldTriggerRecoveryMode,\n    price,\n    accountBalance,\n    zusdBalance,\n    nueBalance\n  }: TroveChangeValidationContext\n): JSX.Element | null => {\n  if (recoveryMode) {\n    if (withdrawCollateral) {\n      return (\n        <ErrorDescription>\n          You're not allowed to withdraw collateral during recovery mode.\n        </ErrorDescription>\n      );\n    }\n\n    if (borrowZUSD) {\n      if (resultingTrove.collateralRatioIsBelowCritical(price)) {\n        return (\n          <ErrorDescription>\n            Your collateral ratio must be at least <Amount>{ccrPercent}</Amount> to borrow during\n            recovery mode. Please improve your collateral ratio.\n          </ErrorDescription>\n        );\n      }\n\n      if (resultingTrove.collateralRatio(price).lt(originalTrove.collateralRatio(price))) {\n        return (\n          <ErrorDescription>\n            You're not allowed to decrease your collateral ratio during recovery mode.\n          </ErrorDescription>\n        );\n      }\n    }\n  } else {\n    if (resultingTrove.collateralRatioIsBelowMinimum(price)) {\n      return (\n        <ErrorDescription>\n          Collateral ratio must be at least <Amount>{mcrPercent}</Amount>.\n        </ErrorDescription>\n      );\n    }\n\n    if (wouldTriggerRecoveryMode) {\n      return (\n        <ErrorDescription>\n          The adjustment you're trying to make would cause the Total Collateral Ratio to fall below{\" \"}\n          <Amount>{ccrPercent}</Amount>. Please increase your Line of Credit's Collateral Ratio.\n        </ErrorDescription>\n      );\n    }\n  }\n\n  if (repayZUSD) {\n    if (resultingTrove.debt.lt(ZUSD_MINIMUM_DEBT)) {\n      return (\n        <ErrorDescription>\n          Total debt must be at least{\" \"}\n          <Amount>\n            {ZUSD_MINIMUM_DEBT.toString()} {useNueBalance ? COIN2 : COIN}\n          </Amount>\n          .\n        </ErrorDescription>\n      );\n    }\n\n    const repayBalance = useNueBalance ? nueBalance : zusdBalance;\n    if (repayZUSD?.gt(repayBalance)) {\n      return (\n        <ErrorDescription>\n          The amount you're trying to repay exceeds your balance by{\" \"}\n          <Amount>\n            {repayZUSD.sub(repayBalance).prettify()} {useNueBalance ? COIN2: COIN}\n          </Amount>\n          .\n        </ErrorDescription>\n      );\n    }\n  }\n\n  if (depositCollateral?.gt(accountBalance)) {\n    return (\n      <ErrorDescription>\n        The amount you're trying to deposit exceeds your balance by{\" \"}\n        <Amount>{depositCollateral.sub(accountBalance).prettify()} RBTC</Amount>.\n      </ErrorDescription>\n    );\n  }\n\n  return null;\n};\n\nconst validateTroveClosure = (\n  useNueBalance: Boolean,\n  { repayZUSD }: TroveClosureParams<Decimal>,\n  {\n    recoveryMode,\n    wouldTriggerRecoveryMode,\n    numberOfTroves,\n    nueBalance,\n    zusdBalance\n  }: TroveChangeValidationContext\n): JSX.Element | null => {\n  if (numberOfTroves === 1) {\n    return (\n      <ErrorDescription>\n        You're not allowed to close your Line of Credit when there are no other Lines of Credit in the system.\n      </ErrorDescription>\n    );\n  }\n\n  if (recoveryMode) {\n    return (\n      <ErrorDescription>\n        You're not allowed to close your Line of Credit during recovery mode.\n      </ErrorDescription>\n    );\n  }\n\n  const repayBalance = useNueBalance ? nueBalance : zusdBalance\n  if (repayZUSD?.gt(repayBalance)) {\n    return (\n      <ErrorDescription>\n        You need{\" \"}\n        <Amount>\n          {repayZUSD.sub(repayBalance).prettify()} {useNueBalance ? COIN2 : COIN}\n        </Amount>{\" \"}\n        more to close your Line of Credit.\n      </ErrorDescription>\n    );\n  }\n\n  if (wouldTriggerRecoveryMode) {\n    return (\n      <ErrorDescription>\n        You're not allowed to close a Line of Credit if it would cause the Total Collateralization Ratio to\n        fall below <Amount>{ccrPercent}</Amount>. Please wait until the Total Collateral Ratio\n        increases.\n      </ErrorDescription>\n    );\n  }\n\n  return null;\n};\n","import { useCallback, useMemo, useState } from \"react\";\nimport { COIN, COIN2 } from \"../strings\";\n\nexport const useNueTokenSelection = () => {\n  const [useNueToken, setUseNueToken] = useState(true);\n  const borrowedToken = useMemo(() => useNueToken ? COIN2 : COIN, [useNueToken]);\n\n  const handleSetNueToken = useCallback(() => {\n    setUseNueToken(!useNueToken);\n  }, [useNueToken]);\n\n  return {\n    useNueToken,\n    borrowedToken,\n    handleSetNueToken\n  };\n}\n","import { useCallback, useEffect } from \"react\";\nimport { Flex, Button } from \"theme-ui\";\n\nimport { LiquityStoreState, Decimal, Trove, Decimalish, ZUSD_MINIMUM_DEBT } from \"@liquity/lib-base\";\n\nimport { LiquityStoreUpdate, useLiquityReducer, useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { ActionDescription } from \"../ActionDescription\";\nimport { useMyTransactionState } from \"../Transaction\";\n\nimport { TroveEditor } from \"./TroveEditor\";\nimport { TroveAction } from \"./TroveAction\";\nimport { useTroveView } from \"./context/TroveViewContext\";\n\nimport {\n  selectForTroveChangeValidation,\n  validateTroveChange\n} from \"./validation/validateTroveChange\";\nimport { useNueTokenSelection } from \"../../hooks/useNueTokenSelection\";\n\nconst init = ({ trove }: LiquityStoreState) => ({\n  original: trove,\n  edited: new Trove(trove.collateral, trove.debt),\n  changePending: false,\n  debtDirty: false,\n  addedMinimumDebt: false\n});\n\ntype TroveManagerState = ReturnType<typeof init>;\ntype TroveManagerAction =\n  | LiquityStoreUpdate\n  | { type: \"startChange\" | \"finishChange\" | \"revert\" | \"addMinimumDebt\" | \"removeMinimumDebt\" }\n  | { type: \"setCollateral\" | \"setDebt\"; newValue: Decimalish };\n\nconst reduceWith = (action: TroveManagerAction) => (state: TroveManagerState): TroveManagerState =>\n  reduce(state, action);\n\nconst addMinimumDebt = reduceWith({ type: \"addMinimumDebt\" });\nconst removeMinimumDebt = reduceWith({ type: \"removeMinimumDebt\" });\nconst finishChange = reduceWith({ type: \"finishChange\" });\nconst revert = reduceWith({ type: \"revert\" });\n\nconst reduce = (state: TroveManagerState, action: TroveManagerAction): TroveManagerState => {\n  // console.log(state);\n  // console.log(action);\n\n  const { original, edited, changePending, debtDirty, addedMinimumDebt } = state;\n\n  switch (action.type) {\n    case \"startChange\": {\n      console.log(\"starting change\");\n      return { ...state, changePending: true };\n    }\n\n    case \"finishChange\":\n      return { ...state, changePending: false };\n\n    case \"setCollateral\": {\n      const newCollateral = Decimal.from(action.newValue);\n\n      const newState = {\n        ...state,\n        edited: edited.setCollateral(newCollateral)\n      };\n\n      if (!debtDirty) {\n        if (edited.isEmpty && newCollateral.nonZero) {\n          return addMinimumDebt(newState);\n        }\n        if (addedMinimumDebt && newCollateral.isZero) {\n          return removeMinimumDebt(newState);\n        }\n      }\n\n      return newState;\n    }\n\n    case \"setDebt\":\n      return {\n        ...state,\n        edited: edited.setDebt(action.newValue),\n        debtDirty: true\n      };\n\n    case \"addMinimumDebt\":\n      return {\n        ...state,\n        edited: edited.setDebt(ZUSD_MINIMUM_DEBT),\n        addedMinimumDebt: true\n      };\n\n    case \"removeMinimumDebt\":\n      return {\n        ...state,\n        edited: edited.setDebt(0),\n        addedMinimumDebt: false\n      };\n\n    case \"revert\":\n      return {\n        ...state,\n        edited: new Trove(original.collateral, original.debt),\n        debtDirty: false,\n        addedMinimumDebt: false\n      };\n\n    case \"updateStore\": {\n      const {\n        newState: { trove },\n        stateChange: { troveBeforeRedistribution: changeCommitted }\n      } = action;\n\n      const newState = {\n        ...state,\n        original: trove\n      };\n\n      if (changePending && changeCommitted) {\n        return finishChange(revert(newState));\n      }\n\n      const change = original.whatChanged(edited, 0);\n\n      if (\n        (change?.type === \"creation\" && !trove.isEmpty) ||\n        (change?.type === \"closure\" && trove.isEmpty)\n      ) {\n        return revert(newState);\n      }\n\n      return { ...newState, edited: trove.apply(change, 0) };\n    }\n  }\n};\n\nconst feeFrom = (original: Trove, edited: Trove, borrowingRate: Decimal): Decimal => {\n  const change = original.whatChanged(edited, borrowingRate);\n\n  if (change && change.type !== \"invalidCreation\" && change.params.borrowZUSD) {\n    return change.params.borrowZUSD.mul(borrowingRate);\n  } else {\n    return Decimal.ZERO;\n  }\n};\n\nconst select = (state: LiquityStoreState) => ({\n  fees: state.fees,\n  validationContext: selectForTroveChangeValidation(state)\n});\n\nconst transactionIdPrefix = \"trove-\";\nconst transactionIdMatcher = new RegExp(`^${transactionIdPrefix}`);\n\ntype TroveManagerProps = {\n  collateral?: Decimalish;\n  debt?: Decimalish;\n};\n\nexport const TroveManager: React.FC<TroveManagerProps> = ({ collateral, debt }) => {\n  const [{ original, edited, changePending }, dispatch] = useLiquityReducer(reduce, init);\n  const { fees, validationContext } = useLiquitySelector(select);\n  const { borrowedToken, handleSetNueToken, useNueToken } = useNueTokenSelection();\n\n  useEffect(() => {\n    if (collateral !== undefined) {\n      dispatch({ type: \"setCollateral\", newValue: collateral });\n    }\n    if (debt !== undefined) {\n      dispatch({ type: \"setDebt\", newValue: debt });\n    }\n  }, [collateral, debt, dispatch]);\n\n  const borrowingRate = fees.borrowingRate();\n  const maxBorrowingRate = borrowingRate.add(0.005); // TODO slippage tolerance\n\n  const [validChange, description] = validateTroveChange(\n    original,\n    edited,\n    borrowingRate,\n    useNueToken,\n    validationContext\n  );\n\n  const { dispatchEvent } = useTroveView();\n\n  const handleCancel = useCallback(() => {\n    dispatchEvent(\"CANCEL_ADJUST_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n\n  const openingNewTrove = original.isEmpty;\n\n  const myTransactionState = useMyTransactionState(transactionIdMatcher);\n\n  useEffect(() => {\n    if (\n      myTransactionState.type === \"waitingForApproval\" ||\n      myTransactionState.type === \"waitingForConfirmation\"\n    ) {\n      dispatch({ type: \"startChange\" });\n    } else if (myTransactionState.type === \"failed\" || myTransactionState.type === \"cancelled\") {\n      dispatch({ type: \"finishChange\" });\n    } else if (myTransactionState.type === \"confirmedOneShot\") {\n      if (myTransactionState.id === `${transactionIdPrefix}closure`) {\n        dispatchEvent(\"TROVE_CLOSED\");\n      } else {\n        dispatchEvent(\"TROVE_ADJUSTED\");\n      }\n    }\n  }, [myTransactionState, dispatch, dispatchEvent]);\n\n  return (\n    <TroveEditor\n      original={original}\n      edited={edited}\n      fee={feeFrom(original, edited, borrowingRate)}\n      borrowingRate={borrowingRate}\n      changePending={changePending}\n      borrowedToken={borrowedToken}\n      useNueToken={useNueToken}\n      handleSetNueToken={handleSetNueToken}\n      dispatch={dispatch}\n    >\n      {description ??\n        (openingNewTrove ? (\n          <ActionDescription>\n            Start by entering the amount of RBTC you'd like to deposit as collateral.\n          </ActionDescription>\n        ) : (\n          <ActionDescription>\n            Adjust your Line of Credit by modifying its collateral, debt, or both.\n          </ActionDescription>\n        ))}\n\n      <Flex variant=\"layout.actions\">\n        <Button variant=\"cancel\" onClick={handleCancel}>\n          Cancel\n        </Button>\n\n        {validChange ? (\n          <TroveAction\n            transactionId={`${transactionIdPrefix}${validChange.type}`}\n            change={validChange}\n            useNueToken={useNueToken}\n            maxBorrowingRate={maxBorrowingRate}\n          >\n            Confirm\n          </TroveAction>\n        ) : (\n          <Button disabled>Confirm</Button>\n        )}\n      </Flex>\n    </TroveEditor>\n  );\n};\n","import React, { useCallback } from \"react\";\nimport { Card, Heading, Box, Flex, Button } from \"theme-ui\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { DisabledEditableRow } from \"./Editor\";\nimport { useTroveView } from \"./context/TroveViewContext\";\nimport { Icon } from \"../Icon\";\nimport { COIN } from \"../../strings\";\nimport { CollateralRatio } from \"./CollateralRatio\";\n\nconst select = ({ trove, price }: LiquityStoreState) => ({ trove, price });\n\nexport const ReadOnlyTrove: React.FC = () => {\n  const { dispatchEvent } = useTroveView();\n  const handleAdjustTrove = useCallback(() => {\n    dispatchEvent(\"ADJUST_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n  const handleCloseTrove = useCallback(() => {\n    dispatchEvent(\"CLOSE_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n\n  const { trove, price } = useLiquitySelector(select);\n\n  // console.log(\"READONLY TROVE\", trove.collateral.prettify(4));\n  return (\n    <Card>\n      <Heading>Line of Credit</Heading>\n      <Box sx={{ p: [2, 3] }}>\n        <Box>\n          <DisabledEditableRow\n            label=\"Collateral\"\n            inputId=\"trove-collateral\"\n            amount={trove.collateral.prettify(4)}\n            unit=\"RBTC\"\n          />\n\n          <DisabledEditableRow\n            label=\"Debt\"\n            inputId=\"trove-debt\"\n            amount={trove.debt.prettify()}\n            unit={COIN}\n          />\n\n          <CollateralRatio value={trove.collateralRatio(price)} />\n        </Box>\n\n        <Flex variant=\"layout.actions\">\n          <Button variant=\"outline\" onClick={handleCloseTrove}>\n            Close Line of Credit\n          </Button>\n          <Button onClick={handleAdjustTrove}>\n            <Icon name=\"pen\" size=\"sm\" />\n            &nbsp;Adjust\n          </Button>\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import { Box, Flex, Heading, Text } from \"theme-ui\";\n\nimport { Icon } from \"./Icon\";\n\ntype InfoMessageProps = {\n  title: string;\n  icon?: React.ReactNode;\n};\n\nexport const InfoMessage: React.FC<InfoMessageProps> = ({ title, children, icon }) => (\n  <Box sx={{ mx: 1, mb: 3 }}>\n    <Flex sx={{ alignItems: \"center\", mb: \"10px\" }}>\n      <Box sx={{ mr: \"12px\", fontSize: \"20px\" }}>{icon || <Icon name=\"info-circle\" />}</Box>\n\n      <Heading as=\"h3\">{title}</Heading>\n    </Flex>\n\n    <Text sx={{ fontSize: 2 }}>{children}</Text>\n  </Box>\n);\n","import React, { useCallback } from \"react\";\nimport { Card, Heading, Box, Flex, Button } from \"theme-ui\";\nimport { InfoMessage } from \"../InfoMessage\";\nimport { useTroveView } from \"./context/TroveViewContext\";\n\nexport const NoTrove: React.FC = props => {\n  const { dispatchEvent } = useTroveView();\n\n  const handleOpenTrove = useCallback(() => {\n    dispatchEvent(\"OPEN_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n\n  return (\n    <Card>\n      <Heading>Line of Credit</Heading>\n      <Box sx={{ p: [2, 3] }}>\n        <InfoMessage title=\"You haven't borrowed any ZUSD yet.\">\n          You can borrow ZUSD by opening a Line of Credit.\n        </InfoMessage>\n\n        <Flex variant=\"layout.actions\">\n          <Button onClick={handleOpenTrove}>Open Line of Credit</Button>\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import React, { useCallback, useEffect, useState } from \"react\";\nimport { Flex, Button, Box, Card, Heading } from \"theme-ui\";\nimport {\n  LiquityStoreState,\n  Decimal,\n  Trove,\n  ZUSD_LIQUIDATION_RESERVE,\n  ZUSD_MINIMUM_NET_DEBT,\n  Percent\n} from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { ActionDescription } from \"../ActionDescription\";\nimport { useMyTransactionState } from \"../Transaction\";\nimport { TroveAction } from \"./TroveAction\";\nimport { useTroveView } from \"./context/TroveViewContext\";\nimport { Icon } from \"../Icon\";\nimport { InfoIcon } from \"../InfoIcon\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\nimport { CollateralRatio } from \"./CollateralRatio\";\nimport { EditableRow, StaticRow } from \"./Editor\";\nimport {\n  selectForTroveChangeValidation,\n  validateTroveChange\n} from \"./validation/validateTroveChange\";\nimport { NueCheckbox } from \"./NueCheckbox\";\nimport { useNueTokenSelection } from \"../../hooks/useNueTokenSelection\";\n\nconst selector = (state: LiquityStoreState) => {\n  const { fees, price, accountBalance } = state;\n  return {\n    fees,\n    price,\n    accountBalance,\n    validationContext: selectForTroveChangeValidation(state)\n  };\n};\n\nconst EMPTY_TROVE = new Trove(Decimal.ZERO, Decimal.ZERO);\nconst TRANSACTION_ID = \"trove-creation\";\nconst GAS_ROOM_ETH = Decimal.from(0.1);\n\nexport const Opening: React.FC = () => {\n  const { dispatchEvent } = useTroveView();\n  const { fees, price, accountBalance, validationContext } = useLiquitySelector(selector);\n  const borrowingRate = fees.borrowingRate();\n  const editingState = useState<string>();\n  const { borrowedToken, handleSetNueToken, useNueToken } = useNueTokenSelection();\n\n  const [collateral, setCollateral] = useState<Decimal>(Decimal.ZERO);\n  const [borrowAmount, setBorrowAmount] = useState<Decimal>(Decimal.ZERO);\n\n  const maxBorrowingRate = borrowingRate.add(0.005);\n\n  const fee = borrowAmount.mul(borrowingRate);\n  const feePct = new Percent(borrowingRate);\n  const totalDebt = borrowAmount.add(ZUSD_LIQUIDATION_RESERVE).add(fee);\n  const isDirty = !collateral.isZero || !borrowAmount.isZero;\n  const trove = isDirty ? new Trove(collateral, totalDebt) : EMPTY_TROVE;\n  const maxEth = accountBalance.gt(GAS_ROOM_ETH) ? accountBalance.sub(GAS_ROOM_ETH) : Decimal.ZERO;\n  const maxCollateral = collateral.add(maxEth);\n  const collateralMaxedOut = collateral.eq(maxCollateral);\n  const collateralRatio =\n    !collateral.isZero && !borrowAmount.isZero ? trove.collateralRatio(price) : undefined;\n\n  const [troveChange, description] = validateTroveChange(\n    EMPTY_TROVE,\n    trove,\n    borrowingRate,\n    useNueToken,\n    validationContext\n  );\n\n  const transactionState = useMyTransactionState(TRANSACTION_ID);\n  const isTransactionPending =\n    transactionState.type === \"waitingForApproval\" ||\n    transactionState.type === \"waitingForConfirmation\";\n\n  const handleCancelPressed = useCallback(() => {\n    dispatchEvent(\"CANCEL_ADJUST_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n\n  const reset = useCallback(() => {\n    setCollateral(Decimal.ZERO);\n    setBorrowAmount(Decimal.ZERO);\n  }, []);\n\n  useEffect(() => {\n    if (!collateral.isZero && borrowAmount.isZero) {\n      setBorrowAmount(ZUSD_MINIMUM_NET_DEBT);\n    }\n  }, [collateral, borrowAmount]);\n\n  return (\n    <Card>\n      <Heading>\n        Line of Credit\n        {isDirty && !isTransactionPending && (\n          <Button variant=\"titleIcon\" sx={{ \":enabled:hover\": { color: \"danger\" } }} onClick={reset}>\n            <Icon name=\"history\" size=\"lg\" />\n          </Button>\n        )}\n      </Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <EditableRow\n          label=\"Collateral\"\n          inputId=\"trove-collateral\"\n          amount={collateral.prettify(4)}\n          maxAmount={maxCollateral.toString()}\n          maxedOut={collateralMaxedOut}\n          editingState={editingState}\n          unit=\"RBTC\"\n          editedAmount={collateral.toString(4)}\n          setEditedAmount={(amount: string) => setCollateral(Decimal.from(amount))}\n        />\n        <NueCheckbox checked={useNueToken} onChange={handleSetNueToken} />\n\n        <EditableRow\n          label=\"Borrow\"\n          inputId=\"trove-borrow-amount\"\n          amount={borrowAmount.prettify()}\n          unit={borrowedToken}\n          editingState={editingState}\n          editedAmount={borrowAmount.toString(2)}\n          setEditedAmount={(amount: string) => setBorrowAmount(Decimal.from(amount))}\n        />\n\n        <StaticRow\n          label=\"Liquidation Reserve\"\n          inputId=\"trove-liquidation-reserve\"\n          amount={`${ZUSD_LIQUIDATION_RESERVE}`}\n          unit={borrowedToken}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"200px\" }}>\n                  An amount set aside to cover the liquidators gas costs if your Line of Credit needs to be\n                  liquidated. The amount increases your debt and is refunded if you close your Line of Credit\n                  by fully paying off its net debt.\n                </Card>\n              }\n            />\n          }\n        />\n\n        <StaticRow\n          label=\"Borrowing Fee\"\n          inputId=\"trove-borrowing-fee\"\n          amount={fee.prettify(2)}\n          pendingAmount={feePct.toString(2)}\n          unit={borrowedToken}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"240px\" }}>\n                  This amount is deducted from the borrowed amount as a one-time fee. There are no\n                  recurring fees for borrowing, which is thus interest-free.\n                </Card>\n              }\n            />\n          }\n        />\n\n        <StaticRow\n          label=\"Total debt\"\n          inputId=\"trove-total-debt\"\n          amount={totalDebt.prettify(2)}\n          unit={borrowedToken}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"240px\" }}>\n                  The total amount of {borrowedToken} your Line of Credit will hold.{\" \"}\n                  {isDirty && (\n                    <>\n                      You will need to repay {totalDebt.sub(ZUSD_LIQUIDATION_RESERVE).prettify(2)}{\" \"}\n                      {borrowedToken} to reclaim your collateral ({ZUSD_LIQUIDATION_RESERVE.toString()} ZUSD\n                      Liquidation Reserve excluded).\n                    </>\n                  )}\n                </Card>\n              }\n            />\n          }\n        />\n\n        <CollateralRatio value={collateralRatio} />\n\n        {description ?? (\n          <ActionDescription>\n            Start by entering the amount of RBTC you'd like to deposit as collateral.\n          </ActionDescription>\n        )}\n\n        <Flex variant=\"layout.actions\">\n          <Button variant=\"cancel\" onClick={handleCancelPressed}>\n            Cancel\n          </Button>\n\n          {troveChange ? (\n            <TroveAction\n              transactionId={TRANSACTION_ID}\n              change={troveChange}\n              useNueToken={useNueToken}\n              maxBorrowingRate={maxBorrowingRate}\n            >\n              Confirm\n            </TroveAction>\n          ) : (\n            <Button disabled>Confirm</Button>\n          )}\n        </Flex>\n      </Box>\n      {isTransactionPending && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import React, { useCallback, useEffect, useState, useRef } from \"react\";\nimport { Flex, Button, Box, Card, Heading } from \"theme-ui\";\nimport {\n  LiquityStoreState,\n  Decimal,\n  Trove,\n  ZUSD_LIQUIDATION_RESERVE,\n  Percent,\n  Difference\n} from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { ActionDescription } from \"../ActionDescription\";\nimport { useMyTransactionState } from \"../Transaction\";\nimport { TroveAction } from \"./TroveAction\";\nimport { useTroveView } from \"./context/TroveViewContext\";\nimport { Icon } from \"../Icon\";\nimport { InfoIcon } from \"../InfoIcon\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\nimport { CollateralRatio } from \"./CollateralRatio\";\nimport { EditableRow, StaticRow } from \"./Editor\";\nimport {\n  selectForTroveChangeValidation,\n  validateTroveChange\n} from \"./validation/validateTroveChange\";\nimport { useNueTokenSelection } from \"../../hooks/useNueTokenSelection\";\nimport { NueCheckbox } from \"./NueCheckbox\";\n\nconst selector = (state: LiquityStoreState) => {\n  const { trove, fees, price, accountBalance } = state;\n  return {\n    trove,\n    fees,\n    price,\n    accountBalance,\n    validationContext: selectForTroveChangeValidation(state)\n  };\n};\n\nconst TRANSACTION_ID = \"trove-adjustment\";\nconst GAS_ROOM_ETH = Decimal.from(0.1);\n\nconst feeFrom = (original: Trove, edited: Trove, borrowingRate: Decimal): Decimal => {\n  const change = original.whatChanged(edited, borrowingRate);\n\n  if (change && change.type !== \"invalidCreation\" && change.params.borrowZUSD) {\n    return change.params.borrowZUSD.mul(borrowingRate);\n  } else {\n    return Decimal.ZERO;\n  }\n};\n\nconst applyUnsavedCollateralChanges = (unsavedChanges: Difference, trove: Trove) => {\n  if (unsavedChanges.absoluteValue) {\n    if (unsavedChanges.positive) {\n      return trove.collateral.add(unsavedChanges.absoluteValue);\n    }\n    if (unsavedChanges.negative) {\n      if (unsavedChanges.absoluteValue.lt(trove.collateral)) {\n        return trove.collateral.sub(unsavedChanges.absoluteValue);\n      }\n    }\n    return trove.collateral;\n  }\n  return trove.collateral;\n};\n\nconst applyUnsavedNetDebtChanges = (unsavedChanges: Difference, trove: Trove) => {\n  if (unsavedChanges.absoluteValue) {\n    if (unsavedChanges.positive) {\n      return trove.netDebt.add(unsavedChanges.absoluteValue);\n    }\n    if (unsavedChanges.negative) {\n      if (unsavedChanges.absoluteValue.lt(trove.netDebt)) {\n        return trove.netDebt.sub(unsavedChanges.absoluteValue);\n      }\n    }\n    return trove.netDebt;\n  }\n  return trove.netDebt;\n};\n\nexport const Adjusting: React.FC = () => {\n  const { dispatchEvent } = useTroveView();\n  const { trove, fees, price, accountBalance, validationContext } = useLiquitySelector(selector);\n  const editingState = useState<string>();\n  const previousTrove = useRef<Trove>(trove);\n  const [collateral, setCollateral] = useState<Decimal>(trove.collateral);\n  const [netDebt, setNetDebt] = useState<Decimal>(trove.netDebt);\n  const { borrowedToken, handleSetNueToken, useNueToken } = useNueTokenSelection();\n\n  const transactionState = useMyTransactionState(TRANSACTION_ID);\n  const borrowingRate = fees.borrowingRate();\n\n  useEffect(() => {\n    if (transactionState.type === \"confirmedOneShot\") {\n      dispatchEvent(\"TROVE_ADJUSTED\");\n    }\n  }, [transactionState.type, dispatchEvent]);\n\n  useEffect(() => {\n    if (!previousTrove.current.collateral.eq(trove.collateral)) {\n      const unsavedChanges = Difference.between(collateral, previousTrove.current.collateral);\n      const nextCollateral = applyUnsavedCollateralChanges(unsavedChanges, trove);\n      setCollateral(nextCollateral);\n    }\n    if (!previousTrove.current.netDebt.eq(trove.netDebt)) {\n      const unsavedChanges = Difference.between(netDebt, previousTrove.current.netDebt);\n      const nextNetDebt = applyUnsavedNetDebtChanges(unsavedChanges, trove);\n      setNetDebt(nextNetDebt);\n    }\n    previousTrove.current = trove;\n  }, [trove, collateral, netDebt]);\n\n  const handleCancelPressed = useCallback(() => {\n    dispatchEvent(\"CANCEL_ADJUST_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n\n  const reset = useCallback(() => {\n    setCollateral(trove.collateral);\n    setNetDebt(trove.netDebt);\n  }, [trove.collateral, trove.netDebt]);\n\n  if (trove.status !== \"open\") {\n    return null;\n  }\n\n  const isDirty = !collateral.eq(trove.collateral) || !netDebt.eq(trove.netDebt);\n  const isDebtIncrease = netDebt.gt(trove.netDebt);\n  const debtIncreaseAmount = isDebtIncrease ? netDebt.sub(trove.netDebt) : Decimal.ZERO;\n\n  const fee = isDebtIncrease\n    ? feeFrom(trove, new Trove(trove.collateral, trove.debt.add(debtIncreaseAmount)), borrowingRate)\n    : Decimal.ZERO;\n  const totalDebt = netDebt.add(ZUSD_LIQUIDATION_RESERVE).add(fee);\n  const maxBorrowingRate = borrowingRate.add(0.005);\n  const updatedTrove = isDirty ? new Trove(collateral, totalDebt) : trove;\n  const feePct = new Percent(borrowingRate);\n  const maxEth = accountBalance.gt(GAS_ROOM_ETH) ? accountBalance.sub(GAS_ROOM_ETH) : Decimal.ZERO;\n  const maxCollateral = collateral.add(maxEth);\n  const collateralMaxedOut = collateral.eq(maxCollateral);\n  const collateralRatio =\n    !collateral.isZero && !netDebt.isZero ? updatedTrove.collateralRatio(price) : undefined;\n  const collateralRatioChange = Difference.between(collateralRatio, trove.collateralRatio(price));\n\n  const [troveChange, description] = validateTroveChange(\n    trove,\n    updatedTrove,\n    borrowingRate,\n    useNueToken,\n    validationContext\n  );\n\n  const isTransactionPending =\n    transactionState.type === \"waitingForApproval\" ||\n    transactionState.type === \"waitingForConfirmation\";\n\n  return (\n    <Card>\n      <Heading>\n        Line of Credit\n        {isDirty && !isTransactionPending && (\n          <Button variant=\"titleIcon\" sx={{ \":enabled:hover\": { color: \"danger\" } }} onClick={reset}>\n            <Icon name=\"history\" size=\"lg\" />\n          </Button>\n        )}\n      </Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <EditableRow\n          label=\"Collateral\"\n          inputId=\"trove-collateral\"\n          amount={collateral.prettify(4)}\n          maxAmount={maxCollateral.toString()}\n          maxedOut={collateralMaxedOut}\n          editingState={editingState}\n          unit=\"RBTC\"\n          editedAmount={collateral.toString(4)}\n          setEditedAmount={(amount: string) => setCollateral(Decimal.from(amount))}\n        />\n\n        <NueCheckbox checked={useNueToken} onChange={handleSetNueToken} />\n\n        <EditableRow\n          label=\"Net debt\"\n          inputId=\"trove-net-debt-amount\"\n          amount={netDebt.prettify()}\n          unit={borrowedToken}\n          editingState={editingState}\n          editedAmount={netDebt.toString(2)}\n          setEditedAmount={(amount: string) => setNetDebt(Decimal.from(amount))}\n        />\n\n        <StaticRow\n          label=\"Liquidation Reserve\"\n          inputId=\"trove-liquidation-reserve\"\n          amount={`${ZUSD_LIQUIDATION_RESERVE}`}\n          unit={borrowedToken}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"200px\" }}>\n                  An amount set aside to cover the liquidators gas costs if your Line of Credit needs to be\n                  liquidated. The amount increases your debt and is refunded if you close your Line of Credit\n                  by fully paying off its net debt.\n                </Card>\n              }\n            />\n          }\n        />\n\n        <StaticRow\n          label=\"Borrowing Fee\"\n          inputId=\"trove-borrowing-fee\"\n          amount={fee.prettify(2)}\n          pendingAmount={feePct.toString(2)}\n          unit={borrowedToken}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"240px\" }}>\n                  This amount is deducted from the borrowed amount as a one-time fee. There are no\n                  recurring fees for borrowing, which is thus interest-free.\n                </Card>\n              }\n            />\n          }\n        />\n\n        <StaticRow\n          label=\"Total debt\"\n          inputId=\"trove-total-debt\"\n          amount={totalDebt.prettify(2)}\n          unit={borrowedToken}\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ width: \"240px\" }}>\n                  The total amount of ZUSD your Line of Credit will hold.{\" \"}\n                  {isDirty && (\n                    <>\n                      You will need to repay {totalDebt.sub(ZUSD_LIQUIDATION_RESERVE).prettify(2)}{\" \"}\n                      ZUSD to reclaim your collateral ({ZUSD_LIQUIDATION_RESERVE.toString()} ZUSD\n                      Liquidation Reserve excluded).\n                    </>\n                  )}\n                </Card>\n              }\n            />\n          }\n        />\n\n        <CollateralRatio value={collateralRatio} change={collateralRatioChange} />\n\n        {description ?? (\n          <ActionDescription>\n            Adjust your Line of Credit by modifying its collateral, debt, or both.\n          </ActionDescription>\n        )}\n\n        <Flex variant=\"layout.actions\">\n          <Button variant=\"cancel\" onClick={handleCancelPressed}>\n            Cancel\n          </Button>\n\n          {troveChange ? (\n            <TroveAction\n              transactionId={TRANSACTION_ID}\n              change={troveChange}\n              useNueToken={useNueToken}\n              maxBorrowingRate={maxBorrowingRate}\n            >\n              Confirm\n            </TroveAction>\n          ) : (\n            <Button disabled>Confirm</Button>\n          )}\n        </Flex>\n      </Box>\n      {isTransactionPending && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import React, { useEffect } from \"react\";\nimport { Button, Flex, Spinner } from \"theme-ui\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"../hooks/LiquityContext\";\n\nimport { Transaction, useMyTransactionState } from \"./Transaction\";\nimport { useTroveView } from \"./Trove/context/TroveViewContext\";\n\nconst select = ({ collateralSurplusBalance }: LiquityStoreState) => ({\n  collateralSurplusBalance\n});\n\nexport const CollateralSurplusAction: React.FC = () => {\n  const { collateralSurplusBalance } = useLiquitySelector(select);\n  const {\n    liquity: { send: liquity }\n  } = useLiquity();\n\n  const myTransactionId = \"claim-coll-surplus\";\n  const myTransactionState = useMyTransactionState(myTransactionId);\n\n  const { dispatchEvent } = useTroveView();\n\n  useEffect(() => {\n    if (myTransactionState.type === \"confirmedOneShot\") {\n      dispatchEvent(\"TROVE_SURPLUS_COLLATERAL_CLAIMED\");\n    }\n  }, [myTransactionState.type, dispatchEvent]);\n\n  return myTransactionState.type === \"waitingForApproval\" ? (\n    <Flex variant=\"layout.actions\">\n      <Button disabled sx={{ mx: 2 }}>\n        <Spinner sx={{ mr: 2, color: \"white\" }} size=\"20px\" />\n        Waiting for your approval\n      </Button>\n    </Flex>\n  ) : myTransactionState.type !== \"waitingForConfirmation\" &&\n    myTransactionState.type !== \"confirmed\" ? (\n    <Flex variant=\"layout.actions\">\n      <Transaction\n        id={myTransactionId}\n        send={liquity.claimCollateralSurplus.bind(liquity, undefined)}\n      >\n        <Button sx={{ mx: 2 }}>Claim {collateralSurplusBalance.prettify()} RBTC</Button>\n      </Transaction>\n    </Flex>\n  ) : null;\n};\n","import React, { useCallback } from \"react\";\nimport { Card, Heading, Box, Button, Flex } from \"theme-ui\";\nimport { CollateralSurplusAction } from \"../CollateralSurplusAction\";\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { useTroveView } from \"./context/TroveViewContext\";\nimport { InfoMessage } from \"../InfoMessage\";\n\nconst select = ({ collateralSurplusBalance }: LiquityStoreState) => ({\n  hasSurplusCollateral: !collateralSurplusBalance.isZero\n});\n\nexport const RedeemedTrove: React.FC = () => {\n  const { hasSurplusCollateral } = useLiquitySelector(select);\n  const { dispatchEvent } = useTroveView();\n\n  const handleOpenTrove = useCallback(() => {\n    dispatchEvent(\"OPEN_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n\n  return (\n    <Card>\n      <Heading>Line of Credit</Heading>\n      <Box sx={{ p: [2, 3] }}>\n        <InfoMessage title=\"Your Line of Credit has been redeemed.\">\n          {hasSurplusCollateral\n            ? \"Please reclaim your remaining collateral before opening a new Line of Credit.\"\n            : \"You can borrow ZUSD by opening a new Line of Credit.\"}\n        </InfoMessage>\n\n        <Flex variant=\"layout.actions\">\n          {hasSurplusCollateral && <CollateralSurplusAction />}\n          {!hasSurplusCollateral && <Button onClick={handleOpenTrove}>Open Line of Credit</Button>}\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import React, { useCallback } from \"react\";\nimport { Card, Heading, Box, Button, Flex } from \"theme-ui\";\nimport { CollateralSurplusAction } from \"../CollateralSurplusAction\";\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { useTroveView } from \"./context/TroveViewContext\";\nimport { InfoMessage } from \"../InfoMessage\";\n\nconst select = ({ collateralSurplusBalance }: LiquityStoreState) => ({\n  hasSurplusCollateral: !collateralSurplusBalance.isZero\n});\n\nexport const LiquidatedTrove: React.FC = () => {\n  const { hasSurplusCollateral } = useLiquitySelector(select);\n  const { dispatchEvent } = useTroveView();\n\n  const handleOpenTrove = useCallback(() => {\n    dispatchEvent(\"OPEN_TROVE_PRESSED\");\n  }, [dispatchEvent]);\n\n  return (\n    <Card>\n      <Heading>Line of Credit</Heading>\n      <Box sx={{ p: [2, 3] }}>\n        <InfoMessage title=\"Your Line of Credit has been liquidated.\">\n          {hasSurplusCollateral\n            ? \"Please reclaim your remaining collateral before opening a new Line of Credit.\"\n            : \"You can borrow ZUSD by opening a new Line of Credit.\"}\n        </InfoMessage>\n\n        <Flex variant=\"layout.actions\">\n          {hasSurplusCollateral && <CollateralSurplusAction />}\n          {!hasSurplusCollateral && <Button onClick={handleOpenTrove}>Open Line of Credit</Button>}\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import React from \"react\";\nimport { TroveManager } from \"./TroveManager\";\nimport { ReadOnlyTrove } from \"./ReadOnlyTrove\";\nimport { NoTrove } from \"./NoTrove\";\nimport { Opening } from \"./Opening\";\nimport { Adjusting } from \"./Adjusting\";\nimport { RedeemedTrove } from \"./RedeemedTrove\";\nimport { useTroveView } from \"./context/TroveViewContext\";\nimport { LiquidatedTrove } from \"./LiquidatedTrove\";\nimport { Decimal } from \"@liquity/lib-base\";\n\nexport const Trove: React.FC = props => {\n  const { view } = useTroveView();\n\n  switch (view) {\n    // loading state not needed, as main app has a loading spinner that blocks render until the liquity backend data is available\n    case \"ACTIVE\": {\n      return <ReadOnlyTrove {...props} />;\n    }\n    case \"ADJUSTING\": {\n      return <Adjusting {...props} />;\n    }\n    case \"CLOSING\": {\n      return <TroveManager {...props} collateral={Decimal.ZERO} debt={Decimal.ZERO} />;\n    }\n    case \"OPENING\": {\n      return <Opening {...props} />;\n    }\n    case \"LIQUIDATED\": {\n      return <LiquidatedTrove {...props} />;\n    }\n    case \"REDEEMED\": {\n      return <RedeemedTrove {...props} />;\n    }\n    case \"NONE\": {\n      return <NoTrove {...props} />;\n    }\n  }\n};\n","import React, { useState } from \"react\";\nimport { Heading, Box, Card, Button } from \"theme-ui\";\n\nimport {\n  Decimal,\n  Decimalish,\n  StabilityDeposit,\n  LiquityStoreState,\n  Difference\n} from \"@liquity/lib-base\";\n\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { COIN, GT } from \"../../strings\";\n\nimport { Icon } from \"../Icon\";\nimport { EditableRow, StaticRow } from \"../Trove/Editor\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\nimport { InfoIcon } from \"../InfoIcon\";\n\nconst select = ({ zusdBalance, zusdInStabilityPool }: LiquityStoreState) => ({\n  zusdBalance,\n  zusdInStabilityPool\n});\n\ntype StabilityDepositEditorProps = {\n  originalDeposit: StabilityDeposit;\n  editedZUSD: Decimal;\n  changePending: boolean;\n  dispatch: (action: { type: \"setDeposit\"; newValue: Decimalish } | { type: \"revert\" }) => void;\n};\n\nexport const StabilityDepositEditor: React.FC<StabilityDepositEditorProps> = ({\n  originalDeposit,\n  editedZUSD,\n  changePending,\n  dispatch,\n  children\n}) => {\n  const { zusdBalance, zusdInStabilityPool } = useLiquitySelector(select);\n  const editingState = useState<string>();\n\n  const edited = !editedZUSD.eq(originalDeposit.currentZUSD);\n\n  const maxAmount = originalDeposit.currentZUSD.add(zusdBalance);\n  const maxedOut = editedZUSD.eq(maxAmount);\n\n  const zusdInStabilityPoolAfterChange = zusdInStabilityPool\n    .sub(originalDeposit.currentZUSD)\n    .add(editedZUSD);\n\n  const originalPoolShare = originalDeposit.currentZUSD.mulDiv(100, zusdInStabilityPool);\n  const newPoolShare = editedZUSD.mulDiv(100, zusdInStabilityPoolAfterChange);\n  const poolShareChange =\n    originalDeposit.currentZUSD.nonZero &&\n    Difference.between(newPoolShare, originalPoolShare).nonZero;\n\n  return (\n    <Card>\n      <Heading>\n        Stability Pool\n        {edited && !changePending && (\n          <Button\n            variant=\"titleIcon\"\n            sx={{ \":enabled:hover\": { color: \"danger\" } }}\n            onClick={() => dispatch({ type: \"revert\" })}\n          >\n            <Icon name=\"history\" size=\"lg\" />\n          </Button>\n        )}\n      </Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <EditableRow\n          label=\"Deposit\"\n          inputId=\"deposit-zero\"\n          amount={editedZUSD.prettify()}\n          maxAmount={maxAmount.toString()}\n          maxedOut={maxedOut}\n          unit={COIN}\n          {...{ editingState }}\n          editedAmount={editedZUSD.toString(2)}\n          setEditedAmount={newValue => dispatch({ type: \"setDeposit\", newValue })}\n        />\n\n        {newPoolShare.infinite ? (\n          <StaticRow label=\"Pool share\" inputId=\"deposit-share\" amount=\"N/A\" />\n        ) : (\n          <StaticRow\n            label=\"Pool share\"\n            inputId=\"deposit-share\"\n            amount={newPoolShare.prettify(4)}\n            pendingAmount={poolShareChange?.prettify(4).concat(\"%\")}\n            pendingColor={poolShareChange?.positive ? \"success\" : \"danger\"}\n            unit=\"%\"\n          />\n        )}\n\n        {!originalDeposit.isEmpty && (\n          <>\n            <StaticRow\n              label=\"Liquidation gain\"\n              inputId=\"deposit-gain\"\n              amount={originalDeposit.collateralGain.prettify(4)}\n              color={originalDeposit.collateralGain.nonZero && \"success\"}\n              unit=\"RBTC\"\n            />\n\n            <StaticRow\n              label=\"Reward\"\n              inputId=\"deposit-reward\"\n              amount={originalDeposit.zeroReward.prettify()}\n              color={originalDeposit.zeroReward.nonZero && \"success\"}\n              unit={GT}\n              infoIcon={\n                <InfoIcon\n                  tooltip={\n                    <Card variant=\"tooltip\" sx={{ width: \"240px\" }}>\n                      Although the ZERO rewards accrue every minute, the value on the UI only updates\n                      when a user transacts with the Stability Pool. Therefore you may receive more\n                      rewards than is displayed when you claim or adjust your deposit.\n                    </Card>\n                  }\n                />\n              }\n            />\n          </>\n        )}\n        {children}\n      </Box>\n\n      {changePending && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import { Button } from \"theme-ui\";\nimport { Decimal, LiquityStoreState, StabilityDepositChange } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"../../hooks/LiquityContext\";\nimport { useTransactionFunction } from \"../Transaction\";\n\ntype StabilityDepositActionProps = {\n  transactionId: string;\n  change: StabilityDepositChange<Decimal>;\n};\n\nconst selectFrontendRegistered = ({ frontend }: LiquityStoreState) =>\n  frontend.status === \"registered\";\n\nexport const StabilityDepositAction: React.FC<StabilityDepositActionProps> = ({\n  children,\n  transactionId,\n  change\n}) => {\n  const { config, liquity } = useLiquity();\n  const frontendRegistered = useLiquitySelector(selectFrontendRegistered);\n\n  const frontendTag = frontendRegistered ? config.frontendTag : undefined;\n\n  const [sendTransaction] = useTransactionFunction(\n    transactionId,\n    change.depositZUSD\n      ? liquity.send.depositZUSDInStabilityPool.bind(liquity.send, change.depositZUSD, frontendTag)\n      : liquity.send.withdrawZUSDFromStabilityPool.bind(liquity.send, change.withdrawZUSD)\n  );\n\n  return <Button onClick={sendTransaction}>{children}</Button>;\n};\n","import { createContext, useContext } from \"react\";\nimport type { StabilityView, StabilityEvent } from \"./types\";\n\ntype StabilityViewContextType = {\n  view: StabilityView;\n  dispatchEvent: (event: StabilityEvent) => void;\n};\n\nexport const StabilityViewContext = createContext<StabilityViewContextType | null>(null);\n\nexport const useStabilityView = (): StabilityViewContextType => {\n  const context: StabilityViewContextType | null = useContext(StabilityViewContext);\n\n  if (context === null) {\n    throw new Error(\"You must add a <StabilityViewProvider> into the React tree\");\n  }\n\n  return context;\n};\n","import React from \"react\";\n\nimport { Decimal, StabilityDeposit, StabilityDepositChange } from \"@liquity/lib-base\";\n\nimport { COIN, GT } from \"../../strings\";\nimport { ActionDescription, Amount } from \"../ActionDescription\";\n\ntype StabilityActionDescriptionProps = {\n  originalDeposit: StabilityDeposit;\n  change: StabilityDepositChange<Decimal>;\n};\n\nexport const StabilityActionDescription: React.FC<StabilityActionDescriptionProps> = ({\n  originalDeposit,\n  change\n}) => {\n  const collateralGain = originalDeposit.collateralGain.nonZero?.prettify(4).concat(\" RBTC\");\n  const zeroReward = originalDeposit.zeroReward.nonZero?.prettify().concat(\" \", GT);\n\n  return (\n    <ActionDescription>\n      {change.depositZUSD ? (\n        <>\n          You are depositing{\" \"}\n          <Amount>\n            {change.depositZUSD.prettify()} {COIN}\n          </Amount>{\" \"}\n          in the Stability Pool\n        </>\n      ) : (\n        <>\n          You are withdrawing{\" \"}\n          <Amount>\n            {change.withdrawZUSD.prettify()} {COIN}\n          </Amount>{\" \"}\n          to your wallet\n        </>\n      )}\n      {(collateralGain || zeroReward) && (\n        <>\n          {\" \"}\n          and claiming at least{\" \"}\n          {collateralGain && zeroReward ? (\n            <>\n              <Amount>{collateralGain}</Amount> and <Amount>{zeroReward}</Amount>\n            </>\n          ) : (\n            <Amount>{collateralGain ?? zeroReward}</Amount>\n          )}\n        </>\n      )}\n      .\n    </ActionDescription>\n  );\n};\n","import {\n  Decimal,\n  LiquityStoreState,\n  StabilityDeposit,\n  StabilityDepositChange\n} from \"@liquity/lib-base\";\n\nimport { COIN } from \"../../../strings\";\nimport { Amount } from \"../../ActionDescription\";\nimport { ErrorDescription } from \"../../ErrorDescription\";\nimport { StabilityActionDescription } from \"../StabilityActionDescription\";\n\nexport const selectForStabilityDepositChangeValidation = ({\n  trove,\n  zusdBalance,\n  ownFrontend,\n  haveUndercollateralizedTroves\n}: LiquityStoreState) => ({\n  trove,\n  zusdBalance,\n  haveOwnFrontend: ownFrontend.status === \"registered\",\n  haveUndercollateralizedTroves\n});\n\ntype StabilityDepositChangeValidationContext = ReturnType<\n  typeof selectForStabilityDepositChangeValidation\n>;\n\nexport const validateStabilityDepositChange = (\n  originalDeposit: StabilityDeposit,\n  editedZUSD: Decimal,\n  {\n    zusdBalance,\n    haveOwnFrontend,\n    haveUndercollateralizedTroves\n  }: StabilityDepositChangeValidationContext\n): [\n  validChange: StabilityDepositChange<Decimal> | undefined,\n  description: JSX.Element | undefined\n] => {\n  const change = originalDeposit.whatChanged(editedZUSD);\n\n  if (haveOwnFrontend) {\n    return [\n      undefined,\n      <ErrorDescription>\n        You cant deposit using a wallet address that is registered as a frontend.\n      </ErrorDescription>\n    ];\n  }\n\n  if (!change) {\n    return [undefined, undefined];\n  }\n\n  if (change.depositZUSD?.gt(zusdBalance)) {\n    return [\n      undefined,\n      <ErrorDescription>\n        The amount you're trying to deposit exceeds your balance by{\" \"}\n        <Amount>\n          {change.depositZUSD.sub(zusdBalance).prettify()} {COIN}\n        </Amount>\n        .\n      </ErrorDescription>\n    ];\n  }\n\n  if (change.withdrawZUSD && haveUndercollateralizedTroves) {\n    return [\n      undefined,\n      <ErrorDescription>\n        You're not allowed to withdraw ZUSD from your Stability Deposit when there are\n        undercollateralized Credit Lines. Please liquidate those Credit Lines or try again later.\n      </ErrorDescription>\n    ];\n  }\n\n  return [change, <StabilityActionDescription originalDeposit={originalDeposit} change={change} />];\n};\n","import React, { useCallback, useEffect } from \"react\";\nimport { Button, Flex } from \"theme-ui\";\n\nimport { Decimal, Decimalish, LiquityStoreState } from \"@liquity/lib-base\";\nimport { LiquityStoreUpdate, useLiquityReducer, useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { COIN } from \"../../strings\";\n\nimport { ActionDescription } from \"../ActionDescription\";\nimport { useMyTransactionState } from \"../Transaction\";\n\nimport { StabilityDepositEditor } from \"./StabilityDepositEditor\";\nimport { StabilityDepositAction } from \"./StabilityDepositAction\";\nimport { useStabilityView } from \"./context/StabilityViewContext\";\nimport {\n  selectForStabilityDepositChangeValidation,\n  validateStabilityDepositChange\n} from \"./validation/validateStabilityDepositChange\";\n\nconst init = ({ stabilityDeposit }: LiquityStoreState) => ({\n  originalDeposit: stabilityDeposit,\n  editedZUSD: stabilityDeposit.currentZUSD,\n  changePending: false\n});\n\ntype StabilityDepositManagerState = ReturnType<typeof init>;\ntype StabilityDepositManagerAction =\n  | LiquityStoreUpdate\n  | { type: \"startChange\" | \"finishChange\" | \"revert\" }\n  | { type: \"setDeposit\"; newValue: Decimalish };\n\nconst reduceWith = (action: StabilityDepositManagerAction) => (\n  state: StabilityDepositManagerState\n): StabilityDepositManagerState => reduce(state, action);\n\nconst finishChange = reduceWith({ type: \"finishChange\" });\nconst revert = reduceWith({ type: \"revert\" });\n\nconst reduce = (\n  state: StabilityDepositManagerState,\n  action: StabilityDepositManagerAction\n): StabilityDepositManagerState => {\n  // console.log(state);\n  // console.log(action);\n\n  const { originalDeposit, editedZUSD, changePending } = state;\n\n  switch (action.type) {\n    case \"startChange\": {\n      console.log(\"changeStarted\");\n      return { ...state, changePending: true };\n    }\n\n    case \"finishChange\":\n      return { ...state, changePending: false };\n\n    case \"setDeposit\":\n      return { ...state, editedZUSD: Decimal.from(action.newValue) };\n\n    case \"revert\":\n      return { ...state, editedZUSD: originalDeposit.currentZUSD };\n\n    case \"updateStore\": {\n      const {\n        stateChange: { stabilityDeposit: updatedDeposit }\n      } = action;\n\n      if (!updatedDeposit) {\n        return state;\n      }\n\n      const newState = { ...state, originalDeposit: updatedDeposit };\n\n      const changeCommitted =\n        !updatedDeposit.initialZUSD.eq(originalDeposit.initialZUSD) ||\n        updatedDeposit.currentZUSD.gt(originalDeposit.currentZUSD) ||\n        updatedDeposit.collateralGain.lt(originalDeposit.collateralGain) ||\n        updatedDeposit.zeroReward.lt(originalDeposit.zeroReward);\n\n      if (changePending && changeCommitted) {\n        return finishChange(revert(newState));\n      }\n\n      return {\n        ...newState,\n        editedZUSD: updatedDeposit.apply(originalDeposit.whatChanged(editedZUSD))\n      };\n    }\n  }\n};\n\nconst transactionId = \"stability-deposit\";\n\nexport const StabilityDepositManager: React.FC = () => {\n  const [{ originalDeposit, editedZUSD, changePending }, dispatch] = useLiquityReducer(reduce, init);\n  const validationContext = useLiquitySelector(selectForStabilityDepositChangeValidation);\n  const { dispatchEvent } = useStabilityView();\n\n  const handleCancel = useCallback(() => {\n    dispatchEvent(\"CANCEL_PRESSED\");\n  }, [dispatchEvent]);\n\n  const [validChange, description] = validateStabilityDepositChange(\n    originalDeposit,\n    editedZUSD,\n    validationContext\n  );\n\n  const makingNewDeposit = originalDeposit.isEmpty;\n\n  const myTransactionState = useMyTransactionState(transactionId);\n\n  useEffect(() => {\n    if (\n      myTransactionState.type === \"waitingForApproval\" ||\n      myTransactionState.type === \"waitingForConfirmation\"\n    ) {\n      dispatch({ type: \"startChange\" });\n    } else if (myTransactionState.type === \"failed\" || myTransactionState.type === \"cancelled\") {\n      dispatch({ type: \"finishChange\" });\n    } else if (myTransactionState.type === \"confirmedOneShot\") {\n      dispatchEvent(\"DEPOSIT_CONFIRMED\");\n    }\n  }, [myTransactionState.type, dispatch, dispatchEvent]);\n\n  return (\n    <StabilityDepositEditor\n      originalDeposit={originalDeposit}\n      editedZUSD={editedZUSD}\n      changePending={changePending}\n      dispatch={dispatch}\n    >\n      {description ??\n        (makingNewDeposit ? (\n          <ActionDescription>Enter the amount of {COIN} you'd like to deposit.</ActionDescription>\n        ) : (\n          <ActionDescription>Adjust the {COIN} amount to deposit or withdraw.</ActionDescription>\n        ))}\n\n      <Flex variant=\"layout.actions\">\n        <Button variant=\"cancel\" onClick={handleCancel}>\n          Cancel\n        </Button>\n\n        {validChange ? (\n          <StabilityDepositAction transactionId={transactionId} change={validChange}>\n            Confirm\n          </StabilityDepositAction>\n        ) : (\n          <Button disabled>Confirm</Button>\n        )}\n      </Flex>\n    </StabilityDepositEditor>\n  );\n};\n","import React from \"react\";\nimport { Button } from \"theme-ui\";\nimport { useLiquity } from \"../../../hooks/LiquityContext\";\nimport { useTransactionFunction } from \"../../Transaction\";\n\ntype ClaimAndMoveProps = {\n  disabled?: boolean;\n};\n\nexport const ClaimAndMove: React.FC<ClaimAndMoveProps> = ({ disabled, children }) => {\n  const { liquity } = useLiquity();\n\n  const [sendTransaction] = useTransactionFunction(\n    \"stability-deposit\",\n    liquity.send.transferCollateralGainToTrove.bind(liquity.send)\n  );\n\n  return (\n    <Button\n      variant=\"outline\"\n      sx={{ mt: 3, width: \"100%\" }}\n      onClick={sendTransaction}\n      disabled={disabled}\n    >\n      {children}\n    </Button>\n  );\n};\n","import React from \"react\";\nimport { Button } from \"theme-ui\";\n\nimport { useLiquity } from \"../../../hooks/LiquityContext\";\nimport { useTransactionFunction } from \"../../Transaction\";\n\ntype ClaimRewardsProps = {\n  disabled?: boolean;\n};\n\nexport const ClaimRewards: React.FC<ClaimRewardsProps> = ({ disabled, children }) => {\n  const { liquity } = useLiquity();\n\n  const [sendTransaction] = useTransactionFunction(\n    \"stability-deposit\",\n    liquity.send.withdrawGainsFromStabilityPool.bind(liquity.send)\n  );\n\n  return (\n    <Button onClick={sendTransaction} disabled={disabled}>\n      {children}\n    </Button>\n  );\n};\n","import React from \"react\";\nimport { Flex } from \"theme-ui\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nconst selector = ({ remainingStabilityPoolZEROReward }: LiquityStoreState) => ({\n  remainingStabilityPoolZEROReward\n});\n\nexport const RemainingZERO: React.FC = () => {\n  const { remainingStabilityPoolZEROReward } = useLiquitySelector(selector);\n\n  return (\n    <Flex sx={{ mr: 2, fontSize: 2, fontWeight: \"medium\" }}>\n      {remainingStabilityPoolZEROReward.prettify(0)} ZERO remaining\n    </Flex>\n  );\n};\n","import React from \"react\";\nimport { Flex } from \"theme-ui\";\n\nexport const Badge: React.FC = ({ children }) => {\n  return <Flex variant=\"layout.badge\">{children}</Flex>;\n};\n","import { Decimal } from \"@liquity/lib-base\";\n\ntype UniswapResponse = {\n  data?: {\n    bundle: {\n      ethPrice: string;\n    } | null;\n    token: {\n      derivedETH: string;\n    } | null;\n  };\n  errors?: Array<{ message: string }>;\n};\n\nconst uniswapQuery = (zeroTokenAddress: string) => `{\n  token(id: \"${zeroTokenAddress.toLowerCase()}\") {\n    derivedETH\n  },\n  bundle(id: 1) {\n    ethPrice\n  },\n}`;\n\nexport async function fetchZeroPrice(zeroTokenAddress: string) {\n  const response = await window.fetch(\"https://api.thegraph.com/subgraphs/name/uniswap/uniswap-v2\", {\n    method: \"POST\",\n    headers: {\n      \"content-type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      query: uniswapQuery(zeroTokenAddress),\n      variables: null\n    })\n  });\n  if (!response.ok) {\n    return Promise.reject(\"Network error connecting to Uniswap subgraph\");\n  }\n\n  const { data, errors }: UniswapResponse = await response.json();\n\n  if (errors) {\n    return Promise.reject(errors);\n  }\n\n  if (typeof data?.token?.derivedETH === \"string\" && typeof data?.bundle?.ethPrice === \"string\") {\n    const ethPriceUSD = Decimal.from(data.bundle.ethPrice);\n    const zeroPriceUSD = Decimal.from(data.token.derivedETH).mul(ethPriceUSD);\n\n    return { zeroPriceUSD };\n  }\n\n  return Promise.reject(\"Uniswap doesn't have the required data to calculate yield\");\n}\n","import React, { useEffect, useState } from \"react\";\nimport { Card, Paragraph, Text } from \"theme-ui\";\nimport { Decimal, LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { InfoIcon } from \"../InfoIcon\";\nimport { useLiquity } from \"../../hooks/LiquityContext\";\nimport { Badge } from \"../Badge\";\nimport { fetchZeroPrice } from \"./context/fetchZeroPrice\";\n\nconst selector = ({ zusdInStabilityPool, remainingStabilityPoolZEROReward }: LiquityStoreState) => ({\n  zusdInStabilityPool,\n  remainingStabilityPoolZEROReward\n});\n\nexport const Yield: React.FC = () => {\n  const {\n    liquity: {\n      connection: { addresses }\n    }\n  } = useLiquity();\n  const { zusdInStabilityPool, remainingStabilityPoolZEROReward } = useLiquitySelector(selector);\n\n  const [zeroPrice, setZeroPrice] = useState<Decimal | undefined>(undefined);\n  const hasZeroValue = remainingStabilityPoolZEROReward.isZero || zusdInStabilityPool.isZero;\n  const zeroTokenAddress = addresses[\"zeroToken\"];\n\n  useEffect(() => {\n    (async () => {\n      try {\n        const { zeroPriceUSD } = await fetchZeroPrice(zeroTokenAddress);\n        setZeroPrice(zeroPriceUSD);\n      } catch (error) {\n        console.error(error);\n      }\n    })();\n  }, [zeroTokenAddress]);\n\n  if (hasZeroValue || zeroPrice === undefined) return null;\n\n  const yearlyHalvingSchedule = 0.5; // 50% see ZERO distribution schedule for more info\n  const remainingZeroOneYear = remainingStabilityPoolZEROReward.mul(yearlyHalvingSchedule);\n  const remainingZeroOneYearInUSD = remainingZeroOneYear.mul(zeroPrice);\n  const aprPercentage = remainingZeroOneYearInUSD.div(zusdInStabilityPool).mul(100);\n  const remainingZeroInUSD = remainingStabilityPoolZEROReward.mul(zeroPrice);\n\n  if (aprPercentage.isZero) return null;\n\n  return (\n    <Badge>\n      <Text>ZERO APR {aprPercentage.toString(2)}%</Text>\n      <InfoIcon\n        tooltip={\n          <Card variant=\"tooltip\" sx={{ width: [\"220px\", \"518px\"] }}>\n            <Paragraph>\n              An <Text sx={{ fontWeight: \"bold\" }}>estimate</Text> of the ZERO return on the ZUSD\n              deposited to the Stability Pool over the next year, not including your RBTC gains from\n              liquidations.\n            </Paragraph>\n            <Paragraph sx={{ fontSize: \"12px\", fontFamily: \"monospace\", mt: 2 }}>\n              (($ZERO_REWARDS * YEARLY_DISTRIBUTION%) / DEPOSITED_ZUSD) * 100 ={\" \"}\n              <Text sx={{ fontWeight: \"bold\" }}> APR</Text>\n            </Paragraph>\n            <Paragraph sx={{ fontSize: \"12px\", fontFamily: \"monospace\" }}>\n              ($\n              {remainingZeroInUSD.shorten()} * 50% / ${zusdInStabilityPool.shorten()}) * 100 =\n              <Text sx={{ fontWeight: \"bold\" }}> {aprPercentage.toString(2)}%</Text>\n            </Paragraph>\n          </Card>\n        }\n      ></InfoIcon>\n    </Badge>\n  );\n};\n","import React, { useCallback, useEffect } from \"react\";\nimport { Card, Heading, Box, Flex, Button } from \"theme-ui\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { COIN, GT } from \"../../strings\";\nimport { Icon } from \"../Icon\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\nimport { useMyTransactionState } from \"../Transaction\";\nimport { DisabledEditableRow, StaticRow } from \"../Trove/Editor\";\nimport { ClaimAndMove } from \"./actions/ClaimAndMove\";\nimport { ClaimRewards } from \"./actions/ClaimRewards\";\nimport { useStabilityView } from \"./context/StabilityViewContext\";\nimport { RemainingZERO } from \"./RemainingZERO\";\nimport { Yield } from \"./Yield\";\nimport { InfoIcon } from \"../InfoIcon\";\n\nconst selector = ({ stabilityDeposit, trove, zusdInStabilityPool }: LiquityStoreState) => ({\n  stabilityDeposit,\n  trove,\n  zusdInStabilityPool\n});\n\nexport const ActiveDeposit: React.FC = () => {\n  const { dispatchEvent } = useStabilityView();\n  const { stabilityDeposit, trove, zusdInStabilityPool } = useLiquitySelector(selector);\n\n  const poolShare = stabilityDeposit.currentZUSD.mulDiv(100, zusdInStabilityPool);\n\n  const handleAdjustDeposit = useCallback(() => {\n    dispatchEvent(\"ADJUST_DEPOSIT_PRESSED\");\n  }, [dispatchEvent]);\n\n  const hasReward = !stabilityDeposit.zeroReward.isZero;\n  const hasGain = !stabilityDeposit.collateralGain.isZero;\n  const hasTrove = !trove.isEmpty;\n\n  const transactionId = \"stability-deposit\";\n  const transactionState = useMyTransactionState(transactionId);\n  const isWaitingForTransaction =\n    transactionState.type === \"waitingForApproval\" ||\n    transactionState.type === \"waitingForConfirmation\";\n\n  useEffect(() => {\n    if (transactionState.type === \"confirmedOneShot\") {\n      dispatchEvent(\"REWARDS_CLAIMED\");\n    }\n  }, [transactionState.type, dispatchEvent]);\n\n  return (\n    <Card>\n      <Heading>\n        Stability Pool\n        {!isWaitingForTransaction && (\n          <Flex sx={{ justifyContent: \"flex-end\" }}>\n            <RemainingZERO />\n          </Flex>\n        )}\n      </Heading>\n      <Box sx={{ p: [2, 3] }}>\n        <Box>\n          <DisabledEditableRow\n            label=\"Deposit\"\n            inputId=\"deposit-zusd\"\n            amount={stabilityDeposit.currentZUSD.prettify()}\n            unit={COIN}\n          />\n\n          <StaticRow\n            label=\"Pool share\"\n            inputId=\"deposit-share\"\n            amount={poolShare.prettify(4)}\n            unit=\"%\"\n          />\n\n          <StaticRow\n            label=\"Liquidation gain\"\n            inputId=\"deposit-gain\"\n            amount={stabilityDeposit.collateralGain.prettify(4)}\n            color={stabilityDeposit.collateralGain.nonZero && \"success\"}\n            unit=\"RBTC\"\n          />\n\n          <Flex sx={{ alignItems: \"center\" }}>\n            <StaticRow\n              label=\"Reward\"\n              inputId=\"deposit-reward\"\n              amount={stabilityDeposit.zeroReward.prettify()}\n              color={stabilityDeposit.zeroReward.nonZero && \"success\"}\n              unit={GT}\n              infoIcon={\n                <InfoIcon\n                  tooltip={\n                    <Card variant=\"tooltip\" sx={{ width: \"240px\" }}>\n                      Although the ZERO rewards accrue every minute, the value on the UI only updates\n                      when a user transacts with the Stability Pool. Therefore you may receive more\n                      rewards than is displayed when you claim or adjust your deposit.\n                    </Card>\n                  }\n                />\n              }\n            />\n            <Flex sx={{ justifyContent: \"flex-end\", flex: 1 }}>\n              <Yield />\n            </Flex>\n          </Flex>\n        </Box>\n\n        <Flex variant=\"layout.actions\">\n          <Button variant=\"outline\" onClick={handleAdjustDeposit}>\n            <Icon name=\"pen\" size=\"sm\" />\n            &nbsp;Adjust\n          </Button>\n\n          <ClaimRewards disabled={!hasGain && !hasReward}>Claim RBTC and ZERO</ClaimRewards>\n        </Flex>\n\n        {hasTrove && (\n          <ClaimAndMove disabled={!hasGain}>Claim ZERO and move RBTC to Line of Credit</ClaimAndMove>\n        )}\n      </Box>\n\n      {isWaitingForTransaction && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import React, { useCallback } from \"react\";\nimport { Card, Heading, Box, Flex, Button } from \"theme-ui\";\nimport { InfoMessage } from \"../InfoMessage\";\nimport { useStabilityView } from \"./context/StabilityViewContext\";\nimport { RemainingZERO } from \"./RemainingZERO\";\nimport { Yield } from \"./Yield\";\n\nexport const NoDeposit: React.FC = props => {\n  const { dispatchEvent } = useStabilityView();\n\n  const handleOpenTrove = useCallback(() => {\n    dispatchEvent(\"DEPOSIT_PRESSED\");\n  }, [dispatchEvent]);\n\n  return (\n    <Card>\n      <Heading>\n        Stability Pool\n        <Flex sx={{ justifyContent: \"flex-end\" }}>\n          <RemainingZERO />\n        </Flex>\n      </Heading>\n      <Box sx={{ p: [2, 3] }}>\n        <InfoMessage title=\"You have no ZUSD in the Stability Pool.\">\n          You can earn RBTC and ZERO rewards by depositing ZUSD.\n        </InfoMessage>\n\n        <Flex variant=\"layout.actions\">\n          <Flex sx={{ justifyContent: \"flex-start\", flex: 1, alignItems: \"center\" }}>\n            <Yield />\n          </Flex>\n          <Button onClick={handleOpenTrove}>Deposit</Button>\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import React from \"react\";\nimport { StabilityDepositManager } from \"./StabilityDepositManager\";\nimport { ActiveDeposit } from \"./ActiveDeposit\";\nimport { NoDeposit } from \"./NoDeposit\";\nimport { useStabilityView } from \"./context/StabilityViewContext\";\n\nexport const Stability: React.FC = props => {\n  const { view } = useStabilityView();\n\n  switch (view) {\n    case \"NONE\": {\n      return <NoDeposit {...props} />;\n    }\n    case \"DEPOSITING\": {\n      return <StabilityDepositManager {...props} />;\n    }\n    case \"ADJUSTING\": {\n      return <StabilityDepositManager {...props} />;\n    }\n    case \"ACTIVE\": {\n      return <ActiveDeposit {...props} />;\n    }\n  }\n};\n","import React, { useState, useEffect } from \"react\";\nimport { Card, Box, Heading, Flex, Button, Label, Input } from \"theme-ui\";\n\nimport { Decimal, LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"../hooks/LiquityContext\";\n\nimport { Icon } from \"./Icon\";\nimport { Transaction } from \"./Transaction\";\n\nconst selectPrice = ({ price }: LiquityStoreState) => price;\n\nexport const PriceManager: React.FC = () => {\n  const {\n    liquity: {\n      send: liquity,\n      connection: { _priceFeedIsTestnet: canSetPrice }\n    }\n  } = useLiquity();\n\n  const price = useLiquitySelector(selectPrice);\n  const [editedPrice, setEditedPrice] = useState(price.toString(2));\n\n  useEffect(() => {\n    setEditedPrice(price.toString(2));\n  }, [price]);\n\n  return (\n    <Card>\n      <Heading>Price feed</Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <Flex sx={{ alignItems: \"stretch\" }}>\n          <Label>RBTC</Label>\n\n          <Label variant=\"unit\" color=\"primary\" backgroundColor=\"background\">$</Label>\n\n          <Input\n            type={canSetPrice ? \"number\" : \"text\"}\n            step=\"any\"\n            value={editedPrice}\n            onChange={e => setEditedPrice(e.target.value)}\n            disabled={!canSetPrice}\n          />\n\n          {canSetPrice && (\n            <Flex sx={{ ml: 2, alignItems: \"center\" }}>\n              <Transaction\n                id=\"set-price\"\n                tooltip=\"Set\"\n                tooltipPlacement=\"bottom\"\n                send={overrides => {\n                  if (!editedPrice) {\n                    throw new Error(\"Invalid price\");\n                  }\n                  return liquity.setPrice(Decimal.from(editedPrice), overrides);\n                }}\n              >\n                <Button variant=\"icon\">\n                  <Icon name=\"chart-line\" size=\"lg\" />\n                </Button>\n              </Transaction>\n            </Flex>\n          )}\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import { createContext, useContext } from \"react\";\n\nexport type StakingView = \"ACTIVE\" | \"ADJUSTING\" | \"NONE\";\n\nexport type StakingViewAction = { type: \"startAdjusting\" | \"cancelAdjusting\" };\n\nexport type StakingViewContextType = {\n  view: StakingView;\n\n  // Indicates that a staking TX is pending.\n  // The panel should be covered with a spinner overlay when this is true.\n  changePending: boolean;\n\n  // Dispatch an action that changes the Staking panel's view.\n  dispatch: (action: StakingViewAction) => void;\n};\n\nexport const StakingViewContext = createContext<StakingViewContextType | null>(null);\n\nexport const useStakingView = (): StakingViewContextType => {\n  const context = useContext(StakingViewContext);\n\n  if (context === null) {\n    throw new Error(\"You must add a <TroveViewProvider> into the React tree\");\n  }\n\n  return context;\n};\n","import { Button } from \"theme-ui\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"../../hooks/LiquityContext\";\nimport { useTransactionFunction } from \"../Transaction\";\n\nconst selectZEROStake = ({ zeroStake }: LiquityStoreState) => zeroStake;\n\nexport const StakingGainsAction: React.FC = () => {\n  const { liquity } = useLiquity();\n  const { collateralGain, zusdGain } = useLiquitySelector(selectZEROStake);\n\n  const [sendTransaction] = useTransactionFunction(\n    \"stake\",\n    liquity.send.withdrawGainsFromStaking.bind(liquity.send)\n  );\n\n  return (\n    <Button onClick={sendTransaction} disabled={collateralGain.isZero && zusdGain.isZero}>\n      Claim gains\n    </Button>\n  );\n};\n","import { Heading, Box, Card, Flex, Button } from \"theme-ui\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { COIN, GT } from \"../../strings\";\n\nimport { DisabledEditableRow, StaticRow } from \"../Trove/Editor\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\nimport { Icon } from \"../Icon\";\n\nimport { useStakingView } from \"./context/StakingViewContext\";\nimport { StakingGainsAction } from \"./StakingGainsAction\";\n\nconst select = ({ zeroStake, totalStakedZERO }: LiquityStoreState) => ({\n  zeroStake,\n  totalStakedZERO\n});\n\nexport const ReadOnlyStake: React.FC = () => {\n  const { changePending, dispatch } = useStakingView();\n  const { zeroStake, totalStakedZERO } = useLiquitySelector(select);\n\n  const poolShare = zeroStake.stakedZERO.mulDiv(100, totalStakedZERO);\n\n  return (\n    <Card>\n      <Heading>Staking</Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <DisabledEditableRow\n          label=\"Stake\"\n          inputId=\"stake-zero\"\n          amount={zeroStake.stakedZERO.prettify()}\n          unit={GT}\n        />\n\n        <StaticRow\n          label=\"Pool share\"\n          inputId=\"stake-share\"\n          amount={poolShare.prettify(4)}\n          unit=\"%\"\n        />\n\n        <StaticRow\n          label=\"Redemption gain\"\n          inputId=\"stake-gain-eth\"\n          amount={zeroStake.collateralGain.prettify(4)}\n          color={zeroStake.collateralGain.nonZero && \"success\"}\n          unit=\"RBTC\"\n        />\n\n        <StaticRow\n          label=\"Issuance gain\"\n          inputId=\"stake-gain-zusd\"\n          amount={zeroStake.zusdGain.prettify()}\n          color={zeroStake.zusdGain.nonZero && \"success\"}\n          unit={COIN}\n        />\n\n        <Flex variant=\"layout.actions\">\n          <Button variant=\"outline\" onClick={() => dispatch({ type: \"startAdjusting\" })}>\n            <Icon name=\"pen\" size=\"sm\" />\n            &nbsp;Adjust\n          </Button>\n\n          <StakingGainsAction />\n        </Flex>\n      </Box>\n\n      {changePending && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import React, { useState } from \"react\";\nimport { Heading, Box, Card, Button } from \"theme-ui\";\n\nimport { Decimal, Decimalish, Difference, LiquityStoreState, ZEROStake } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { COIN, GT } from \"../../strings\";\n\nimport { Icon } from \"../Icon\";\nimport { EditableRow, StaticRow } from \"../Trove/Editor\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\n\nimport { useStakingView } from \"./context/StakingViewContext\";\n\nconst select = ({ zeroBalance, totalStakedZERO }: LiquityStoreState) => ({\n  zeroBalance,\n  totalStakedZERO\n});\n\ntype StakingEditorProps = {\n  title: string;\n  originalStake: ZEROStake;\n  editedZERO: Decimal;\n  dispatch: (action: { type: \"setStake\"; newValue: Decimalish } | { type: \"revert\" }) => void;\n};\n\nexport const StakingEditor: React.FC<StakingEditorProps> = ({\n  children,\n  title,\n  originalStake,\n  editedZERO,\n  dispatch\n}) => {\n  const { zeroBalance, totalStakedZERO } = useLiquitySelector(select);\n  const { changePending } = useStakingView();\n  const editingState = useState<string>();\n\n  const edited = !editedZERO.eq(originalStake.stakedZERO);\n\n  const maxAmount = originalStake.stakedZERO.add(zeroBalance);\n  const maxedOut = editedZERO.eq(maxAmount);\n\n  const totalStakedZEROAfterChange = totalStakedZERO.sub(originalStake.stakedZERO).add(editedZERO);\n\n  const originalPoolShare = originalStake.stakedZERO.mulDiv(100, totalStakedZERO);\n  const newPoolShare = editedZERO.mulDiv(100, totalStakedZEROAfterChange);\n  const poolShareChange =\n    originalStake.stakedZERO.nonZero && Difference.between(newPoolShare, originalPoolShare).nonZero;\n\n  return (\n    <Card>\n      <Heading>\n        {title}\n        {edited && !changePending && (\n          <Button\n            variant=\"titleIcon\"\n            sx={{ \":enabled:hover\": { color: \"danger\" } }}\n            onClick={() => dispatch({ type: \"revert\" })}\n          >\n            <Icon name=\"history\" size=\"lg\" />\n          </Button>\n        )}\n      </Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <EditableRow\n          label=\"Stake\"\n          inputId=\"stake-zero\"\n          amount={editedZERO.prettify()}\n          maxAmount={maxAmount.toString()}\n          maxedOut={maxedOut}\n          unit={GT}\n          {...{ editingState }}\n          editedAmount={editedZERO.toString(2)}\n          setEditedAmount={newValue => dispatch({ type: \"setStake\", newValue })}\n        />\n\n        {newPoolShare.infinite ? (\n          <StaticRow label=\"Pool share\" inputId=\"stake-share\" amount=\"N/A\" />\n        ) : (\n          <StaticRow\n            label=\"Pool share\"\n            inputId=\"stake-share\"\n            amount={newPoolShare.prettify(4)}\n            pendingAmount={poolShareChange?.prettify(4).concat(\"%\")}\n            pendingColor={poolShareChange?.positive ? \"success\" : \"danger\"}\n            unit=\"%\"\n          />\n        )}\n\n        {!originalStake.isEmpty && (\n          <>\n            <StaticRow\n              label=\"Redemption gain\"\n              inputId=\"stake-gain-eth\"\n              amount={originalStake.collateralGain.prettify(4)}\n              color={originalStake.collateralGain.nonZero && \"success\"}\n              unit=\"RBTC\"\n            />\n\n            <StaticRow\n              label=\"Issuance gain\"\n              inputId=\"stake-gain-zusd\"\n              amount={originalStake.zusdGain.prettify()}\n              color={originalStake.zusdGain.nonZero && \"success\"}\n              unit={COIN}\n            />\n          </>\n        )}\n\n        {children}\n      </Box>\n\n      {changePending && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import { Button } from \"theme-ui\";\n\nimport { Decimal, ZEROStakeChange } from \"@liquity/lib-base\";\n\nimport { useLiquity } from \"../../hooks/LiquityContext\";\nimport { useTransactionFunction } from \"../Transaction\";\n\ntype StakingActionProps = {\n  change: ZEROStakeChange<Decimal>;\n};\n\nexport const StakingManagerAction: React.FC<StakingActionProps> = ({ change, children }) => {\n  const { liquity } = useLiquity();\n\n  const [sendTransaction] = useTransactionFunction(\n    \"stake\",\n    change.stakeZERO\n      ? liquity.send.stakeZERO.bind(liquity.send, change.stakeZERO)\n      : liquity.send.unstakeZERO.bind(liquity.send, change.unstakeZERO)\n  );\n\n  return <Button onClick={sendTransaction}>{children}</Button>;\n};\n","import React from \"react\";\nimport { Button, Flex } from \"theme-ui\";\n\nimport {\n  Decimal,\n  Decimalish,\n  LiquityStoreState,\n  ZEROStake,\n  ZEROStakeChange\n} from \"@liquity/lib-base\";\n\nimport { LiquityStoreUpdate, useLiquityReducer, useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { GT, COIN } from \"../../strings\";\n\nimport { useStakingView } from \"./context/StakingViewContext\";\nimport { StakingEditor } from \"./StakingEditor\";\nimport { StakingManagerAction } from \"./StakingManagerAction\";\nimport { ActionDescription, Amount } from \"../ActionDescription\";\nimport { ErrorDescription } from \"../ErrorDescription\";\n\nconst init = ({ zeroStake }: LiquityStoreState) => ({\n  originalStake: zeroStake,\n  editedZERO: zeroStake.stakedZERO\n});\n\ntype StakeManagerState = ReturnType<typeof init>;\ntype StakeManagerAction =\n  | LiquityStoreUpdate\n  | { type: \"revert\" }\n  | { type: \"setStake\"; newValue: Decimalish };\n\nconst reduce = (state: StakeManagerState, action: StakeManagerAction): StakeManagerState => {\n  // console.log(state);\n  // console.log(action);\n\n  const { originalStake, editedZERO } = state;\n\n  switch (action.type) {\n    case \"setStake\":\n      return { ...state, editedZERO: Decimal.from(action.newValue) };\n\n    case \"revert\":\n      return { ...state, editedZERO: originalStake.stakedZERO };\n\n    case \"updateStore\": {\n      const {\n        stateChange: { zeroStake: updatedStake }\n      } = action;\n\n      if (updatedStake) {\n        return {\n          originalStake: updatedStake,\n          editedZERO: updatedStake.apply(originalStake.whatChanged(editedZERO))\n        };\n      }\n    }\n  }\n\n  return state;\n};\n\nconst selectZEROBalance = ({ zeroBalance }: LiquityStoreState) => zeroBalance;\n\ntype StakingManagerActionDescriptionProps = {\n  originalStake: ZEROStake;\n  change: ZEROStakeChange<Decimal>;\n};\n\nconst StakingManagerActionDescription: React.FC<StakingManagerActionDescriptionProps> = ({\n  originalStake,\n  change\n}) => {\n  const stakeZERO = change.stakeZERO?.prettify().concat(\" \", GT);\n  const unstakeZERO = change.unstakeZERO?.prettify().concat(\" \", GT);\n  const collateralGain = originalStake.collateralGain.nonZero?.prettify(4).concat(\" RBTC\");\n  const zusdGain = originalStake.zusdGain.nonZero?.prettify().concat(\" \", COIN);\n\n  if (originalStake.isEmpty && stakeZERO) {\n    return (\n      <ActionDescription>\n        You are staking <Amount>{stakeZERO}</Amount>.\n      </ActionDescription>\n    );\n  }\n\n  return (\n    <ActionDescription>\n      {stakeZERO && (\n        <>\n          You are adding <Amount>{stakeZERO}</Amount> to your stake\n        </>\n      )}\n      {unstakeZERO && (\n        <>\n          You are withdrawing <Amount>{unstakeZERO}</Amount> to your wallet\n        </>\n      )}\n      {(collateralGain || zusdGain) && (\n        <>\n          {\" \"}\n          and claiming{\" \"}\n          {collateralGain && zusdGain ? (\n            <>\n              <Amount>{collateralGain}</Amount> and <Amount>{zusdGain}</Amount>\n            </>\n          ) : (\n            <>\n              <Amount>{collateralGain ?? zusdGain}</Amount>\n            </>\n          )}\n        </>\n      )}\n      .\n    </ActionDescription>\n  );\n};\n\nexport const StakingManager: React.FC = () => {\n  const { dispatch: dispatchStakingViewAction } = useStakingView();\n  const [{ originalStake, editedZERO }, dispatch] = useLiquityReducer(reduce, init);\n  const zeroBalance = useLiquitySelector(selectZEROBalance);\n\n  const change = originalStake.whatChanged(editedZERO);\n  const [validChange, description] = !change\n    ? [undefined, undefined]\n    : change.stakeZERO?.gt(zeroBalance)\n    ? [\n        undefined,\n        <ErrorDescription>\n          The amount you're trying to stake exceeds your balance by{\" \"}\n          <Amount>\n            {change.stakeZERO.sub(zeroBalance).prettify()} {GT}\n          </Amount>\n          .\n        </ErrorDescription>\n      ]\n    : [change, <StakingManagerActionDescription originalStake={originalStake} change={change} />];\n\n  const makingNewStake = originalStake.isEmpty;\n\n  return (\n    <StakingEditor title={\"Staking\"} {...{ originalStake, editedZERO, dispatch }}>\n      {description ??\n        (makingNewStake ? (\n          <ActionDescription>Enter the amount of {GT} you'd like to stake.</ActionDescription>\n        ) : (\n          <ActionDescription>Adjust the {GT} amount to stake or withdraw.</ActionDescription>\n        ))}\n\n      <Flex variant=\"layout.actions\">\n        <Button\n          variant=\"cancel\"\n          onClick={() => dispatchStakingViewAction({ type: \"cancelAdjusting\" })}\n        >\n          Cancel\n        </Button>\n\n        {validChange ? (\n          <StakingManagerAction change={validChange}>Confirm</StakingManagerAction>\n        ) : (\n          <Button disabled>Confirm</Button>\n        )}\n      </Flex>\n    </StakingEditor>\n  );\n};\n","import { Card, Heading, Box, Flex, Button } from \"theme-ui\";\n\nimport { GT } from \"../../strings\";\n\nimport { InfoMessage } from \"../InfoMessage\";\nimport { useStakingView } from \"./context/StakingViewContext\";\n\nexport const NoStake: React.FC = () => {\n  const { dispatch } = useStakingView();\n\n  return (\n    <Card>\n      <Heading>Staking</Heading>\n      <Box sx={{ p: [2, 3] }}>\n        <InfoMessage title={`You haven't staked ${GT} yet.`}>\n          Stake {GT} to earn a share of borrowing and redemption fees.\n        </InfoMessage>\n\n        <Flex variant=\"layout.actions\">\n          <Button onClick={() => dispatch({ type: \"startAdjusting\" })}>Start staking</Button>\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import { useStakingView } from \"./context/StakingViewContext\";\nimport { ReadOnlyStake } from \"./ReadOnlyStake\";\nimport { StakingManager } from \"./StakingManager\";\nimport { NoStake } from \"./NoStake\";\n\nexport const Staking: React.FC = () => {\n  const { view } = useStakingView();\n\n  switch (view) {\n    case \"ACTIVE\":\n      return <ReadOnlyStake />;\n\n    case \"ADJUSTING\":\n      return <StakingManager />;\n\n    case \"NONE\":\n      return <NoStake />;\n  }\n};\n","import { Container } from \"theme-ui\";\n\nimport { Trove } from \"../components/Trove/Trove\";\nimport { Stability } from \"../components/Stability/Stability\";\nimport { SystemStats } from \"../components/SystemStats\";\nimport { PriceManager } from \"../components/PriceManager\";\nimport { Staking } from \"../components/Staking/Staking\";\n\nexport const Dashboard: React.FC = () => (\n  <Container variant=\"columns\">\n    <Container variant=\"left\">\n      <Trove />\n      <Stability />\n      <Staking />\n    </Container>\n\n    <Container variant=\"right\">\n      <SystemStats />\n      <PriceManager />\n    </Container>\n  </Container>\n);\n","import { Box, Flex, Heading, Paragraph } from \"theme-ui\";\n\nimport { shortenAddress } from \"../utils/shortenAddress\";\nimport { Icon } from \"../components/Icon\";\nimport { useLiquity } from \"../hooks/LiquityContext\";\n\nexport const UnregisteredFrontend: React.FC = () => {\n  const {\n    config: { frontendTag }\n  } = useLiquity();\n\n  return (\n    <Box\n      sx={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"space-around\",\n\n        m: 3,\n        p: 3,\n        maxWidth: \"500px\",\n\n        border: 1,\n        borderRadius: \"8px\",\n        borderColor: \"warning\",\n        boxShadow: 2\n      }}\n    >\n      <Flex sx={{ alignItems: \"center\", mx: 3, mb: 2 }}>\n        <Icon name=\"exclamation-triangle\" size=\"2x\" />\n        <Heading sx={{ ml: 3, fontSize: \"18px\" }}>Frontend not yet registered</Heading>\n      </Flex>\n\n      <Paragraph sx={{ fontSize: 2 }}>\n        If you're the operator of this frontend, please select <b>{shortenAddress(frontendTag)}</b>{\" \"}\n        in your wallet to proceed with the registration.\n      </Paragraph>\n    </Box>\n  );\n};\n","import { useState } from \"react\";\nimport { Card, Heading, Box, Flex, Input, Label, Paragraph, Button, Spinner } from \"theme-ui\";\n\nimport { Decimal } from \"@liquity/lib-base\";\n\nimport { shortenAddress } from \"../utils/shortenAddress\";\nimport { useLiquity } from \"../hooks/LiquityContext\";\nimport { Transaction, useMyTransactionState } from \"../components/Transaction\";\nimport { Icon } from \"../components/Icon\";\n\ntype FrontendRegistrationActionProps = {\n  kickbackRate: Decimal;\n};\n\nconst FrontendRegistrationAction: React.FC<FrontendRegistrationActionProps> = ({ kickbackRate }) => {\n  const {\n    liquity: { send: liquity }\n  } = useLiquity();\n\n  const myTransactionId = \"register-frontend\";\n  const myTransactionState = useMyTransactionState(myTransactionId);\n\n  return myTransactionState.type === \"waitingForApproval\" ? (\n    <Button disabled>\n      <Spinner sx={{ mr: 2, color: \"white\" }} size=\"20px\" />\n      Waiting for your approval\n    </Button>\n  ) : myTransactionState.type !== \"waitingForConfirmation\" &&\n    myTransactionState.type !== \"confirmed\" ? (\n    <Transaction id={myTransactionId} send={liquity.registerFrontend.bind(liquity, kickbackRate)}>\n      <Button>Register</Button>\n    </Transaction>\n  ) : null;\n};\n\nexport const FrontendRegistration: React.FC = () => {\n  const { account } = useLiquity();\n\n  const [kickbackRate, setKickbackRate] = useState(Decimal.from(0.8));\n  const [cut, setCut] = useState(Decimal.from(0.2));\n  const [kickbackRateString, setKickbackRateString] = useState(\"80\");\n\n  return (\n    <>\n      <Card>\n        <Heading>Choose a kickback rate</Heading>\n\n        <Box sx={{ p: [2, 3] }}>\n          <Flex>\n            <Label>Kickback rate</Label>\n            <Label variant=\"unit\">%</Label>\n\n            <Input\n              sx={{ maxWidth: \"200px\" }}\n              type=\"number\"\n              step=\"any\"\n              value={kickbackRateString}\n              onChange={e => {\n                setKickbackRateString(e.target.value);\n                try {\n                  const newKickbackRate = Decimal.from(e.target.value || 0).div(100);\n                  const newCut = Decimal.ONE.sub(newKickbackRate);\n\n                  setKickbackRate(newKickbackRate);\n                  setCut(newCut);\n                } catch {}\n              }}\n              onBlur={() => {\n                setKickbackRateString(kickbackRate.mul(100).toString());\n              }}\n            />\n          </Flex>\n        </Box>\n      </Card>\n\n      <Box\n        sx={{\n          display: \"flex\",\n          flexDirection: \"column\",\n          justifyContent: \"space-around\",\n\n          m: 3,\n          mt: [3, null, 4],\n          mb: 4,\n          p: 3,\n          maxWidth: \"450px\",\n\n          border: 1,\n          borderRadius: \"8px\",\n          borderColor: \"danger\",\n          boxShadow: 2\n        }}\n      >\n        <Flex sx={{ alignItems: \"center\", mx: 3, fontSize: 4 }}>\n          <Icon name=\"hand-paper\" />\n          <Heading sx={{ ml: 3, fontSize: \"18px\" }}>Before you proceed</Heading>\n        </Flex>\n\n        <Paragraph sx={{ fontSize: 1, mt: 3 }}>\n          You are about to register <b>{shortenAddress(account)}</b> to receive{\" \"}\n          <b>{cut.mul(100).toString()}%</b> of the ZERO rewards earned through this frontend.\n        </Paragraph>\n\n        <Paragraph sx={{ fontSize: 1, mt: 3, fontWeight: \"bold\" }}>\n          You will not be able to change the kickback rate for this address later.\n        </Paragraph>\n\n        <Paragraph sx={{ fontSize: 1, mt: 3 }}>\n          If you'd like to use a different kickback rate in the future, you will need to repeat this\n          registration with a different address.\n        </Paragraph>\n      </Box>\n\n      <FrontendRegistrationAction {...{ kickbackRate }} />\n    </>\n  );\n};\n","import { Box, Flex, Heading, Paragraph, Button } from \"theme-ui\";\n\nimport { Icon } from \"../components/Icon\";\n\ntype FrontendRegistrationSuccessProps = {\n  onDismiss: () => void;\n};\n\nexport const FrontendRegistrationSuccess: React.FC<FrontendRegistrationSuccessProps> = ({\n  onDismiss\n}) => (\n  <>\n    <Box\n      sx={{\n        display: \"flex\",\n        flexDirection: \"column\",\n        justifyContent: \"space-around\",\n\n        m: 3,\n        mt: 4,\n        mb: 4,\n        p: 4,\n        maxWidth: \"500px\",\n\n        bg: \"rgba(40, 192, 129, 0.05)\",\n        color: \"success\",\n\n        border: 1,\n        borderRadius: \"8px\",\n        borderColor: \"success\",\n        boxShadow: 2\n      }}\n    >\n      <Flex sx={{ alignItems: \"center\", mx: 3, mb: 4, fontSize: 5 }}>\n        <Icon name=\"check\" />\n        <Heading sx={{ ml: 3, fontSize: 4 }}>Success!</Heading>\n      </Flex>\n\n      <Paragraph sx={{ fontSize: 2 }}>Your frontend is now ready to receive ZERO rewards.</Paragraph>\n    </Box>\n\n    <Button onClick={onDismiss}>Go to Dashboard</Button>\n  </>\n);\n","import { useEffect, useState } from \"react\";\nimport { AddressZero } from \"@ethersproject/constants\";\n\nimport { LiquityStoreState } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"../hooks/LiquityContext\";\n\nimport { Dashboard } from \"./Dashboard\";\nimport { UnregisteredFrontend } from \"./UnregisteredFrontend\";\nimport { FrontendRegistration } from \"./FrontendRegistration\";\nimport { FrontendRegistrationSuccess } from \"./FrontendRegistrationSuccess\";\n\nconst selectFrontend = ({ frontend }: LiquityStoreState) => frontend;\n\nexport const PageSwitcher: React.FC = () => {\n  const {\n    account,\n    config: { frontendTag }\n  } = useLiquity();\n\n  const frontend = useLiquitySelector(selectFrontend);\n  const unregistered = frontendTag !== AddressZero && frontend.status === \"unregistered\";\n\n  const [registering, setRegistering] = useState(false);\n\n  useEffect(() => {\n    if (unregistered) {\n      setRegistering(true);\n    }\n  }, [unregistered]);\n\n  if (registering || unregistered) {\n    if (frontend.status === \"registered\") {\n      return <FrontendRegistrationSuccess onDismiss={() => setRegistering(false)} />;\n    } else if (account === frontendTag) {\n      return <FrontendRegistration />;\n    } else {\n      return <UnregisteredFrontend />;\n    }\n  } else {\n    return <Dashboard />;\n  }\n};\n","import React, { useState } from \"react\";\nimport { Card, Box, Heading, Flex, Button, Label, Input } from \"theme-ui\";\n\nimport { useLiquity } from \"../hooks/LiquityContext\";\n\nimport { Icon } from \"./Icon\";\nimport { Transaction } from \"./Transaction\";\n\nexport const LiquidationManager: React.FC = () => {\n  const {\n    liquity: { send: liquity }\n  } = useLiquity();\n  const [numberOfTrovesToLiquidate, setNumberOfTrovesToLiquidate] = useState(\"90\");\n\n  return (\n    <Card>\n      <Heading>Liquidate</Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <Flex sx={{ alignItems: \"stretch\" }}>\n          <Label>Up to</Label>\n\n          <Input\n            type=\"number\"\n            min=\"1\"\n            step=\"1\"\n            value={numberOfTrovesToLiquidate}\n            onChange={e => setNumberOfTrovesToLiquidate(e.target.value)}\n          />\n\n          <Label>Lines of Credit</Label>\n\n          <Flex sx={{ ml: 2, alignItems: \"center\" }}>\n            <Transaction\n              id=\"batch-liquidate\"\n              tooltip=\"Liquidate\"\n              tooltipPlacement=\"bottom\"\n              send={overrides => {\n                if (!numberOfTrovesToLiquidate) {\n                  throw new Error(\"Invalid number\");\n                }\n                return liquity.liquidateUpTo(parseInt(numberOfTrovesToLiquidate, 10), overrides);\n              }}\n            >\n              <Button variant=\"dangerIcon\">\n                <Icon name=\"trash\" size=\"lg\" />\n              </Button>\n            </Transaction>\n          </Flex>\n        </Flex>\n      </Box>\n    </Card>\n  );\n};\n","import React from \"react\";\nimport { Box, BoxProps } from \"theme-ui\";\n\ntype AbbreviationProps = BoxProps & {\n  short: React.ReactNode;\n};\n\nexport const Abbreviation: React.FC<AbbreviationProps> = ({ children, short, ...boxProps }) => (\n  <Box as=\"span\" {...boxProps}>\n    <Box as=\"span\" sx={{ display: [\"none\", \"unset\"] }}>\n      {children}\n    </Box>\n\n    <Box as=\"span\" sx={{ display: [\"unset\", \"none\"] }}>\n      {short}\n    </Box>\n  </Box>\n);\n","import React, { useState, useEffect, useCallback } from \"react\";\nimport CopyToClipboard from \"react-copy-to-clipboard\";\nimport { Card, Button, Text, Box, Heading, Flex } from \"theme-ui\";\n\nimport {\n  Percent,\n  MINIMUM_COLLATERAL_RATIO,\n  CRITICAL_COLLATERAL_RATIO,\n  UserTrove,\n  Decimal\n} from \"@liquity/lib-base\";\nimport { BlockPolledLiquityStoreState } from \"@liquity/lib-ethers\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { shortenAddress } from \"../utils/shortenAddress\";\nimport { useLiquity } from \"../hooks/LiquityContext\";\nimport { COIN } from \"../strings\";\n\nimport { Icon } from \"./Icon\";\nimport { LoadingOverlay } from \"./LoadingOverlay\";\nimport { Transaction } from \"./Transaction\";\nimport { Tooltip } from \"./Tooltip\";\nimport { Abbreviation } from \"./Abbreviation\";\n\nconst rowHeight = \"40px\";\n\nconst liquidatableInNormalMode = (trove: UserTrove, price: Decimal) =>\n  [trove.collateralRatioIsBelowMinimum(price), \"Collateral ratio not low enough\"] as const;\n\nconst liquidatableInRecoveryMode = (\n  trove: UserTrove,\n  price: Decimal,\n  totalCollateralRatio: Decimal,\n  zusdInStabilityPool: Decimal\n) => {\n  const collateralRatio = trove.collateralRatio(price);\n\n  if (collateralRatio.gte(MINIMUM_COLLATERAL_RATIO) && collateralRatio.lt(totalCollateralRatio)) {\n    return [\n      trove.debt.lte(zusdInStabilityPool),\n      \"There's not enough ZUSD in the Stability pool to cover the debt\"\n    ] as const;\n  } else {\n    return liquidatableInNormalMode(trove, price);\n  }\n};\n\ntype RiskyTrovesProps = {\n  pageSize: number;\n};\n\nconst select = ({\n  numberOfTroves,\n  price,\n  total,\n  zusdInStabilityPool,\n  blockTag\n}: BlockPolledLiquityStoreState) => ({\n  numberOfTroves,\n  price,\n  recoveryMode: total.collateralRatioIsBelowCritical(price),\n  totalCollateralRatio: total.collateralRatio(price),\n  zusdInStabilityPool,\n  blockTag\n});\n\nexport const RiskyTroves: React.FC<RiskyTrovesProps> = ({ pageSize }) => {\n  const {\n    blockTag,\n    numberOfTroves,\n    recoveryMode,\n    totalCollateralRatio,\n    zusdInStabilityPool,\n    price\n  } = useLiquitySelector(select);\n  const { liquity } = useLiquity();\n\n  const [loading, setLoading] = useState(true);\n  const [troves, setTroves] = useState<UserTrove[]>();\n\n  const [reload, setReload] = useState({});\n  const forceReload = useCallback(() => setReload({}), []);\n\n  const [page, setPage] = useState(0);\n  const numberOfPages = Math.ceil(numberOfTroves / pageSize) || 1;\n  const clampedPage = Math.min(page, numberOfPages - 1);\n\n  const nextPage = () => {\n    if (clampedPage < numberOfPages - 1) {\n      setPage(clampedPage + 1);\n    }\n  };\n\n  const previousPage = () => {\n    if (clampedPage > 0) {\n      setPage(clampedPage - 1);\n    }\n  };\n\n  useEffect(() => {\n    if (page !== clampedPage) {\n      setPage(clampedPage);\n    }\n  }, [page, clampedPage]);\n\n  useEffect(() => {\n    let mounted = true;\n\n    setLoading(true);\n\n    liquity\n      .getTroves(\n        {\n          first: pageSize,\n          sortedBy: \"ascendingCollateralRatio\",\n          startingAt: clampedPage * pageSize\n        },\n        { blockTag }\n      )\n      .then(troves => {\n        if (mounted) {\n          setTroves(troves);\n          setLoading(false);\n        }\n      });\n\n    return () => {\n      mounted = false;\n    };\n    // Omit blockTag from deps on purpose\n    // eslint-disable-next-line\n  }, [liquity, clampedPage, pageSize, reload]);\n\n  useEffect(() => {\n    forceReload();\n  }, [forceReload, numberOfTroves]);\n\n  const [copied, setCopied] = useState<string>();\n\n  useEffect(() => {\n    if (copied !== undefined) {\n      let cancelled = false;\n\n      setTimeout(() => {\n        if (!cancelled) {\n          setCopied(undefined);\n        }\n      }, 2000);\n\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [copied]);\n\n  return (\n    <Card sx={{ width: \"100%\" }}>\n      <Heading>\n        <Abbreviation short=\"LoC\">Risky Lines of Credit</Abbreviation>\n\n        <Flex sx={{ alignItems: \"center\" }}>\n          {numberOfTroves !== 0 && (\n            <>\n              <Abbreviation\n                short={`page ${clampedPage + 1} / ${numberOfPages}`}\n                sx={{ mr: [0, 3], fontWeight: \"body\", fontSize: [1, 2], letterSpacing: [-1, 0] }}\n              >\n                {clampedPage * pageSize + 1}-{Math.min((clampedPage + 1) * pageSize, numberOfTroves)}{\" \"}\n                of {numberOfTroves}\n              </Abbreviation>\n\n              <Button variant=\"titleIcon\" onClick={previousPage} disabled={clampedPage <= 0}>\n                <Icon name=\"chevron-left\" size=\"lg\" />\n              </Button>\n\n              <Button\n                variant=\"titleIcon\"\n                onClick={nextPage}\n                disabled={clampedPage >= numberOfPages - 1}\n              >\n                <Icon name=\"chevron-right\" size=\"lg\" />\n              </Button>\n            </>\n          )}\n\n          <Button\n            variant=\"titleIcon\"\n            sx={{ opacity: loading ? 0 : 1, ml: [0, 3] }}\n            onClick={forceReload}\n          >\n            <Icon name=\"redo\" size=\"lg\" />\n          </Button>\n        </Flex>\n      </Heading>\n\n      {!troves || troves.length === 0 ? (\n        <Box sx={{ p: [2, 3] }}>\n          <Box sx={{ p: 4, fontSize: 3, textAlign: \"center\" }}>\n            {!troves ? \"Loading...\" : \"There are no Lines of Credit yet\"}\n          </Box>\n        </Box>\n      ) : (\n        <Box sx={{ p: [2, 3] }}>\n          <Box\n            as=\"table\"\n            sx={{\n              mt: 2,\n              pl: [1, 4],\n              width: \"100%\",\n\n              textAlign: \"center\",\n              lineHeight: 1.15\n            }}\n          >\n            <colgroup>\n              <col style={{ width: \"50px\" }} />\n              <col />\n              <col />\n              <col />\n              <col style={{ width: rowHeight }} />\n            </colgroup>\n\n            <thead>\n              <tr>\n                <th>Owner</th>\n                <th>\n                  <Abbreviation short=\"Coll.\">Collateral</Abbreviation>\n                  <Box sx={{ fontSize: [0, 1], fontWeight: \"body\", opacity: 0.5 }}>RBTC</Box>\n                </th>\n                <th>\n                  Debt\n                  <Box sx={{ fontSize: [0, 1], fontWeight: \"body\", opacity: 0.5 }}>{COIN}</Box>\n                </th>\n                <th>\n                  Coll.\n                  <br />\n                  Ratio\n                </th>\n                <th></th>\n              </tr>\n            </thead>\n\n            <tbody>\n              {troves.map(\n                trove =>\n                  !trove.isEmpty && ( // making sure the Trove hasn't been liquidated\n                    // (TODO: remove check after we can fetch multiple Troves in one call)\n                    <tr key={trove.ownerAddress}>\n                      <td\n                        style={{\n                          display: \"flex\",\n                          alignItems: \"center\",\n                          height: rowHeight\n                        }}\n                      >\n                        <Tooltip message={trove.ownerAddress} placement=\"top\">\n                          <Text\n                            variant=\"address\"\n                            sx={{\n                              width: [\"73px\", \"unset\"],\n                              overflow: \"hidden\",\n                              position: \"relative\"\n                            }}\n                          >\n                            {shortenAddress(trove.ownerAddress)}\n                            <Box\n                              sx={{\n                                display: [\"block\", \"none\"],\n                                position: \"absolute\",\n                                top: 0,\n                                right: 0,\n                                width: \"50px\",\n                                height: \"100%\",\n                                background:\n                                  \"linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%)\"\n                              }}\n                            />\n                          </Text>\n                        </Tooltip>\n\n                        <CopyToClipboard\n                          text={trove.ownerAddress}\n                          onCopy={() => setCopied(trove.ownerAddress)}\n                        >\n                          <Button variant=\"icon\" sx={{ width: \"24px\", height: \"24px\" }}>\n                            <Icon\n                              name={copied === trove.ownerAddress ? \"clipboard-check\" : \"clipboard\"}\n                              size=\"sm\"\n                            />\n                          </Button>\n                        </CopyToClipboard>\n                      </td>\n                      <td>\n                        <Abbreviation short={trove.collateral.shorten()}>\n                          {trove.collateral.prettify(4)}\n                        </Abbreviation>\n                      </td>\n                      <td>\n                        <Abbreviation short={trove.debt.shorten()}>\n                          {trove.debt.prettify()}\n                        </Abbreviation>\n                      </td>\n                      <td>\n                        {(collateralRatio => (\n                          <Text\n                            color={\n                              collateralRatio.gt(CRITICAL_COLLATERAL_RATIO)\n                                ? \"success\"\n                                : collateralRatio.gt(1.2)\n                                ? \"warning\"\n                                : \"danger\"\n                            }\n                          >\n                            {new Percent(collateralRatio).prettify()}\n                          </Text>\n                        ))(trove.collateralRatio(price))}\n                      </td>\n                      <td>\n                        <Transaction\n                          id={`liquidate-${trove.ownerAddress}`}\n                          tooltip=\"Liquidate\"\n                          requires={[\n                            recoveryMode\n                              ? liquidatableInRecoveryMode(\n                                  trove,\n                                  price,\n                                  totalCollateralRatio,\n                                  zusdInStabilityPool\n                                )\n                              : liquidatableInNormalMode(trove, price)\n                          ]}\n                          send={liquity.send.liquidate.bind(liquity.send, trove.ownerAddress)}\n                        >\n                          <Button variant=\"dangerIcon\">\n                            <Icon name=\"trash\" />\n                          </Button>\n                        </Transaction>\n                      </td>\n                    </tr>\n                  )\n              )}\n            </tbody>\n          </Box>\n        </Box>\n      )}\n\n      {loading && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import React from \"react\";\nimport { Container, Card, Box, Paragraph } from \"theme-ui\";\nimport { SystemStats } from \"../components/SystemStats\";\nimport { LiquidationManager } from \"../components/LiquidationManager\";\nimport { RiskyTroves } from \"../components/RiskyTroves\";\nimport { InfoMessage } from \"../components/InfoMessage\";\n\nexport const RiskyTrovesPage: React.FC = () => (\n  <Container variant=\"columns\">\n    <Container variant=\"left\">\n      <Card>\n        <Box sx={{ p: [2, 3] }}>\n          <InfoMessage title=\"Bot functionality\">\n            <Paragraph>Liquidation is expected to be carried out by bots.</Paragraph>\n            <Paragraph>\n              Early on you may be able to manually liquidate Lines of Credit, but as the system matures this\n              will become less likely.\n            </Paragraph>\n          </InfoMessage>\n        </Box>\n      </Card>\n      <LiquidationManager />\n    </Container>\n\n    <Container variant=\"right\">\n      <SystemStats />\n    </Container>\n    <RiskyTroves pageSize={10} />\n  </Container>\n);\n","import { Box, Card, Heading, Paragraph, Text } from \"theme-ui\";\n\nimport { InfoMessage } from \"../InfoMessage\";\nimport { Icon } from \"../Icon\";\n\ntype DisabledRedemptionProps = {\n  disabledDays: number;\n  unlockDate: Date;\n};\n\nexport const DisabledRedemption: React.FC<DisabledRedemptionProps> = ({\n  disabledDays,\n  unlockDate\n}) => (\n  <Card>\n    <Heading>Redeem</Heading>\n\n    <Box sx={{ p: [2, 3] }}>\n      <InfoMessage\n        title=\"Redemption is not enabled yet.\"\n        icon={\n          <Box sx={{ color: \"warning\" }}>\n            <Icon name=\"exclamation-triangle\" />\n          </Box>\n        }\n      >\n        <Paragraph>\n          ZUSD redemption is disabled for the first {disabledDays} days after launch.\n        </Paragraph>\n\n        <Paragraph sx={{ mt: 3 }}>\n          It will be unlocked at{\" \"}\n          <Text sx={{ fontWeight: \"medium\" }}>{unlockDate.toLocaleString()}</Text>.\n        </Paragraph>\n      </InfoMessage>\n    </Box>\n  </Card>\n);\n","import { Button } from \"theme-ui\";\n\nimport { Decimal } from \"@liquity/lib-base\";\n\nimport { useLiquity } from \"../../hooks/LiquityContext\";\nimport { useTransactionFunction } from \"../Transaction\";\n\ntype RedemptionActionProps = {\n  transactionId: string;\n  disabled?: boolean;\n  zusdAmount: Decimal;\n  maxRedemptionRate: Decimal;\n};\n\nexport const RedemptionAction: React.FC<RedemptionActionProps> = ({\n  transactionId,\n  disabled,\n  zusdAmount,\n  maxRedemptionRate\n}) => {\n  const {\n    liquity: { send: liquity }\n  } = useLiquity();\n\n  const [sendTransaction] = useTransactionFunction(\n    transactionId,\n    liquity.redeemZUSD.bind(liquity, zusdAmount, maxRedemptionRate)\n  );\n\n  return (\n    <Button disabled={disabled} onClick={sendTransaction}>\n      Confirm\n    </Button>\n  );\n};\n","import React, { useEffect, useState } from \"react\";\nimport { Button, Box, Flex, Card, Heading } from \"theme-ui\";\n\nimport { Decimal, Percent, LiquityStoreState, MINIMUM_COLLATERAL_RATIO } from \"@liquity/lib-base\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { COIN } from \"../../strings\";\n\nimport { Icon } from \"../Icon\";\nimport { LoadingOverlay } from \"../LoadingOverlay\";\nimport { EditableRow, StaticRow } from \"../Trove/Editor\";\nimport { ActionDescription, Amount } from \"../ActionDescription\";\nimport { ErrorDescription } from \"../ErrorDescription\";\nimport { useMyTransactionState } from \"../Transaction\";\n\nimport { RedemptionAction } from \"./RedemptionAction\";\nimport { InfoIcon } from \"../InfoIcon\";\n\nconst mcrPercent = new Percent(MINIMUM_COLLATERAL_RATIO).toString(0);\n\nconst select = ({ price, fees, total, zusdBalance }: LiquityStoreState) => ({\n  price,\n  fees,\n  total,\n  zusdBalance\n});\n\nconst transactionId = \"redemption\";\n\nexport const RedemptionManager: React.FC = () => {\n  const { price, fees, total, zusdBalance } = useLiquitySelector(select);\n  const [zusdAmount, setZUSDAmount] = useState(Decimal.ZERO);\n  const [changePending, setChangePending] = useState(false);\n  const editingState = useState<string>();\n\n  const dirty = !zusdAmount.isZero;\n  const ethAmount = zusdAmount.div(price);\n  const redemptionRate = fees.redemptionRate(zusdAmount.div(total.debt));\n  const feePct = new Percent(redemptionRate);\n  const ethFee = ethAmount.mul(redemptionRate);\n  const maxRedemptionRate = redemptionRate.add(0.001); // TODO slippage tolerance\n\n  const myTransactionState = useMyTransactionState(transactionId);\n\n  useEffect(() => {\n    if (\n      myTransactionState.type === \"waitingForApproval\" ||\n      myTransactionState.type === \"waitingForConfirmation\"\n    ) {\n      setChangePending(true);\n    } else if (myTransactionState.type === \"failed\" || myTransactionState.type === \"cancelled\") {\n      setChangePending(false);\n    } else if (myTransactionState.type === \"confirmed\") {\n      setZUSDAmount(Decimal.ZERO);\n      setChangePending(false);\n    }\n  }, [myTransactionState.type, setChangePending, setZUSDAmount]);\n\n  const [canRedeem, description] = total.collateralRatioIsBelowMinimum(price)\n    ? [\n        false,\n        <ErrorDescription>\n          You can't redeem ZUSD when the total collateral ratio is less than{\" \"}\n          <Amount>{mcrPercent}</Amount>. Please try again later.\n        </ErrorDescription>\n      ]\n    : zusdAmount.gt(zusdBalance)\n    ? [\n        false,\n        <ErrorDescription>\n          The amount you're trying to redeem exceeds your balance by{\" \"}\n          <Amount>\n            {zusdAmount.sub(zusdBalance).prettify()} {COIN}\n          </Amount>\n          .\n        </ErrorDescription>\n      ]\n    : [\n        true,\n        <ActionDescription>\n          You will receive <Amount>{ethAmount.sub(ethFee).prettify(4)} RBTC</Amount> in exchange for{\" \"}\n          <Amount>\n            {zusdAmount.prettify()} {COIN}\n          </Amount>\n          .\n        </ActionDescription>\n      ];\n\n  return (\n    <Card>\n      <Heading>\n        Redeem\n        {dirty && !changePending && (\n          <Button\n            variant=\"titleIcon\"\n            sx={{ \":enabled:hover\": { color: \"danger\" } }}\n            onClick={() => setZUSDAmount(Decimal.ZERO)}\n          >\n            <Icon name=\"history\" size=\"lg\" />\n          </Button>\n        )}\n      </Heading>\n\n      <Box sx={{ p: [2, 3] }}>\n        <EditableRow\n          label=\"Redeem\"\n          inputId=\"redeem-zusd\"\n          amount={zusdAmount.prettify()}\n          maxAmount={zusdBalance.toString()}\n          maxedOut={zusdAmount.eq(zusdBalance)}\n          unit={COIN}\n          {...{ editingState }}\n          editedAmount={zusdAmount.toString(2)}\n          setEditedAmount={amount => setZUSDAmount(Decimal.from(amount))}\n        />\n\n        <StaticRow\n          label=\"Redemption Fee\"\n          inputId=\"redeem-fee\"\n          amount={ethFee.toString(4)}\n          pendingAmount={feePct.toString(2)}\n          unit=\"ETH\"\n          infoIcon={\n            <InfoIcon\n              tooltip={\n                <Card variant=\"tooltip\" sx={{ minWidth: \"240px\" }}>\n                  The Redemption Fee is charged as a percentage of the redeemed RBTC. The Redemption\n                  Fee depends on ZUSD redemption volumes and is 0.5% at minimum.\n                </Card>\n              }\n            />\n          }\n        />\n\n        {((dirty || !canRedeem) && description) || (\n          <ActionDescription>Enter the amount of {COIN} you'd like to redeem.</ActionDescription>\n        )}\n\n        <Flex variant=\"layout.actions\">\n          <RedemptionAction\n            transactionId={transactionId}\n            disabled={!dirty || !canRedeem}\n            zusdAmount={zusdAmount}\n            maxRedemptionRate={maxRedemptionRate}\n          />\n        </Flex>\n      </Box>\n\n      {changePending && <LoadingOverlay />}\n    </Card>\n  );\n};\n","import { BlockPolledLiquityStoreState } from \"@liquity/lib-ethers\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"../../hooks/LiquityContext\";\nimport { DisabledRedemption } from \"./DisabledRedemption\";\nimport { RedemptionManager } from \"./RedemptionManager\";\n\nconst SECONDS_IN_ONE_DAY = 24 * 60 * 60;\n\nconst selectBlockTimestamp = ({ blockTimestamp }: BlockPolledLiquityStoreState) => blockTimestamp;\n\nexport const Redemption: React.FC = () => {\n  const {\n    liquity: {\n      connection: { deploymentDate, bootstrapPeriod }\n    }\n  } = useLiquity();\n\n  const blockTimestamp = useLiquitySelector(selectBlockTimestamp);\n\n  const bootstrapPeriodDays = Math.round(bootstrapPeriod / SECONDS_IN_ONE_DAY);\n  const deploymentTime = deploymentDate.getTime() / 1000;\n  const bootstrapEndTime = deploymentTime + bootstrapPeriod;\n  const bootstrapEndDate = new Date(bootstrapEndTime * 1000);\n  const redemptionDisabled = blockTimestamp < bootstrapEndTime;\n\n  if (redemptionDisabled) {\n    return <DisabledRedemption disabledDays={bootstrapPeriodDays} unlockDate={bootstrapEndDate} />;\n  }\n\n  return <RedemptionManager />;\n};\n","import React from \"react\";\nimport { Box, Card, Container, Link, Paragraph } from \"theme-ui\";\nimport { SystemStats } from \"../components/SystemStats\";\nimport { Redemption } from \"../components/Redemption/Redemption\";\nimport { InfoMessage } from \"../components/InfoMessage\";\nimport { Icon } from \"../components/Icon\";\n\n\nexport const RedemptionPage: React.FC = () => {\n  return (\n    <Container variant=\"columns\">\n      <Container variant=\"left\">\n        <Card>\n          <Box sx={{ p: [2, 3] }}>\n            <InfoMessage title=\"Bot functionality\">\n              <Paragraph>\n                Redemptions are expected to be carried out by bots when arbitrage opportunities\n                emerge.\n              </Paragraph>\n              <Paragraph sx={{ mt: 2 }}>\n                Most of the time you will get a better rate for converting NUE to RBTC on{\" \"}\n                <Link href=\"https://live.sovryn.app/swap\" target=\"_blank\">\n                  Sovryn <Icon name=\"external-link-alt\" size=\"xs\" />\n                </Link>{\" \"}\n                or other exchanges.\n              </Paragraph>\n              <Paragraph sx={{ mt: 2 }}>\n                <strong>Note</strong>: Redemption is not for repaying your loan. To repay your loan,\n                adjust your Line of Credit on the <Link href=\"#/\">Dashboard</Link>.\n              </Paragraph>\n            </InfoMessage>\n          </Box>\n        </Card>\n        <Redemption />\n      </Container>\n\n      <Container variant=\"right\">\n        <SystemStats />\n      </Container>\n    </Container>\n  );\n};\n","import React, { useState, useCallback, useEffect, useRef } from \"react\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { LiquityStoreState, UserTroveStatus } from \"@liquity/lib-base\";\nimport { TroveViewContext } from \"./TroveViewContext\";\nimport type { TroveView, TroveEvent } from \"./types\";\n\ntype TroveEventTransitions = Record<TroveView, Partial<Record<TroveEvent, TroveView>>>;\n\nconst transitions: TroveEventTransitions = {\n  NONE: {\n    OPEN_TROVE_PRESSED: \"OPENING\",\n    TROVE_OPENED: \"ACTIVE\"\n  },\n  LIQUIDATED: {\n    OPEN_TROVE_PRESSED: \"OPENING\",\n    TROVE_SURPLUS_COLLATERAL_CLAIMED: \"NONE\",\n    TROVE_OPENED: \"ACTIVE\"\n  },\n  REDEEMED: {\n    OPEN_TROVE_PRESSED: \"OPENING\",\n    TROVE_SURPLUS_COLLATERAL_CLAIMED: \"NONE\",\n    TROVE_OPENED: \"ACTIVE\"\n  },\n  OPENING: {\n    CANCEL_ADJUST_TROVE_PRESSED: \"NONE\",\n    TROVE_OPENED: \"ACTIVE\"\n  },\n  ADJUSTING: {\n    CANCEL_ADJUST_TROVE_PRESSED: \"ACTIVE\",\n    TROVE_ADJUSTED: \"ACTIVE\",\n    TROVE_CLOSED: \"NONE\",\n    TROVE_LIQUIDATED: \"LIQUIDATED\",\n    TROVE_REDEEMED: \"REDEEMED\"\n  },\n  CLOSING: {\n    CANCEL_ADJUST_TROVE_PRESSED: \"ACTIVE\",\n    TROVE_CLOSED: \"NONE\",\n    TROVE_ADJUSTED: \"ACTIVE\",\n    TROVE_LIQUIDATED: \"LIQUIDATED\",\n    TROVE_REDEEMED: \"REDEEMED\"\n  },\n  ACTIVE: {\n    ADJUST_TROVE_PRESSED: \"ADJUSTING\",\n    CLOSE_TROVE_PRESSED: \"CLOSING\",\n    TROVE_CLOSED: \"NONE\",\n    TROVE_LIQUIDATED: \"LIQUIDATED\",\n    TROVE_REDEEMED: \"REDEEMED\"\n  }\n};\n\ntype TroveStateEvents = Partial<Record<UserTroveStatus, TroveEvent>>;\n\nconst troveStatusEvents: TroveStateEvents = {\n  open: \"TROVE_OPENED\",\n  closedByOwner: \"TROVE_CLOSED\",\n  closedByLiquidation: \"TROVE_LIQUIDATED\",\n  closedByRedemption: \"TROVE_REDEEMED\"\n};\n\nconst transition = (view: TroveView, event: TroveEvent): TroveView => {\n  const nextView = transitions[view][event] ?? view;\n  return nextView;\n};\n\nconst getInitialView = (troveStatus: UserTroveStatus): TroveView => {\n  if (troveStatus === \"closedByLiquidation\") {\n    return \"LIQUIDATED\";\n  }\n  if (troveStatus === \"closedByRedemption\") {\n    return \"REDEEMED\";\n  }\n  if (troveStatus === \"open\") {\n    return \"ACTIVE\";\n  }\n  return \"NONE\";\n};\n\nconst select = ({ trove: { status } }: LiquityStoreState) => status;\n\nexport const TroveViewProvider: React.FC = props => {\n  const { children } = props;\n  const troveStatus = useLiquitySelector(select);\n\n  const [view, setView] = useState<TroveView>(getInitialView(troveStatus));\n  const viewRef = useRef<TroveView>(view);\n\n  const dispatchEvent = useCallback((event: TroveEvent) => {\n    const nextView = transition(viewRef.current, event);\n\n    console.log(\n      \"dispatchEvent() [current-view, event, next-view]\",\n      viewRef.current,\n      event,\n      nextView\n    );\n    setView(nextView);\n  }, []);\n\n  useEffect(() => {\n    viewRef.current = view;\n  }, [view]);\n\n  useEffect(() => {\n    const event = troveStatusEvents[troveStatus] ?? null;\n    if (event !== null) {\n      dispatchEvent(event);\n    }\n  }, [troveStatus, dispatchEvent]);\n\n  const provider = {\n    view,\n    dispatchEvent\n  };\n  return <TroveViewContext.Provider value={provider}>{children}</TroveViewContext.Provider>;\n};\n","import React, { useState, useCallback, useEffect, useRef } from \"react\";\nimport { useLiquitySelector } from \"@liquity/lib-react\";\nimport { LiquityStoreState, StabilityDeposit } from \"@liquity/lib-base\";\nimport { StabilityViewContext } from \"./StabilityViewContext\";\nimport type { StabilityView, StabilityEvent } from \"./types\";\n\ntype StabilityEventTransitions = Record<\n  StabilityView,\n  Partial<Record<StabilityEvent, StabilityView>>\n>;\n\nconst transitions: StabilityEventTransitions = {\n  NONE: {\n    DEPOSIT_PRESSED: \"DEPOSITING\"\n  },\n  DEPOSITING: {\n    CANCEL_PRESSED: \"NONE\",\n    DEPOSIT_CONFIRMED: \"ACTIVE\"\n  },\n  ACTIVE: {\n    REWARDS_CLAIMED: \"ACTIVE\",\n    ADJUST_DEPOSIT_PRESSED: \"ADJUSTING\",\n    DEPOSIT_EMPTIED: \"NONE\"\n  },\n  ADJUSTING: {\n    CANCEL_PRESSED: \"ACTIVE\",\n    DEPOSIT_CONFIRMED: \"ACTIVE\",\n    DEPOSIT_EMPTIED: \"NONE\"\n  }\n};\n\nconst transition = (view: StabilityView, event: StabilityEvent): StabilityView => {\n  const nextView = transitions[view][event] ?? view;\n  return nextView;\n};\n\nconst getInitialView = (stabilityDeposit: StabilityDeposit): StabilityView => {\n  return stabilityDeposit.isEmpty ? \"NONE\" : \"ACTIVE\";\n};\n\nconst select = ({ stabilityDeposit }: LiquityStoreState): StabilityDeposit => stabilityDeposit;\n\nexport const StabilityViewProvider: React.FC = props => {\n  const { children } = props;\n  const stabilityDeposit = useLiquitySelector(select);\n\n  const [view, setView] = useState<StabilityView>(getInitialView(stabilityDeposit));\n  const viewRef = useRef<StabilityView>(view);\n\n  const dispatchEvent = useCallback((event: StabilityEvent) => {\n    const nextView = transition(viewRef.current, event);\n\n    console.log(\n      \"dispatchEvent() [current-view, event, next-view]\",\n      viewRef.current,\n      event,\n      nextView\n    );\n    setView(nextView);\n  }, []);\n\n  useEffect(() => {\n    viewRef.current = view;\n  }, [view]);\n\n  useEffect(() => {\n    if (stabilityDeposit.isEmpty) {\n      dispatchEvent(\"DEPOSIT_EMPTIED\");\n    }\n  }, [stabilityDeposit.isEmpty, dispatchEvent]);\n\n  const provider = {\n    view,\n    dispatchEvent\n  };\n\n  return <StabilityViewContext.Provider value={provider}>{children}</StabilityViewContext.Provider>;\n};\n","import { useEffect } from \"react\";\n\nimport { LiquityStoreState, ZEROStake } from \"@liquity/lib-base\";\nimport { LiquityStoreUpdate, useLiquityReducer } from \"@liquity/lib-react\";\n\nimport { useMyTransactionState } from \"../../Transaction\";\n\nimport { StakingViewAction, StakingViewContext } from \"./StakingViewContext\";\n\ntype StakingViewProviderAction =\n  | LiquityStoreUpdate\n  | StakingViewAction\n  | { type: \"startChange\" | \"abortChange\" };\n\ntype StakingViewProviderState = {\n  zeroStake: ZEROStake;\n  changePending: boolean;\n  adjusting: boolean;\n};\n\nconst init = ({ zeroStake }: LiquityStoreState): StakingViewProviderState => ({\n  zeroStake,\n  changePending: false,\n  adjusting: false\n});\n\nconst reduce = (\n  state: StakingViewProviderState,\n  action: StakingViewProviderAction\n): StakingViewProviderState => {\n  // console.log(state);\n  // console.log(action);\n\n  switch (action.type) {\n    case \"startAdjusting\":\n      return { ...state, adjusting: true };\n\n    case \"cancelAdjusting\":\n      return { ...state, adjusting: false };\n\n    case \"startChange\":\n      return { ...state, changePending: true };\n\n    case \"abortChange\":\n      return { ...state, changePending: false };\n\n    case \"updateStore\": {\n      const {\n        oldState: { zeroStake: oldStake },\n        stateChange: { zeroStake: updatedStake }\n      } = action;\n\n      if (updatedStake) {\n        const changeCommitted =\n          !updatedStake.stakedZERO.eq(oldStake.stakedZERO) ||\n          updatedStake.collateralGain.lt(oldStake.collateralGain) ||\n          updatedStake.zusdGain.lt(oldStake.zusdGain);\n\n        return {\n          ...state,\n          zeroStake: updatedStake,\n          adjusting: false,\n          changePending: changeCommitted ? false : state.changePending\n        };\n      }\n    }\n  }\n\n  return state;\n};\n\nexport const StakingViewProvider: React.FC = ({ children }) => {\n  const stakingTransactionState = useMyTransactionState(\"stake\");\n  const [{ adjusting, changePending, zeroStake }, dispatch] = useLiquityReducer(reduce, init);\n\n  useEffect(() => {\n    if (\n      stakingTransactionState.type === \"waitingForApproval\" ||\n      stakingTransactionState.type === \"waitingForConfirmation\"\n    ) {\n      dispatch({ type: \"startChange\" });\n    } else if (\n      stakingTransactionState.type === \"failed\" ||\n      stakingTransactionState.type === \"cancelled\"\n    ) {\n      dispatch({ type: \"abortChange\" });\n    }\n  }, [stakingTransactionState.type, dispatch]);\n\n  return (\n    <StakingViewContext.Provider\n      value={{\n        view: adjusting ? \"ADJUSTING\" : zeroStake.isEmpty ? \"NONE\" : \"ACTIVE\",\n        changePending,\n        dispatch\n      }}\n    >\n      {children}\n    </StakingViewContext.Provider>\n  );\n};\n","import React from \"react\";\nimport { Flex, Container } from \"theme-ui\";\nimport { HashRouter as Router, Switch, Route } from \"react-router-dom\";\nimport { Wallet } from \"@ethersproject/wallet\";\n\nimport { Decimal, Difference, Trove } from \"@liquity/lib-base\";\nimport { LiquityStoreProvider } from \"@liquity/lib-react\";\n\nimport { useLiquity } from \"./hooks/LiquityContext\";\nimport { TransactionMonitor } from \"./components/Transaction\";\nimport { UserAccount } from \"./components/UserAccount\";\nimport { SystemStatsPopup } from \"./components/SystemStatsPopup\";\nimport { Header } from \"./components/Header\";\n\nimport { PageSwitcher } from \"./pages/PageSwitcher\";\nimport { RiskyTrovesPage } from \"./pages/RiskyTrovesPage\";\nimport { RedemptionPage } from \"./pages/RedemptionPage\";\n\nimport { TroveViewProvider } from \"./components/Trove/context/TroveViewProvider\";\nimport { StabilityViewProvider } from \"./components/Stability/context/StabilityViewProvider\";\nimport { StakingViewProvider } from \"./components/Staking/context/StakingViewProvider\";\n\ntype LiquityFrontendProps = {\n  loader?: React.ReactNode;\n};\nexport const LiquityFrontend: React.FC<LiquityFrontendProps> = ({ loader }) => {\n  const { account, provider, liquity } = useLiquity();\n\n  // For console tinkering ;-)\n  Object.assign(window, {\n    account,\n    provider,\n    liquity,\n    Trove,\n    Decimal,\n    Difference,\n    Wallet\n  });\n\n  return (\n    <LiquityStoreProvider {...{ loader }} store={liquity.store}>\n      <Router>\n        <TroveViewProvider>\n          <StabilityViewProvider>\n            <StakingViewProvider>\n            <Flex sx={{ flexDirection: \"column\", minHeight: \"100%\" }}>\n              <Header>\n                <UserAccount />\n                <SystemStatsPopup />\n              </Header>\n    \n              <Container\n                variant=\"main\"\n                sx={{\n                  display: \"flex\",\n                  flexGrow: 1,\n                  flexDirection: \"column\",\n                  alignItems: \"center\"\n                }}\n              >\n                <Switch>\n                  <Route path=\"/\" exact>\n                    <PageSwitcher />\n                  </Route>\n                  <Route path=\"/liquidation\">\n                    <RiskyTrovesPage />\n                  </Route>\n                  <Route path=\"/redemption\">\n                    <RedemptionPage />\n                  </Route>\n                </Switch>\n              </Container>\n            </Flex>\n            </StakingViewProvider>\n          </StabilityViewProvider>\n        </TroveViewProvider>\n      </Router>\n      <TransactionMonitor />\n    </LiquityStoreProvider>\n  );\n};\n","import React from \"react\";\nimport { Web3ReactProvider } from \"@web3-react/core\";\nimport { Flex, Spinner, Heading, ThemeProvider, Paragraph, Link } from \"theme-ui\";\n\nimport { BatchedWebSocketAugmentedWeb3Provider } from \"@liquity/providers\";\nimport { LiquityProvider } from \"./hooks/LiquityContext\";\nimport { WalletConnector } from \"./components/WalletConnector\";\nimport { TransactionProvider } from \"./components/Transaction\";\nimport { Icon } from \"./components/Icon\";\nimport { getConfig } from \"./config\";\nimport theme from \"./theme\";\n\nimport { DisposableWalletProvider } from \"./testUtils/DisposableWalletProvider\";\nimport { LiquityFrontend } from \"./LiquityFrontend\";\n\nif (window.ethereum) {\n  // Silence MetaMask warning in console\n  Object.assign(window.ethereum, { autoRefreshOnNetworkChange: false });\n}\n\nif (process.env.REACT_APP_DEMO_MODE === \"true\") {\n  const ethereum = new DisposableWalletProvider(\n    `http://${window.location.hostname}:4444`,\n    \"0x4d5db4107d237df6a3d58ee5f70ae63d73d7658d4026f2eefd2f204c81682cb7\"\n  );\n\n  Object.assign(window, { ethereum });\n}\n\n// Start pre-fetching the config\ngetConfig().then(config => {\n  // console.log(\"Frontend config:\");\n  // console.log(config);\n  Object.assign(window, { config });\n});\n\nconst EthersWeb3ReactProvider: React.FC = ({ children }) => {\n  return (\n    <Web3ReactProvider getLibrary={provider => new BatchedWebSocketAugmentedWeb3Provider(provider)}>\n      {children}\n    </Web3ReactProvider>\n  );\n};\n\nconst UnsupportedMainnetFallback: React.FC = () => (\n  <Flex\n    sx={{\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      height: \"100vh\",\n      textAlign: \"center\"\n    }}\n  >\n    <Heading sx={{ mb: 3 }}>\n      <Icon name=\"exclamation-triangle\" /> This app is for testing purposes only.\n    </Heading>\n\n    <Paragraph sx={{ mb: 3 }}>\n      Please change your network to RSK Testnet.\n    </Paragraph>\n\n    <Paragraph>\n      If you'd like to use Zero on mainnet, please go{\" \"}\n      <Link href=\"https://live.sovryn.app/zero\">\n        here <Icon name=\"external-link-alt\" size=\"xs\" />\n      </Link>\n      .\n    </Paragraph>\n  </Flex>\n);\n\nconst App = () => {\n  const loader = (\n    <Flex sx={{ alignItems: \"center\", justifyContent: \"center\", height: \"100vh\" }}>\n      <Spinner sx={{ m: 2, color: \"text\" }} size=\"32px\" />\n      <Heading>Loading...</Heading>\n    </Flex>\n  );\n\n  const unsupportedNetworkFallback = (chainId: number) => (\n    <Flex\n      sx={{\n        flexDirection: \"column\",\n        alignItems: \"center\",\n        justifyContent: \"center\",\n        height: \"100vh\",\n        textAlign: \"center\"\n      }}\n    >\n      <Heading sx={{ mb: 3 }}>\n        <Icon name=\"exclamation-triangle\" /> Zero is not yet deployed to{\" \"}\n        {chainId === 30 ? \"mainnet\" : \"this network\"}.\n      </Heading>\n      Please switch to RSK Testnet.\n    </Flex>\n  );\n\n  return (\n    <EthersWeb3ReactProvider>\n      <ThemeProvider theme={theme}>\n        <WalletConnector loader={loader}>\n          <LiquityProvider\n            loader={loader}\n            unsupportedNetworkFallback={unsupportedNetworkFallback}\n            unsupportedMainnetFallback={<UnsupportedMainnetFallback />}\n          >\n            <TransactionProvider>\n              <LiquityFrontend loader={loader} />\n            </TransactionProvider>\n          </LiquityProvider>\n        </WalletConnector>\n      </ThemeProvider>\n    </EthersWeb3ReactProvider>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport \"./index.css\";\nimport App from \"./App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}